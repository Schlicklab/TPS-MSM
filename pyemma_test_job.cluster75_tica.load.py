import matplotlib.pyplot as plt
import matplotlib as mpl
import numpy as np
import pyemma
from pyemma.util.contexts import settings
import mdtraj as md
import glob
import pandas as pd
from itertools import product
import pickle
import copy
import seaborn as sns
from pandas import DataFrame
import random
import networkx as nx
import scipy
import csv

cluster_tica_coord=pyemma.load('coord.lag100.cluster75.region3.tica.h5')                                                                                                              
dtrajs_tica_coord_concatenated = np.concatenate(cluster_tica_coord.dtrajs) 
cluster_tica_coord_out = cluster_tica_coord.get_output()      
tica_coord=cluster_tica_coord._data_producer                                                                                                                                          
tica_coord_output = tica_coord.data                                                                                                                                                   
tica_coord_concatenated = np.concatenate(tica_coord_output)                                                                                                                           
msm_coord=pyemma.load('msm_coord.lag100.cluster75.n=23.coord.region3.tica.h5',model_name='lag100_cluster75_n=23')                                                                    


fig, ax = plt.subplots(figsize=(4, 4))
pyemma.plots.plot_density(
    *tica_coord_concatenated[:, :2].T, ax=ax, cbar=False, alpha=0.3)
ax.scatter(*cluster_tica_coord.clustercenters[:, :2].T, s=5, c='C1')
ax.set_xlabel('IC 1')
ax.set_ylabel('IC 2')
fig.tight_layout()
fig.savefig("2D_cluster.lag100.cluster75.n=23.region3.tica.png")





def plot_density_change_axis(
        xall, yall, ax=None, cmap=None,
        ncontours=100, vmin=None, vmax=None, levels=None,
        cbar=True, cax=None, cbar_label='sample density',
        cbar_orientation='vertical', logscale=False, nbins=100,
        weights=None, avoid_zero_count=False, **kwargs):
    x, y, z = get_histogram(
        xall, yall, nbins=nbins, weights=weights,
        avoid_zero_count=avoid_zero_count)
    pi = _to_density(z)
    pi = _np.ma.masked_where(pi <= 0, pi)
    if logscale:
        from matplotlib.colors import LogNorm
        norm = LogNorm(vmin=vmin, vmax=vmax)
        if levels is None:
            levels = _np.logspace(
                _np.floor(_np.log10(pi.min())),
                _np.ceil(_np.log10(pi.max())),
                ncontours + 1)
    else:
        norm = None
    fig, ax, misc = plot_map(
        x, y, pi, ax=ax, cmap=cmap,
        ncontours=ncontours, vmin=vmin, vmax=vmax, levels=levels,
        cbar=cbar, cax=cax, cbar_label=cbar_label,
        cbar_orientation=cbar_orientation, norm=norm,
        **kwargs)
    if cbar and logscale:
        from matplotlib.ticker import LogLocator
        misc['cbar'].set_ticks(LogLocator(base=10.0, subs=range(10)))
    return fig, ax, misc





fig, ax = plt.subplots(figsize=(4, 4))
pyemma.plots.plot_density(
    *tica_coord_concatenated[:, :2].T, ax=ax, cbar=False, alpha=0.3)
ax.scatter(*cluster_tica_coord.clustercenters[:, :2].T, s=5, c='C1')
#ax.set_xlabel('IC 1')
#ax.set_ylabel('IC 2')
ax.set_xscale('symlog')
ax.set_yscale('symlog')
ax.set_xlabel('IC 1',fontsize=18, fontweight='bold')
ax.set_ylabel('IC 2',fontsize=18, fontweight='bold')
fig.tight_layout()
fig.savefig("2D_cluster.lag100.cluster75.n=23.region3.tica.change_axis.png",dpi=1000)


fig, ax = plt.subplots(figsize=(7, 5))
pyemma.plots.plot_density(
    *tica_coord_concatenated[:, :2].T, ax=ax, cbar=False, alpha=0.3)
ax.scatter(*cluster_tica_coord.clustercenters[:, :2].T, s=5, c='C1')
#ax.set_xlabel('IC 1')
#ax.set_ylabel('IC 2')
ax.set_xscale('symlog')
ax.set_yscale('symlog')
ax.set_xlabel('IC 1',fontsize=18, fontweight='bold')
ax.set_ylabel('IC 2',fontsize=18, fontweight='bold')
fig.tight_layout()
fig.savefig("2D_cluster.lag100.cluster75.n=23.region3.tica.change_axis.0325.png",dpi=1000)


fig, ax = plt.subplots(figsize=(4, 3))
pyemma.plots.plot_density(
    *tica_coord_concatenated[:, :2].T, ax=ax, cbar=False, alpha=0.3)
ax.scatter(*cluster_tica_coord.clustercenters[:, :2].T, s=5, c='C1')
#ax.set_xlabel('IC 1')
#ax.set_ylabel('IC 2')
ax.set_xscale('symlog')
ax.set_yscale('symlog')
ax.set_xlabel('IC 1',fontsize=18, fontweight='bold')
ax.set_ylabel('IC 2',fontsize=18, fontweight='bold')
ax.set_xlim(-1, 10)
ax.set_ylim(-8, 3)
fig.tight_layout()
fig.savefig("2D_cluster.lag100.cluster75.n=23.region3.tica.change_axis.0325.size3.png",dpi=1000)


fig, ax = plt.subplots(figsize=(4, 5))
pyemma.plots.plot_density(
    *tica_coord_concatenated[:, :2].T, ax=ax, cbar=False, alpha=0.3)
ax.scatter(*cluster_tica_coord.clustercenters[:, :2].T, s=5, c='C1')
#ax.set_xlabel('IC 1')
#ax.set_ylabel('IC 2')
ax.set_xscale('symlog')
ax.set_yscale('symlog')
ax.set_xlabel('IC 1',fontsize=12, fontweight='bold')
ax.set_ylabel('IC 2',fontsize=12, fontweight='bold')
ax.set_xlim(-1, 8)
ax.set_ylim(-4.5, 2)
fig.tight_layout()
fig.savefig("2D_cluster.lag100.cluster75.n=23.region3.tica.change_axis.0325.size4.png",dpi=1000)


fig, ax = plt.subplots(figsize=(20, 20))
pyemma.plots.plot_density(
    *tica_coord_concatenated[:, :2].T, ax=ax, cbar=False, alpha=0.3)
ax.scatter(*cluster_tica_coord.clustercenters[:, :2].T, s=5, c='C1')
for i, txt in enumerate(list(range(1,nclusters+1))):
    ax.annotate(txt, (cluster_tica_coord.clustercenters[i, :2].T[0],cluster_tica_coord.clustercenters[i, :2].T[1]))
#ax.set_xlabel('IC 1')
#ax.set_ylabel('IC 2')
ax.set_xscale('symlog')
ax.set_yscale('symlog')
ax.set_xlabel('IC 1')
ax.set_ylabel('IC 2')
fig.tight_layout()
fig.savefig("2D_cluster.label.lag100.cluster75.n=23.region3.tica.change_axis.png",dpi=1000)



fig, ax = plt.subplots(figsize=(4, 4))
pyemma.plots.plot_density(
    *tica_coord_concatenated[:, :2].T, ax=ax, cbar=False, alpha=0.3)
ax.scatter(*cluster_tica_coord.clustercenters[:, :2].T, s=5, c='C1')
ax.set_xlabel('IC 1')
ax.set_ylabel('IC 2')
#for i, txt in enumerate(list(range(1,nclusters+1))):
#    ax.annotate(txt, (cluster_tica_coord.clustercenters[i, :2].T[0],cluster_tica_coord.clustercenters[i, :2].T[1]))
fig.tight_layout()
fig.savefig("2D_cluster.nolabel.lag100.cluster75.n=23.region3.tica.png",dpi=1000)


nclusters=75
cluster_samples_coord = cluster_tica_coord.sample_indexes_by_cluster(list(range(0,nclusters)),100)
cluster_samples_update_coord=copy.deepcopy(cluster_samples_coord)
for i in range(len(cluster_samples_coord)):
    for j in range(len(cluster_samples_coord[i])):
        traj=cluster_samples_coord[i][j][0]
        struct=cluster_samples_coord[i][j][1]
        if scale[traj]==[1,-1]:
            trajname=traj_order[traj*2+1]
            if struct>(dist_data[traj*2+1].shape[0]-1):
                frame=struct-dist_data[traj*2+1].shape[0]
                cluster_samples_update_coord[i][j][0]=traj*2
                cluster_samples_update_coord[i][j][1]=frame
            else:
                frame=struct
                cluster_samples_update_coord[i][j][0]=traj*2+1
                cluster_samples_update_coord[i][j][1]=frame
        else:
            trajname=traj_order[traj*2]
            if struct>(dist_data[traj*2].shape[0]-1):
                frame=struct-dist_data[traj*2].shape[0]
                cluster_samples_update_coord[i][j][0]=traj*2+1
                cluster_samples_update_coord[i][j][1]=frame
            else:
                frame=struct
                cluster_samples_update_coord[i][j][0]=traj*2
                cluster_samples_update_coord[i][j][1]=frame        

#colors = [plt.cm.hsv(i) for i in np.linspace(0, 1, 600)]
#random.shuffle(colors)
#pyemma.plots.plot_density(
#    *tica_coord_concatenated[:, :2].T, ax=ax, cbar=False, alpha=0.3)

nclusters=75
cluster_list=list(range(nclusters))
for i, ic in enumerate(cluster_list):
    color = 'C{}'.format(i)
    fig, ax = plt.subplots()
    for j,indx in enumerate(dist_data_update):
        tc_list=[k for k in range(len(dtrajs[j])) if dtrajs[j][k]==i]         
        ax.scatter(*dist_data_update[j][tc_list].T, s=5, color=color)
        #ax.annotate(ic, (dist_data[cluster_samples_update_coord[i][j][0]][cluster_samples_update_coord[i][j][1]].T[0],dist_data[cluster_samples_update_coord[i][j][0]][cluster_samples_update_coord[i][j][1]].T[1]))
    ax.set_xlabel('IC 1')
    ax.set_ylabel('IC 2')
    ax.set_xlim([0, 5.5])
    ax.set_ylim([0, 4.0])
    fig.tight_layout()
    fig.savefig("2D_cluster_onDIST.Cluster{}.png".format(i))
    fig.clf()


fig, ax = plt.subplots(figsize=(12, 12))
#pyemma.plots.plot_density(
#    *tica_coord_concatenated[:, :2].T, ax=ax, cbar=False, alpha=0.3)
for i, ic in enumerate(cluster_samples_update_coord):
    color = 'C{}'.format(i)
    for j,indx in enumerate(cluster_samples_update_coord[i]):
        ax.scatter(*dist_data[cluster_samples_update_coord[i][j][0]][cluster_samples_update_coord[i][j][1]].T, s=5, color=color)
        #ax.annotate(ic, (dist_data[cluster_samples_update_coord[i][j][0]][cluster_samples_update_coord[i][j][1]].T[0],dist_data[cluster_samples_update_coord[i][j][0]][cluster_samples_update_coord[i][j][1]].T[1]))
ax.set_xlabel('IC 1')
ax.set_ylabel('IC 2')
fig.tight_layout()
fig.savefig("2D_cluster_onDIST.label.lag100.cluster75.n=23.region3.tica.png")



dtrajs=cluster_tica_coord.dtrajs
nclusters=75
all_traj_cluster=[]
for i in range(len(dtrajs)):
    dtrajs_cluster=[0]*nclusters
    for j in dtrajs[i]:
        dtrajs_cluster[j]+=1
    all_traj_cluster.append(dtrajs_cluster)


sum_single_cluster_traj=[]
single_cluster_traj=[]
for i in range(len(all_traj_cluster)):
    for j in all_traj_cluster[i]:
        if j==1000:
            sum_single_cluster_traj.append(i)
            single_cluster_traj.append(all_traj_cluster[i].index(j))
            continue


def seri(seq):
    seq_order=[]
    seq_order.append(0)
    for i in range(len(seq)):
        seq_order.append(seq[i])
        if seq_order[-1]==seq_order[-2]:
            seq_order.pop()
    seq_order.pop(0)
    return seq_order

cluster_series={}
cluster_set={}
for i in range(len(dtrajs)):
    if i not in sum_single_cluster_traj:
        cluster_series[i]=seri(dtrajs[i])
        cluster_set[i]=set(dtrajs[i])
        
        
        
def remove_items(test_list, item):
 
    # using filter() + __ne__ to perform the task
    res = list(filter((item).__ne__, test_list))
    return res

cluster_series_v=list(cluster_series.values())
cluster_series_key=list(cluster_series.keys())

cluster_33=[22, 18, 17, 57, 40]
#cluster_36=[48,45,23,37,47,15,32,10,58,60,11,61,44,59,67,63,46,13,66,49,73,65]
cluster_36=[23, 25, 48, 46, 38]

#cluster_36=[23]

def get_cluster_series(cluster_series,cluster_33,cluster_36):
    cluster_series_v=list(cluster_series.values())
    cluster_series_key=list(cluster_series.keys())
    cluster_path=[]
    path=np.empty((0, 2),dtype=np.int64)
    path_start_end=np.empty((0, 2),dtype=np.int64)
    path_Cluster=[]
    iter=0
    while 1:
        if iter==0:
            start=random.choice(cluster_33)
            if not any(start in sublist for sublist in cluster_series_v):
                continue
        start_in=[]
        for v in cluster_series_v:
            if start in v:
                start_in.append(cluster_series_v.index(v))
        start_in_sel=[]
        for idx in start_in:
            if cluster_series_key[idx] not in cluster_path:
                start_in_sel.append(idx)
        if len(start_in_sel)==0:
            print("Failed to find complete path")
            break
        else:
            start_traj=random.choice(start_in_sel)        
            traj_w_start=cluster_series[cluster_series_key[start_traj]]
            print("Cluster {} sampled by Traj {}".format(start,cluster_series_key[start_traj]))
            path=np.vstack((path,np.array([start,cluster_series_key[start_traj]])))
            if any(e in cluster_36 for e in traj_w_start):
                print("Final")
                path_Cluster.append(start)
                any_list=[e in cluster_36 for e in traj_w_start]
                sum_e=[]
                e=[]
                for i in range(len(any_list)):
                    if any_list[i]:
                        sum_e.append(traj_w_start.count(traj_w_start[i]))
                        e.append(traj_w_start[i])
                #return(cluster_path)
                path_Cluster.append(e[sum_e.index(max(sum_e))])
                path_start_end=np.vstack((path_start_end,np.array([start,e[sum_e.index(max(sum_e))]])))
                return path, path_start_end, path_Cluster
                break
            else:
                cluster_path.append(cluster_series_key[start_traj])
                path_Cluster.append(start)
                next=random.choice(remove_items(traj_w_start,start))
                start_old=start
                start=int(next)
                path_start_end=np.vstack((path_start_end,np.array([start_old,start])))
                print("Next Cluster {}".format(start))
        iter+=1
        
        


############ Get_Cluster_Series ########## 

#cluster_33=[22, 18, 17, 57, 40]
#cluster_36=[23, 25, 48, 46, 38]

#cluster_33=np.array([22, 18, 17, 57, 40])
#cluster_36=np.array([23, 25, 48, 46, 38])

#cluster_33=[22]
#cluster_36=[38]

           

window_list=[0,76,117,158,208,241,271,361,482,595,650,714,807,928,978,1029,1038,1055,1081,1127,1134,1169,1214]

def find_simu(simu_index,index):
    if index in range(0,76):
        traj="TPS_2500_cp"
    if index in range(76,117):
        traj="TPS_5000_cp"
    if index in range(117,158):
        traj="TPS_7500"
    if index in range(158,208):
        traj="TPS_10000"
    if index in range(208,241):
        traj="TPS_12500"
    if index in range(241,271):
        traj="TPS_15000_cp"
    if index in range(271,361):
        traj="TPS_17500_cp"
    if index in range(361,482):
        traj="TPS_20000_cp"
    if index in range(482,595):
        traj="TPS_22500_cp"
    if index in range(595,650):
        traj="TPS_25000"
    if index in range(650,714):
        traj="TPS_27500_cp"
    if index in range(714,807):
        traj="TPS_30000"
    if index in range(807,928):
        traj="TPS_35000_cp"
    if index in range(928,978):
        traj="TPS_37500_cp"
    if index in range(978,1029):
        traj="TPS_2500_cp_2"
    if index in range(1029,1038):
        traj="TPS_5000_cp_2"
    if index in range(1038,1055):
        traj="TPS_7500_cp_2"
    if index in range(1055,1081):
        traj="TPS_10000_cp_2"
    if index in range(1081,1127):
        traj="TPS_12500_cp_2"
    if index in range(1127,1134):
        traj="TPS_15000_cp_2"
    if index in range(1134,1169):
        traj="TPS_17500_cp_2"
    if index in range(1169,1214):
        traj="TPS_20000_cp_2"
    traj_simu=traj_order_byf[index*1000+simu_index]
    frame=frame_order[index*1000+simu_index]
    return traj, traj_simu, frame
        


def path_simplify(path,path_start_end,path_Cluster):

    np_delete=[]
    for i in range(len(path_start_end)):
        if path_start_end[i][0]==path_start_end[i][1]:
            np_delete.append(i)
    path_start_end=np.delete(path_start_end,np_delete,axis=0)
    path=np.delete(path,np_delete,axis=0)
    np_delete_cluster=[i+1 for i in np_delete]
    path_Cluster_new=[path_Cluster[i] for i in range(len(path_Cluster)) if i not in np_delete_cluster]
        
    newlist = [] # empty list to hold unique elements from the list
    duplist = [] # empty list to hold the duplicate elements from the list
    for i in path_Cluster_new:
        if i not in newlist:
            newlist.append(i)
        else:
            duplist.append(i) 
    np_delete=[]
    for i in range(1,len(duplist)):
        if duplist[i]==duplist[i-1]:
            np_delete.append(i)
    for i in sorted(np_delete,reverse=True):
        del duplist[i]

    dup_ind=[] 
    for item in duplist:
        dup_index=[]
        for i in range(len(path_Cluster_new)):
            if path_Cluster_new[i]==item:
                dup_index.append(i)
        dup_ind.append(dup_index)

    dele_ndx=[]
    range_cluster_new=list(range(len(path_Cluster_new)-1))
    for item in dup_ind:
        if len(set(list(range(item[0],item[-1])))-set(dele_ndx))>1:
            de_t=0
            for i in range(item[0],item[-1]):
                if i in dele_ndx:
                    continue
                dele_ndx.append(i)
                de_t+=1
            res = [i for i in range_cluster_new if i not in dele_ndx]
            for j in range(len(res)-1):
                if path_start_end[res[j]][1]!=path_start_end[res[j+1]][0]:
                    for i in range(de_t):
                        dele_ndx.pop()
                    break
    path_start_end=np.delete(path_start_end,dele_ndx,axis=0)
    path=np.delete(path,dele_ndx,axis=0)     
    dele_ndx_cluster=[i+1 for i in dele_ndx] 
    path_Cluster_new2=[path_Cluster_new[i] for i in range(len(path_Cluster_new)) if i not in dele_ndx_cluster]
    path_Cluster=path_Cluster_new2
    return path, path_start_end, path_Cluster




def seri_count(seq):
    seq_order=[]
    seq_count=[]
    seq_order.append(0)
    ind=0
    for i in range(len(seq)):
        seq_order.append(seq[i])
        if seq_order[-1]==seq_order[-2]:
            ind+=1
            seq_order.pop()
        else:
            seq_count.append(ind)
            ind=1
    seq_count.append(ind)
    seq_order.pop(0)
    seq_count.pop(0)
    return seq_order,seq_count


def summarize_path(path,path_Cluster):    
    start_window_all=[]
    end_window_all=[]
    start_traj_all=[]
    end_traj_all=[]
    start_frame_all=[]
    end_frame_all=[]
    start_cluster_all=[]
    end_cluster_all=[]
    
    traj_start_all=[]
    traj_end_all=[]
    traj_order_all=[]
    traj_all=[]  
   
    for i in range(len(path_Cluster)-1):
        traj=dtrajs[path[i][1]]
        seq_order,seq_count=seri_count(traj)
        #seq_cluster_count={}
        cluster1_count=[seq_count[ind] for ind in range(len(seq_count)) if seq_order[ind]==path_Cluster[i]]
        cluster2_count=[seq_count[ind] for ind in range(len(seq_count)) if seq_order[ind]==path_Cluster[i+1]]
        max_c1=seq_count.index(max(cluster1_count))
        max_c2=seq_count.index(max(cluster2_count))
        if max_c1 < max_c2:
            start=sum(seq_count[0:max_c1])
            end=sum(seq_count[0:(max_c2+1)])-1
            order=1
        else:
            start=sum(seq_count[0:(max_c1+1)])-1
            end=sum(seq_count[0:max_c2])
            order=-1
        traj_start_all.append(start)
        traj_end_all.append(end)
        traj_order_all.append(order)
        traj_all.append(path[i][1])
        start_window, start_traj, start_frame = find_simu(start,path[i][1])
        end_window, end_traj, end_frame = find_simu(end,path[i][1])
        print("Start window: "+start_window+"       Start traj: "+start_traj+"      Start frame:"+str(start_frame)+"        Cluster:"+str(path_Cluster[i]))
        print("End window: "+end_window+"       End traj: "+end_traj+"      End frame:"+str(end_frame)+"        Cluster:"+str(path_Cluster[i+1]))
        start_window_all.append(start_window)
        end_window_all.append(end_window)
        start_traj_all.append(start_traj)
        end_traj_all.append(end_traj)
        start_frame_all.append(start_frame)
        end_frame_all.append(end_frame)
        start_cluster_all.append(path_Cluster[i])
        end_cluster_all.append(path_Cluster[i+1])
    
    path_traj_table = pd.DataFrame(list(zip(start_window_all, start_traj_all, start_frame_all, start_cluster_all, end_window_all, end_traj_all, end_frame_all, end_cluster_all)),columns =['Start_window', 'Start_traj', 'Start_frame', 'Start_cluster', 'End_window', 'End_traj', 'End_frame', 'End_cluster'])
    path_data_table = pd.DataFrame(list(zip(traj_all, traj_start_all, traj_end_all, traj_order_all)),columns =['Traj', 'Start', 'End', 'Order'])
    return path_traj_table, path_data_table   

            
def extract_path_data(path_data_table,data):
    out_data=[]
    for ind in path_data_table.index:
        out_data.append(data[path_data_table['Traj'][ind]][path_data_table['Start'][ind]:path_data_table['End'][ind]:path_data_table['Order'][ind]])
    return out_data
        


def get_histogram(
        xall, yall, nbins=100,
        weights=None, avoid_zero_count=False):
    """Compute a two-dimensional histogram.

    Parameters
    ----------
    xall : ndarray(T)
        Sample x-coordinates.
    yall : ndarray(T)
        Sample y-coordinates.
    nbins : int, optional, default=100
        Number of histogram bins used in each dimension.
    weights : ndarray(T), optional, default=None
        Sample weights; by default all samples have the same weight.
    avoid_zero_count : bool, optional, default=True
        Avoid zero counts by lifting all histogram elements to the
        minimum value before computing the free energy. If False,
        zero histogram counts would yield infinity in the free energy.

    Returns
    -------
    x : ndarray(nbins, nbins)
        The bins' x-coordinates in meshgrid format.
    y : ndarray(nbins, nbins)
        The bins' y-coordinates in meshgrid format.
    z : ndarray(nbins, nbins)
        Histogram counts in meshgrid format.

    """
    z, xedge, yedge = np.histogram2d(
        xall, yall, bins=nbins, weights=weights)
    x = 0.5 * (xedge[:-1] + xedge[1:])
    y = 0.5 * (yedge[:-1] + yedge[1:])
    if avoid_zero_count:
        z = np.maximum(z, np.min(z[z.nonzero()]))
    return x, y, z.T # transpose to match x/y-directions


def _to_density(z):
    """Normalize histogram counts.

    Parameters
    ----------
    z : ndarray(T)
        Histogram counts.

    """
    return z / float(z.sum())


def _to_free_energy(z, minener_zero=False):
    """Compute free energies from histogram counts.

    Parameters
    ----------
    z : ndarray(T)
        Histogram counts.
    minener_zero : boolean, optional, default=False
        Shifts the energy minimum to zero.

    Returns
    -------
    free_energy : ndarray(T)
        The free energy values in units of kT.

    """
    pi = _to_density(z)
    free_energy = np.inf * np.ones(shape=z.shape)
    nonzero = pi.nonzero()
    free_energy[nonzero] = -np.log(pi[nonzero])
    if minener_zero:
        free_energy[nonzero] -= np.min(free_energy[nonzero])
    return free_energy



nbins=100
minener_zero=True
kT=1.0


#z, xedge, yedge = np.histogram2d(*dist_data_concatenated.T, bins=nbins)
z_dist, xHedges_dist, yHedges_dist, binnumber_dist = scipy.stats.binned_statistic_2d(*dist_data_concatenated.T, None, 'count', bins=nbins, expand_binnumbers=True)
f_dist = _to_free_energy(z_dist, minener_zero=minener_zero) * kT


z_weight, xedge_weight, yedge_weight = np.histogram2d(*dist_data_concatenated.T, bins=nbins,weights=np.concatenate(msm_coord.trajectory_weights()))
z_weight_scipy, xHedges_weight, yHedges_weight, binnumber_weight = scipy.stats.binned_statistic_2d(*dist_data_concatenated.T, None, 'count', bins=nbins, expand_binnumbers=True)
f_weight = _to_free_energy(z_weight, minener_zero=minener_zero) * kT



f=open("dist_energy_bolas.update.pickle",'rb')
z_bolas_scipy=pickle.load(f)
xHedges_bolas=pickle.load(f)
yHedges_bolas=pickle.load(f)
binnumber_bolas=pickle.load(f)
f_bolas=pickle.load(f)
f.close()

data_index=list(range(len(dist_data_concatenated)))
data_sele=[i for i in data_index if i not in [2989755,2989756]]
# Using BOLAS data
#z_bolas, xedge_bolas, yedge_bolas = np.histogram2d(*dist_data_concatenated[data_sele,:].T, bins=nbins)
z_bolas_scipy, xHedges_bolas, yHedges_bolas, binnumber_bolas = scipy.stats.binned_statistic_2d(*dist_data_concatenated[data_sele,:].T, None, 'count', bins=nbins, expand_binnumbers=True)
f_bolas = _to_free_energy(z_bolas_scipy, minener_zero=minener_zero) * kT






#x, y, z = get_histogram(xall, yall, nbins=nbins, weights=weights,avoid_zero_count=avoid_zero_count)
#f = _to_free_energy(z, minener_zero=minener_zero) * kT

#np.digitize(a, bins)

def extract_path_energy(path_data_table,binnumber,f):
    out_binnumber=[]
    out_energy=[]
    out_cluster=[]
    for ind in path_data_table.index:
        traj_ind=path_data_table['Traj'][ind]
        start=traj_ind*1000+path_data_table['Start'][ind]
        end=traj_ind*1000+path_data_table['End'][ind]
        order=path_data_table['Order'][ind]
        out_binnumber.append(binnumber.T[start:end:order])
        binnumber_sele=binnumber.T[start:end:order]
        for i in range(len(binnumber_sele)):            
            out_energy.append(f[binnumber_sele[i][0],binnumber_sele[i][1]])
            out_cluster.append(dtrajs[traj_ind][i])
    return out_binnumber,out_energy,out_cluster



def extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy):
    #replace f_bolas with free_energy 01222024
    xbin=np.digitize(path_extract_dist_concatenated[:,0],xHedges_bolas)
    ybin=np.digitize(path_extract_dist_concatenated[:,1],yHedges_bolas)
    out_energy=[]
    for i in range(len(xbin)):
        if xbin[i]>=100:
            x_ind=99
        else:
            x_ind=xbin[i]
        if ybin[i]>=100:
            y_ind=99
        else:
            y_ind=ybin[i]
        #out_energy.append(free_energy[xbin[i],ybin[i]])
        out_energy.append(free_energy[x_ind,y_ind])
    return out_energy
    


cluster_path_extract_dist_all=dict()
cluster_data_path_extract_dist_all=dict()

for i in range(len(dtrajs)):
    cluster_shown=list(set(dtrajs[i]))
    for j in cluster_shown:
        if j not in list(cluster_path_extract_dist_all.keys()):
            cluster_path_extract_dist=np.array([0,0])
            cluster_data_path_extract_dist=np.array([0,0])
            for k in range(len(dtrajs[0])):
                if dtrajs[i][k]==j:
                    cluster_path_extract_dist=np.vstack((cluster_path_extract_dist,np.array([i,k])))
                    cluster_data_path_extract_dist=np.vstack((cluster_data_path_extract_dist,dist_data_update[i][k]))
            cluster_path_extract_dist=np.delete(cluster_path_extract_dist,0,axis=0)
            cluster_data_path_extract_dist=np.delete(cluster_data_path_extract_dist,0,axis=0)
            cluster_path_extract_dist_all[j]=cluster_path_extract_dist
            cluster_data_path_extract_dist_all[j]=cluster_data_path_extract_dist
        else:
            for k in range(len(dtrajs[0])):
                if dtrajs[i][k]==j:
                    cluster_path_extract_dist_all[j]=np.vstack((cluster_path_extract_dist_all[j],np.array([i,k])))
                    cluster_data_path_extract_dist_all[j]=np.vstack((cluster_data_path_extract_dist_all[j],dist_data_update[i][k]))
        
    
myKeys = list(cluster_path_extract_dist_all.keys())
myKeys.sort()
sorted_cluster_path_extract_dist_all = {i: cluster_path_extract_dist_all[i] for i in myKeys}
sorted_cluster_data_path_extract_dist_all = {i: cluster_data_path_extract_dist_all[i] for i in myKeys} 


list_sorted_cluster_data_path_extract_dist_all=[] 
list_cluster_energy_bolas=[]
for i in range(nclusters):
    list_sorted_cluster_data_path_extract_dist_all.append(sorted_cluster_data_path_extract_dist_all[i])
    cluster_energy_bolas=extract_bolas_energy(sorted_cluster_data_path_extract_dist_all[i],xHedges_bolas, yHedges_bolas,free_energy) 
    list_cluster_energy_bolas.append(cluster_energy_bolas)

list_cluster_energy_bolas_avg=[]
list_cluster_energy_bolas_err=[]    
for i in range(nclusters):
    list_cluster_energy_bolas[i]=np.array(list_cluster_energy_bolas[i])
    list_cluster_energy_bolas_avg.append(np.average(list_cluster_energy_bolas[i][np.isfinite(list_cluster_energy_bolas[i])]))
    list_cluster_energy_bolas_err.append(np.std(list_cluster_energy_bolas[i][np.isfinite(list_cluster_energy_bolas[i])]))
    


fig,ax = plt.subplots(figsize=(7, 6))
x = np.arange(4)
y = np.array(list_cluster_energy_bolas_avg)[[22,54,34,38]]
yerr = np.array(list_cluster_energy_bolas_err)[[22,54,34,38]]
xclusters = ('C23', 'C55', 'C35', 'C39')
ax.errorbar(x, y, yerr=yerr,color="#ec2b7c")
ax.set_xlabel('Cluster',fontsize=20, fontweight='bold')
ax.set_ylabel('Free Energy  kcal/mol',fontsize=20, fontweight='bold')
#ax.set_xlim(0, 6)
ax.set_ylim(0, 8)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=16)
ax.set_xticks(x)
ax.set_xticklabels(xclusters)
#ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_1D.031324.Pink.0318.png",dpi=1200)    


fig,ax = plt.subplots(figsize=(7, 6))
x = np.arange(6)
y = np.array(list_cluster_energy_bolas_avg)[[17,54,70,72,10,48]]
yerr = np.array(list_cluster_energy_bolas_err)[[17,54,70,72,10,48]]
xclusters = ('C18', 'C55', 'C70', 'C72','C11','C49')
ax.errorbar(x, y, yerr=yerr,color="#03ac13")
ax.set_xlabel('Cluster',fontsize=20, fontweight='bold')
ax.set_ylabel('Free Energy  kcal/mol',fontsize=20, fontweight='bold')
#ax.set_xlim(0, 6)
ax.set_ylim(0, 8)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=16)
ax.set_xticks(x)
ax.set_xticklabels(xclusters)
#ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_1D.031324.Green.0318.png",dpi=1200)    


fig,ax = plt.subplots(figsize=(7, 6))
x = np.arange(6)
y = np.array(list_cluster_energy_bolas_avg)[[22,54,5,39,70,25]]
yerr = np.array(list_cluster_energy_bolas_err)[[22,54,5,39,70,25]]
xclusters = ('C23', 'C55', 'C6', 'C40','C71','C26')
ax.errorbar(x, y, yerr=yerr,color="#b03dbe")
ax.set_xlabel('Cluster',fontsize=20, fontweight='bold')
ax.set_ylabel('Free Energy  kcal/mol',fontsize=20, fontweight='bold')
#ax.set_xlim(0, 6)
ax.set_ylim(0, 8)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=16)
ax.set_xticks(x)
ax.set_xticklabels(xclusters)
#ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_1D.031324.Purple.0318.png",dpi=1200)    


fig,ax = plt.subplots(figsize=(7, 6))
x = np.arange(4)
y = np.array(list_cluster_energy_bolas_avg)[[17,54,70,46]]
yerr = np.array(list_cluster_energy_bolas_err)[[17,54,70,46]]
xclusters = ('C18', 'C55', 'C71', 'C47')
ax.errorbar(x, y, yerr=yerr,color="#feb326")
ax.set_xlabel('Cluster',fontsize=20, fontweight='bold')
ax.set_ylabel('Free Energy  kcal/mol',fontsize=20, fontweight='bold')
#ax.set_xlim(0, 6)
ax.set_ylim(0, 8)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=16)
ax.set_xticks(x)
ax.set_xticklabels(xclusters)
#ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_1D.031324.Yellow.0318.png",dpi=1200)    


  
    
#sorted_cluster_data_path_extract_dist_all_concatenated = np.concatenate(list_sorted_cluster_data_path_extract_dist_all)

#path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy) 

#path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
#path_extract_dist=extract_path_data(path_data_new, dist_data_update)
#path_extract_dist_concatenated = np.concatenate(path_extract_dist)
#path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
#path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy) # change f_bolas to free_energy   



#def extract_path_data(path_data_table,data):
#    out_data=[]
#    for ind in path_data_table.index:
#        out_data.append(data[path_data_table['Traj'][ind]][path_data_table['Start'][ind]:path_data_table['End'][ind]:path_data_table['Order'][ind]])
#    return out_data
        


    
len(files_TPS_2500_cp) 152
len(files_TPS_5000_cp) 82
len(files_TPS_7500) 82
len(files_TPS_10000) 100
len(files_TPS_12500) 66
len(files_TPS_15000_cp) 60
len(files_TPS_17500_cp) 180
len(files_TPS_20000_cp) 242
len(files_TPS_22500_cp) 226
len(files_TPS_25000) 110
len(files_TPS_27500_cp) 128
len(files_TPS_30000) 186
len(files_TPS_35000_cp) 242
len(files_TPS_37500_cp) 100
len(files_TPS_2500_cp_2) 102
len(files_TPS_5000_cp_2) 18
len(files_TPS_7500_cp_2) 34
len(files_TPS_10000_cp_2) 52
len(files_TPS_12500_cp_2) 92
len(files_TPS_15000_cp_2) 14
len(files_TPS_17500_cp_2) 70
len(files_TPS_20000_cp_2) 90


tran_cluster=[]
tran_cluster_traj=[]
for i in range(len(dtrajs)):
    cluster_set=set(dtrajs[i])
    if len(cluster_set)>1:
        tran_cluster.append(seri(dtrajs[i]))
        tran_cluster_traj.append(i)

f=open("transition_cluster_traj.txt","w")
for i in range(len(tran_cluster_traj)):
    f.write('Traj :'+str(tran_cluster_traj[i])+'\n\n')
    f.write('    '.join(str(tran_cluster[i])))
    f.write('\n\n')
    f.write('    '.join(str(item) for item in dtrajs[tran_cluster_traj[i]]))
    f.write('\n\n\n\n\n')

import csv

test=scale[0:76]
with open("scale.TPS_2500_cp.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)
    
test=scale[76:118]
with open("scale.TPS_5000_cp.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)
    
test=scale[117:159]
with open("scale.TPS_7500.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[158:209]
with open("scale.TPS_10000.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[208:242]
with open("scale.TPS_12500.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[241:272]
with open("scale.TPS_15000_cp.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[271:362]
with open("scale.TPS_17500_cp.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[361:483]
with open("scale.TPS_20000_cp.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[482:596]
with open("scale.TPS_22500_cp.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[595:651]
with open("scale.TPS_25000.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[650:715]
with open("scale.TPS_27500_cp.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[714:808]
with open("scale.TPS_30000.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[807:929]
with open("scale.TPS_35000_cp.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[928:979]
with open("scale.TPS_37500_cp.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)
    
test=scale[978:1030]
with open("scale.TPS_2500_cp_2.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)    
    
test=scale[1029:1039]
with open("scale.TPS_5000_cp_2.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)    
    
test=scale[1038:1056]
with open("scale.TPS_7500_cp_2.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)    
    
test=scale[1055:1082]
with open("scale.TPS_10000_cp_2.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)    
    
test=scale[1081:1128]
with open("scale.TPS_12500_cp_2.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[1127:1135]
with open("scale.TPS_15000_cp_2.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[1134:1170]
with open("scale.TPS_17500_cp_2.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)

test=scale[1169:1215]
with open("scale.TPS_20000_cp_2.csv","w",newline='') as file:
    writer=csv.writer(file)
    writer.writerows(test)



######################### PATH #####################################

Pink: 23 --> 55 --> 71 --> 35 --> 39

Green: 18 --> 55 --> 71 --> 73 --> 11 --> 49

Purple: 23 --> 55 --> 70 --> 6 --> 71 --> 26

Yellow: 18 --> 55 --> 71 --> 47


######################### PATH Edited 1025  Pink #####################################


Pink: 23 --> 55 --> 71 --> 35 --> 39

path_new=np.array([[ 22, 995],[  54, 1039],[  70, 1083],[  34, 1095]])

path_start_end_new=np.array([[22, 54],[54, 70],[70, 34],[34, 38]])

path_Cluster_new=[22, 54, 70, 34, 38]

d_path_data_new={'Traj':[995,1039,1083,1095],'Start':[0,999,0,999],'End':[965,0,999,0],'Order':[1,-1,1,-1]}
path_data_new=pd.DataFrame(data=d_path_data_new)

In [94]: path_table_new                                                                                                        
Out[94]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
2  TPS_12500_cp_2  gn_046_xpr2          221             70  TPS_12500_cp_2  gn_046_xpr1        779           34
3  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [95]: path_data_new                                                                                                         
Out[95]: 
   Traj  Start  End  Order
0   995      0  965      1
1  1039    999    0     -1
2  1083      0  999      1
3  1095    999    0     -1


k="pink"
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy) # change f_bolas to free_energy


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1025.01222024.png".format(nclusters,k),dpi=1200) #01-22-2024



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1025.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1025.test2.01222024.png".format(nclusters,k),dpi=1200)



Start window: TPS_2500_cp_2       Start traj: gn_152_xpr2      Start frame:934        Cluster:22
End window: TPS_2500_cp_2       End traj: gn_152_xpr1      End frame:32        Cluster:54
Start window: TPS_7500_cp_2       Start traj: gn_112_xpr1      Start frame:715        Cluster:54
End window: TPS_7500_cp_2       End traj: gn_112_xpr2      End frame:285        Cluster:70
Start window: TPS_12500_cp_2       Start traj: gn_046_xpr2      Start frame:221        Cluster:70
End window: TPS_12500_cp_2       End traj: gn_046_xpr1      End frame:779        Cluster:34
Start window: TPS_12500_cp_2       Start traj: gn_192_xpr2      Start frame:75        Cluster:34
End window: TPS_12500_cp_2       End traj: gn_192_xpr1      End frame:925        Cluster:38



######################### PATH Edited 1025  Green #####################################

Green: 18 --> 55 --> 71 --> 73 --> 11 --> 49



path_new=np.array([[ 17,   0],[  54, 1039],[  70,  651],[ 72, 665], [  10,  940]])      

path_start_end_new=np.array([[17, 54],[54, 70],[70, 72],[72, 10],[10, 48]])

path_Cluster_new=[17, 54, 70, 72, 10, 48]

d_path_data_new={'Traj':[0,1039,651,665,940],'Start':[0,999,11,139,999],'End':[945,0,999,999,0],'Order':[1,-1,1,1,-1]}
path_data_new=pd.DataFrame(data=d_path_data_new)



In [804]: path_table_new                                                                                                       
Out[804]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
2   TPS_27500_cp  gn_076_xpr1          635             70   TPS_27500_cp  gn_076_xpr2        354           72
3  TPS_27500_cp  gn_125_xpr2          190             72  TPS_27500_cp  gn_125_xpr1        671           10
4   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [805]: path_data_new                                                                                                        
Out[805]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1039    999    0     -1
2   651     11  999      1
3   665    139  999      1
4   940    999    0     -1



k="green"
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1025.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1025.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=1,fillstyle='none', color='pink', marker="o", mew=0.6, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
#ax.tick_params(axis='both', labelsize=16)
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1025.01222024.larger.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1025.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 3))
ax.scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
ax.plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
ax.set_xlabel('Path',fontsize=16, fontweight='bold')
ax.set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
ax.set_title('BOLAS', fontweight='bold',fontsize=16)
ax.tick_params(axis='both', labelsize=12)
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1025.01222024.larger.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 3))
ax.scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c='#03ac13', marker="o",zorder=2)
ax.plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='#03ac13', linewidth=0.3,zorder=1)
ax.set_xlabel('Path',fontsize=16, fontweight='bold')
ax.set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
ax.set_title('BOLAS', fontweight='bold',fontsize=16)
ax.tick_params(axis='both', labelsize=12)
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1025.020824.larger.png".format(nclusters,k),dpi=1200)


path_list_d=pd.DataFrame(path_path_cluster_dist)
path_list_d.to_csv("Path_list.lag=100.cluster={}.coord.region3.path{}.all.1025.022224.csv".format(nclusters,k))


Start window: TPS_2500_cp       Start traj: gn_017_xpr1      Start frame:672        Cluster:17
End window: TPS_2500_cp       End traj: gn_017_xpr2      End frame:274        Cluster:54
Start window: TPS_7500_cp_2       Start traj: gn_112_xpr1      Start frame:715        Cluster:54
End window: TPS_7500_cp_2       End traj: gn_112_xpr2      End frame:285        Cluster:70
Start window: TPS_27500_cp       Start traj: gn_076_xpr1      Start frame:635        Cluster:70
End window: TPS_27500_cp       End traj: gn_076_xpr2      End frame:354        Cluster:72
Start window: TPS_27500_cp       Start traj: gn_125_xpr2      Start frame:190        Cluster:72
End window: TPS_27500_cp       End traj: gn_125_xpr1      End frame:671        Cluster:10
Start window: TPS_37500_cp       Start traj: gn_204_xpr1      Start frame:96        Cluster:10
End window: TPS_37500_cp       End traj: gn_204_xpr2      End frame:904        Cluster:48





######################### PATH Edited 1025  Yellow #####################################

Yellow: 18 --> 55 --> 71 --> 47



path_new=np.array([[ 17,   0],[  54, 1039],[  70,  489]])      

path_start_end_new=np.array([[17, 54],[54, 70],[70, 46]])

path_Cluster_new=[17, 54, 70, 46]

d_path_data_new={'Traj':[0,1039,489],'Start':[0,999,999],'End':[945,0,173],'Order':[1,-1,-1]}
path_data_new=pd.DataFrame(data=d_path_data_new)



In [804]: path_table_new                                                                                                       
Out[804]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
2   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46

In [805]: path_data_new                                                                                                        
Out[805]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1039    999    0     -1
2   489    999  173     -1


k="yellow"
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1025.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1025.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1025.01222024.png".format(nclusters,k),dpi=1200)



Start window: TPS_2500_cp       Start traj: gn_017_xpr1      Start frame:672        Cluster:17
End window: TPS_2500_cp       End traj: gn_017_xpr2      End frame:274        Cluster:54
Start window: TPS_7500_cp_2       Start traj: gn_112_xpr1      Start frame:715        Cluster:54
End window: TPS_7500_cp_2       End traj: gn_112_xpr2      End frame:285        Cluster:70
Start window: TPS_22500_cp       Start traj: gn_029_xpr2      Start frame:208        Cluster:70
End window: TPS_22500_cp       End traj: gn_029_xpr1      End frame:619        Cluster:46


######################### PATH_1017 k=0 #####################################


Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 714
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=0
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)




path_new=np.array([[ 22, 995],[ 54, 170],[  5, 483],[ 70, 714]])
path_start_end_new=np.array([[22, 54],[54,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 5, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1025.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [91]: path_new                                                                                                              
Out[91]: 
array([[ 22, 995],
       [ 54, 170],
       [  5, 483],
       [ 70, 714]])

In [92]: path_start_end_new                                                                                                    
Out[92]: 
array([[22, 54],
       [54,  5],
       [ 5, 70],
       [70, 25]])

In [93]: path_Cluster_new                                                                                                      
Out[93]: [22, 54, 5, 70, 25]

In [94]: path_table_new                                                                                                        
Out[94]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1      TPS_10000  gn_273_xpr2          265             54      TPS_10000  gn_273_xpr1        735            5
2   TPS_22500_cp  gn_013_xpr2          487              5   TPS_22500_cp  gn_013_xpr1        499           70
3      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [95]: path_data_new                                                                                                         
Out[95]: 
   Traj  Start  End  Order
0   995      0  965      1
1   170      0  999      1
2   483    985    0     -1
3   714      0  739      1








######################### PATH_1017 k=1 #####################################


Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 72
Cluster 72 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 714
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=1
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=1
path_new=np.array([[  22,  994],[  54, 1044],[  70,  651],[  72,  654],[  70,  252],[  51,  251],[  70,  714]])
path_start_end_new=np.array([[22, 54],[54, 70],[70, 72],[72, 70],[70, 51],[51, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 72, 70, 51, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [102]: path_new                                                                                                             
Out[102]: 
array([[  22,  994],
       [  54, 1044],
       [  70,  651],
       [  72,  654],
       [  70,  252],
       [  51,  251],
       [  70,  714]])

In [103]: path_start_end_new                                                                                                   
Out[103]: 
array([[22, 54],
       [54, 70],
       [70, 72],
       [72, 70],
       [70, 51],
       [51, 70],
       [70, 25]])

In [104]: path_Cluster_new                                                                                                     
Out[104]: [22, 54, 70, 72, 70, 51, 70, 25]

In [105]: path_table_new                                                                                                       
Out[105]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_7500_cp_2  gn_156_xpr1          744             54  TPS_7500_cp_2  gn_156_xpr2        230           70
2   TPS_27500_cp  gn_076_xpr1          635             70   TPS_27500_cp  gn_076_xpr2        354           72
3   TPS_27500_cp  gn_082_xpr1          705             72   TPS_27500_cp  gn_082_xpr2        295           70
4   TPS_15000_cp  gn_530_xpr1          349             70   TPS_15000_cp  gn_530_xpr2        256           51
5   TPS_15000_cp  gn_528_xpr1          649             51   TPS_15000_cp  gn_528_xpr1         52           70
6      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [106]: path_data_new                                                                                                        
Out[106]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1044    999   26     -1
2   651     11  999      1
3   654    999    0     -1
4   252    604    0     -1
5   251    247  844      1
6   714      0  739      1





######################### PATH_1017 k=2 #####################################


Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 51
Cluster 51 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 714
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=2
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=2
path_new=np.array([[  22,  994],[  54, 1044],[  70,  714]])
path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [114]: path_new                                                                                                             
Out[114]: 
array([[  22,  994],
       [  54, 1044],
       [  70,  714]])

In [115]: path_start_end_new                                                                                                   
Out[115]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [116]: path_Cluster_new                                                                                                     
Out[116]: [22, 54, 70, 25]

In [117]: path_table_new                                                                                                       
Out[117]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_7500_cp_2  gn_156_xpr1          744             54  TPS_7500_cp_2  gn_156_xpr2        230           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [118]: path_data_new                                                                                                        
Out[118]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1044    999   26     -1
2   714      0  739      1




######################### PATH_1017 k=3 #####################################


Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 51
Cluster 51 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 68
Cluster 68 sampled by Traj 139
Next Cluster 68
Cluster 68 sampled by Traj 134
Next Cluster 1
Cluster 1 sampled by Traj 141
Next Cluster 68
Cluster 68 sampled by Traj 132
Next Cluster 1
Cluster 1 sampled by Traj 138
Next Cluster 68
Cluster 68 sampled by Traj 136
Next Cluster 1
Cluster 1 sampled by Traj 377
Next Cluster 1
Cluster 1 sampled by Traj 137
Next Cluster 68
Cluster 68 sampled by Traj 140
Next Cluster 1
Cluster 1 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 714
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=3
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=3
path_new=np.array([[  22,  994],[  54, 1044],[  70,  714]])

path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])

path_Cluster_new=[22, 54, 70, 25]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [121]: path_new                                                                                                             
Out[121]: 
array([[  22,  994],
       [  54, 1044],
       [  70,  714]])

In [122]: path_start_end_new                                                                                                   
Out[122]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [126]: path_Cluster_new                                                                                                     
Out[126]: [22, 54, 70, 25]

In [124]: path_table_new                                                                                                       
Out[124]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_7500_cp_2  gn_156_xpr1          744             54  TPS_7500_cp_2  gn_156_xpr2        230           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [125]: path_data_new                                                                                                        
Out[125]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1044    999   26     -1
2   714      0  739      1




######################### PATH_1017 k=4 #####################################

Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 714
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=4
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=4

path_new=np.array([[ 22, 995],[ 54, 367],[ 71, 361],[ 70, 714]])

path_start_end_new=np.array([[22, 54],[54, 71],[71, 70],[70, 25]])

path_Cluster_new=[22, 54, 71, 70, 25]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [144]: path_new                                                                                                             
Out[144]: 
array([[ 22, 995],
       [ 54, 367],
       [ 71, 361],
       [ 70, 714]])

In [145]: path_start_end_new                                                                                                   
Out[145]: 
array([[22, 54],
       [54, 71],
       [71, 70],
       [70, 25]])

In [146]: path_Cluster_new                                                                                                     
Out[146]: [22, 54, 71, 70, 25]

In [147]: path_table_new                                                                                                       
Out[147]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1   TPS_20000_cp  gn_073_xpr1          888             54   TPS_20000_cp  gn_073_xpr2         62           71
2   TPS_20000_cp  gn_024_xpr2          395             71   TPS_20000_cp  gn_024_xpr1        605           70
3      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [148]: path_data_new                                                                                                        
Out[148]: 
   Traj  Start  End  Order
0   995      0  965      1
1   367     50  999      1
2   361    999    0     -1
3   714      0  739      1





######################### PATH_1017 k=5 #####################################

Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 714
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=5
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=5
path_new=np.array([[ 22, 995],[ 54, 367],[ 71, 361],[ 70, 714]])

path_start_end_new=np.array([[22, 54],[54, 71],[71, 70],[70, 25]])

path_Cluster_new=[22, 54, 71, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [154]: path_new                                                                                                             
Out[154]: 
array([[ 22, 995],
       [ 54, 367],
       [ 71, 361],
       [ 70, 714]])

In [155]: path_start_end_new                                                                                                   
Out[155]: 
array([[22, 54],
       [54, 71],
       [71, 70],
       [70, 25]])

In [156]: path_Cluster_new                                                                                                     
Out[156]: [22, 54, 71, 70, 25]

In [157]: path_table_new                                                                                                       
Out[157]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1   TPS_20000_cp  gn_073_xpr1          888             54   TPS_20000_cp  gn_073_xpr2         62           71
2   TPS_20000_cp  gn_024_xpr2          395             71   TPS_20000_cp  gn_024_xpr1        605           70
3      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [158]: path_data_new                                                                                                        
Out[158]: 
   Traj  Start  End  Order
0   995      0  965      1
1   367     50  999      1
2   361    999    0     -1
3   714      0  739      1





######################### PATH_1017 k=6 #####################################


Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 361
Next Cluster 71
Cluster 71 sampled by Traj 372
Next Cluster 64
Cluster 64 sampled by Traj 380
Next Cluster 64
Cluster 64 sampled by Traj 383
Next Cluster 64
Cluster 64 sampled by Traj 377
Next Cluster 1
Cluster 1 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 138
Next Cluster 68
Cluster 68 sampled by Traj 134
Next Cluster 68
Cluster 68 sampled by Traj 132
Next Cluster 1
Cluster 1 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 1170
Next Cluster 27
Cluster 27 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 1179
Next Cluster 27
Cluster 27 sampled by Traj 1182
Next Cluster 42
Cluster 42 sampled by Traj 1195
Next Cluster 29
Cluster 29 sampled by Traj 1194
Next Cluster 42
Cluster 42 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 714
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=6
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=6
path_new=np.array([[ 22, 994],[ 54, 208],[ 70, 714]])

path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])

path_Cluster_new=[22, 54, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)




fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [167]: path_new                                                                                                             
Out[167]: 
array([[ 22, 994],
       [ 54, 208],
       [ 70, 714]])

In [168]: path_start_end_new                                                                                                   
Out[168]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [169]: path_Cluster_new                                                                                                     
Out[169]: [22, 54, 70, 25]

In [170]: path_table_new                                                                                                       
Out[170]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1      TPS_12500  gn_011_xpr1          726             54      TPS_12500  gn_011_xpr2        217           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [171]: path_data_new                                                                                                        
Out[171]: 
   Traj  Start  End  Order
0   994     48  999      1
1   208     57  999      1
2   714      0  739      1


######################### PATH_1017 k=7 #####################################


Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 86
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 714
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=7
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=7
path_new=np.array([[ 22, 994],[ 54, 117],[ 70, 714]])

path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])

path_Cluster_new=[22, 54, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [192]: path_new                                                                                                             
Out[192]: 
array([[ 22, 994],
       [ 54, 117],
       [ 70, 714]])

In [193]: path_start_end_new                                                                                                   
Out[193]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [194]: path_Cluster_new                                                                                                     
Out[194]: [22, 54, 70, 25]

In [195]: path_table_new                                                                                                       
Out[195]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1       TPS_7500  gn_067_xpr1          379             54       TPS_7500  gn_067_xpr1          4           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [196]: path_data_new                                                                                                        
Out[196]: 
   Traj  Start  End  Order
0   994     48  999      1
1   117    302  677      1
2   714      0  739      1



######################### PATH_1017 k=8 #####################################


Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 1171
Next Cluster 71
Cluster 71 sampled by Traj 377
Next Cluster 1
Cluster 1 sampled by Traj 141
Next Cluster 1
Cluster 1 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 39
Cluster 39 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 715
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=8
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=8
path_new=np.array([[  22,  995],[  54, 1038],[  70,  715]])

path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])

path_Cluster_new=[22, 54, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [206]: path_new                                                                                                             
Out[206]: 
array([[  22,  995],
       [  54, 1038],
       [  70,  715]])

In [207]: path_start_end_new                                                                                                   
Out[207]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [208]: path_Cluster_new                                                                                                     
Out[208]: [22, 54, 70, 25]

In [209]: path_table_new                                                                                                       
Out[209]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1  TPS_7500_cp_2  gn_014_xpr1          849             54  TPS_7500_cp_2  gn_014_xpr2         33           70
2      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [210]: path_data_new                                                                                                        
Out[210]: 
   Traj  Start  End  Order
0   995      0  965      1
1  1038      0  881      1
2   715    999    0     -1





######################### PATH_1017 k=9 #####################################

Cluster 22 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 5
Cluster 5 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 715
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=9
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=9
path_new=np.array([[ 22, 994],[ 54, 979],[  5, 158],[ 70, 715]])
path_start_end_new=np.array([[22, 54],[54,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 5, 70, 25]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [219]: path_new                                                                                                             
Out[219]: 
array([[ 22, 994],
       [ 54, 979],
       [  5, 158],
       [ 70, 715]])

In [220]: path_start_end_new                                                                                                   
Out[220]: 
array([[22, 54],
       [54,  5],
       [ 5, 70],
       [70, 25]])

In [221]: path_Cluster_new                                                                                                     
Out[221]: [22, 54, 5, 70, 25]

In [222]: path_table_new                                                                                                       
Out[222]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_2500_cp_2  gn_004_xpr2           69             54  TPS_2500_cp_2  gn_004_xpr1        410            5
2      TPS_10000  gn_158_xpr2           85              5      TPS_10000  gn_158_xpr1        743           70
3      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [223]: path_data_new                                                                                                        
Out[223]: 
   Traj  Start  End  Order
0   994     48  999      1
1   979      0  478      1
2   158    999  172     -1
3   715    999    0     -1




######################### PATH_1017 k=10 #####################################


Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 140
Next Cluster 68
Cluster 68 sampled by Traj 136
Next Cluster 1
Cluster 1 sampled by Traj 137
Next Cluster 68
Cluster 68 sampled by Traj 141
Next Cluster 68
Cluster 68 sampled by Traj 139
Next Cluster 1
Cluster 1 sampled by Traj 138
Next Cluster 68
Cluster 68 sampled by Traj 134
Next Cluster 68
Cluster 68 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 361
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 27
Cluster 27 sampled by Traj 1178
Next Cluster 42
Cluster 42 sampled by Traj 1194
Next Cluster 42
Cluster 42 sampled by Traj 1179
Next Cluster 27
Cluster 27 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 51
Cluster 51 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 714
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=10
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=10
path_new=np.array([[  22,  994],[  54, 1043],[  70,  118],[   1,  138],[  68,  117],[  70,  361],[  71, 1171],[  27, 1172],[  70,  251],[  51,  250],[  70,  714]])
path_start_end_new=np.array([[22, 54],[54, 70],[70,  1],[ 1, 68],[68, 70],[70, 71],[71, 27],[27, 70],[70, 51],[51, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 1, 68, 70, 71, 27, 70, 51, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [230]: path_new                                                                                                             
Out[230]: 
array([[  22,  994],
       [  54, 1043],
       [  70,  118],
       [   1,  138],
       [  68,  117],
       [  70,  361],
       [  71, 1171],
       [  27, 1172],
       [  70,  251],
       [  51,  250],
       [  70,  714]])

In [231]: path_start_end_new                                                                                                   
Out[231]: 
array([[22, 54],
       [54, 70],
       [70,  1],
       [ 1, 68],
       [68, 70],
       [70, 71],
       [71, 27],
       [27, 70],
       [70, 51],
       [51, 70],
       [70, 25]])

In [232]: path_Cluster_new                                                                                                     
Out[232]: [22, 54, 70, 1, 68, 70, 71, 27, 70, 51, 70, 25]

In [233]: path_table_new                                                                                                       
Out[233]: 
      Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1    TPS_7500_cp_2  gn_128_xpr2          163             54   TPS_7500_cp_2  gn_128_xpr1        823           70
2         TPS_7500  gn_109_xpr2          188             70        TPS_7500  gn_109_xpr1        692            1
3         TPS_7500  gn_416_xpr1          734              1        TPS_7500  gn_416_xpr2         94           68
4         TPS_7500  gn_067_xpr1          636             68        TPS_7500  gn_067_xpr1          4           70
5     TPS_20000_cp  gn_024_xpr1          605             70    TPS_20000_cp  gn_024_xpr2        395           71
6   TPS_20000_cp_2  gn_060_xpr1          524             71  TPS_20000_cp_2  gn_060_xpr1        386           27
7   TPS_20000_cp_2  gn_066_xpr1          632             27  TPS_20000_cp_2  gn_066_xpr1        101           70
8     TPS_15000_cp  gn_528_xpr1           52             70    TPS_15000_cp  gn_528_xpr1        649           51
9     TPS_15000_cp  gn_525_xpr1          303             51    TPS_15000_cp  gn_525_xpr2        180           70
10       TPS_30000  gn_129_xpr2          499             70       TPS_30000  gn_129_xpr1        241           25

In [234]: path_data_new                                                                                                        
Out[234]: 
    Traj  Start  End  Order
0    994     48  999      1
1   1043    999   14     -1
2    118    120  999      1
3    138    999  172     -1
4    117     45  677      1
5    361      0  999      1
6   1171     35  173      1
7   1172      0  531      1
8    251    844  247     -1
9    250    198  680      1
10   714      0  739      1




######################### PATH_1017 k=11 #####################################


Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 490
Next Cluster 70
Cluster 70 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 62
Cluster 62 sampled by Traj 220
Next Cluster 62
Cluster 62 sampled by Traj 222
Next Cluster 55
Cluster 55 sampled by Traj 230
Next Cluster 55
Cluster 55 sampled by Traj 231
Next Cluster 55
Cluster 55 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 714
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=11
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=11
path_new=np.array([[  22,  994],[  54, 1031],[  70,  714]])
path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [252]: path_new                                                                                                             
Out[252]: 
array([[  22,  994],
       [  54, 1031],
       [  70,  714]])

In [253]: path_start_end_new                                                                                                   
Out[253]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [254]: path_Cluster_new                                                                                                     
Out[254]: [22, 54, 70, 25]

In [255]: path_table_new                                                                                                       
Out[255]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_5000_cp_2  gn_066_xpr2          349             54  TPS_5000_cp_2  gn_066_xpr1        138           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [256]: path_data_new                                                                                                        
Out[256]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1031      0  486      1
2   714      0  739      1



######################### PATH_1017 k=12 #####################################


Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 20
Cluster 20 sampled by Traj 187
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 714
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=12
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=12

path_new=np.array([[ 22, 995],[ 54, 175],[ 69, 192],[  5, 159],[ 70, 714]])
path_start_end_new=np.array([[22, 54],[54, 69],[69,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 69, 5, 70, 25]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [269]: path_Cluster_new                                                                                                     
Out[269]: [22, 54, 69, 5, 70, 25]

In [270]: path_new                                                                                                             
Out[270]: 
array([[ 22, 995],
       [ 54, 175],
       [ 69, 192],
       [  5, 159],
       [ 70, 714]])

In [271]: path_start_end_new                                                                                                   
Out[271]: 
array([[22, 54],
       [54, 69],
       [69,  5],
       [ 5, 70],
       [70, 25]])

In [272]: path_Cluster_new                                                                                                     
Out[272]: [22, 54, 69, 5, 70, 25]

In [273]: path_table_new                                                                                                       
Out[273]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1      TPS_10000  gn_308_xpr2          730             54      TPS_10000  gn_308_xpr1        111           69
2      TPS_10000  gn_455_xpr2          202             69      TPS_10000  gn_455_xpr1         92            5
3      TPS_10000  gn_176_xpr1          501              5      TPS_10000  gn_176_xpr2          2           70
4      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [274]: path_data_new                                                                                                        
Out[274]: 
   Traj  Start  End  Order
0   995      0  965      1
1   175    840    0     -1
2   192    943  650     -1
3   159      0  502      1
4   714      0  739      1




######################### PATH_1017 k=13 #####################################

Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 69
Cluster 69 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 39
Cluster 39 sampled by Traj 1061
Next Cluster 39
Cluster 39 sampled by Traj 1063
Next Cluster 3
Cluster 3 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 34
Cluster 34 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1121
Next Cluster 34
Cluster 34 sampled by Traj 1095
Next Cluster 38
Cluster 38 sampled by Traj 1104
Next Cluster 33
Cluster 33 sampled by Traj 1114
Next Cluster 33
Cluster 33 sampled by Traj 1112
Next Cluster 38
Cluster 38 sampled by Traj 1111
Next Cluster 33
Cluster 33 sampled by Traj 1115
Next Cluster 33
Cluster 33 sampled by Traj 1113
Next Cluster 38
Cluster 38 sampled by Traj 1126
Next Cluster 38
Cluster 38 sampled by Traj 1097
Next Cluster 34
Cluster 34 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 715
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=13
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=13
path_new=np.array([[  22,  994],[  54, 1041],[  34, 1083],[  70,  654],[  72,  660],[  10,  930],[  70,  715]])
path_start_end_new=np.array([[22, 54],[54, 34],[34, 70],[70, 72],[72, 10],[10, 70],[70, 25]])
path_Cluster_new=[22, 54, 34, 70, 72, 10, 70, 25]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [308]: path_new                                                                                                             
Out[308]: 
array([[  22,  994],
       [  54, 1041],
       [  34, 1083],
       [  70,  654],
       [  72,  660],
       [  10,  930],
       [  70,  715]])

In [309]: path_start_end_new                                                                                                   
Out[309]: 
array([[22, 54],
       [54, 34],
       [34, 70],
       [70, 72],
       [72, 10],
       [10, 70],
       [70, 25]])

In [310]: path_Cluster_new                                                                                                     
Out[310]: [22, 54, 34, 70, 72, 10, 70, 25]

In [311]: path_table_new                                                                                                       
Out[311]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_046_xpr1          779             34  TPS_12500_cp_2  gn_046_xpr2        221           70
3    TPS_27500_cp  gn_082_xpr2          295             70    TPS_27500_cp  gn_082_xpr1        705           72
4    TPS_27500_cp  gn_103_xpr1          141             72    TPS_27500_cp  gn_103_xpr2        295           10
5    TPS_37500_cp  gn_090_xpr2          815             10    TPS_37500_cp  gn_090_xpr1        185           70
6       TPS_30000  gn_130_xpr1          225             70       TPS_30000  gn_130_xpr2        775           25

In [312]: path_data_new                                                                                                        
Out[312]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1041      0  973      1
2  1083    999    0     -1
3   654      0  999      1
4   660    392  827      1
5   930      0  999      1
6   715    999    0     -1



######################### PATH_1017 k=14 #####################################


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=14
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=14
path_new=np.array([[ 22, 994],[ 54, 170],[ 69, 192],[  5, 158],[ 70, 714]])
path_start_end_new=np.array([[22, 54],[54, 69],[69,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 69, 5, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)




fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=1,fillstyle='none', color='pink', marker="o", mew=0.6, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.larger.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)




fig, ax = plt.subplots(figsize=(7, 3))
ax.scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
ax.plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
ax.set_xlabel('Path',fontsize=16, fontweight='bold')
ax.set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
ax.set_title('BOLAS', fontweight='bold',fontsize=16)
ax.tick_params(axis='both', labelsize=12)
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.larger.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 3))
ax.scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c='#b03dbe', marker="o",zorder=2)
ax.plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='#b03dbe', linewidth=0.3,zorder=1)
ax.set_xlabel('Path',fontsize=16, fontweight='bold')
ax.set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
ax.set_title('BOLAS', fontweight='bold',fontsize=16)
ax.tick_params(axis='both', labelsize=12)
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.020824.larger.png".format(nclusters,k),dpi=1200)


path_list_d=pd.DataFrame(path_path_cluster_dist)
path_list_d.to_csv("Path_list.lag=100.cluster={}.coord.region3.path{}.all.1017.022224.csv".format(nclusters,k))


In [315]: path_new                                                                                                             
Out[315]: 
array([[ 22, 994],
       [ 54, 170],
       [ 69, 192],
       [  5, 158],
       [ 70, 714]])

In [316]: path_start_end_new                                                                                                   
Out[316]: 
array([[22, 54],
       [54, 69],
       [69,  5],
       [ 5, 70],
       [70, 25]])

In [317]: path_Cluster_new                                                                                                     
Out[317]: [22, 54, 69, 5, 70, 25]

In [318]: path_table_new                                                                                                       
Out[318]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1      TPS_10000  gn_273_xpr2          265             54      TPS_10000  gn_273_xpr2        201           69
2      TPS_10000  gn_455_xpr2          202             69      TPS_10000  gn_455_xpr1         92            5
3      TPS_10000  gn_158_xpr2           85              5      TPS_10000  gn_158_xpr1        743           70
4      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [319]: path_data_new                                                                                                        
Out[319]: 
   Traj  Start  End  Order
0   994     48  999      1 *
1   170      0   64      1
2   192    943  650     -1 *
3   158    999  172     -1
4   714      0  739      1 *



Edited path:

In [316]: path_start_end_new                                                                                                   
Out[316]: 
array([[22, 54], 995 (994,995)
       [54, 69], 170 (170,175)
       [69,  5], 171 (160,168,170,171,173,174,175,176,179,181,187,189,192)
       [ 5, 70], 158 (158,159,175,483,979)
       [70, 25] 715 (714,715)


In [424]: path_table_new                                                                                                       
Out[424]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1      TPS_10000  gn_273_xpr2          265             54      TPS_10000  gn_273_xpr2        201           69
2      TPS_10000  gn_283_xpr1          530             69      TPS_10000  gn_283_xpr2        458            5
3      TPS_10000  gn_158_xpr2           85              5      TPS_10000  gn_158_xpr1        743           70
4      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25


In [425]: path_data_new                                                                                                        
Out[425]: 
   Traj  Start  End  Order
0   995      0  965      1
1   170      0   64      1
2   171    999   12     -1
3   158    999  172     -1
4   715    999    0     -1


######################### PATH_1017 k=15 #####################################



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=15
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=15

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [379]: path_new                                                                                                             
Out[379]: 
array([[  22,  994],
       [  54,  979],
       [   5,  175],
       [  39, 1060],
       [  70,  714]])

In [380]: path_start_end_new                                                                                                   
Out[380]: 
array([[22, 54],
       [54,  5],
       [ 5, 39],
       [39, 70],
       [70, 25]])

In [381]: path_Cluster_new                                                                                                     
Out[381]: [22, 54, 5, 39, 70, 25]

In [382]: path_table_new                                                                                                       
Out[382]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_2500_cp_2  gn_004_xpr2           69             54   TPS_2500_cp_2  gn_004_xpr1        410            5
2       TPS_10000  gn_308_xpr2          727              5       TPS_10000  gn_308_xpr2        875           39
3  TPS_10000_cp_2  gn_164_xpr2          678             39  TPS_10000_cp_2  gn_164_xpr1        295           70
4       TPS_30000  gn_129_xpr2          499             70       TPS_30000  gn_129_xpr1        241           25

In [383]: path_data_new                                                                                                        
Out[383]: 
   Traj  Start  End  Order
0   994     48  999      1
1   979      0  478      1
2   175    837  985      1
3  1060     27  999      1
4   714      0  739      1



In [387]: path_new                                                                                                             
Out[387]: 
array([[ 22, 994],
       [ 54, 170],
       [  5, 158],
       [ 70, 714]])

In [388]: path_start_end_new                                                                                                   
Out[388]: 
array([[22, 54],
       [54,  5],
       [ 5, 70],
       [70, 25]])

In [389]: path_Cluster_new                                                                                                     
Out[389]: [22, 54, 5, 70, 25]

In [390]: path_table_new                                                                                                       
Out[390]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1      TPS_10000  gn_273_xpr2          265             54      TPS_10000  gn_273_xpr1        735            5
2      TPS_10000  gn_158_xpr2           85              5      TPS_10000  gn_158_xpr1        743           70
3      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [391]: path_data_new                                                                                                        
Out[391]: 
   Traj  Start  End  Order
0   994     48  999      1
1   170      0  999      1
2   158    999  172     -1
3   714      0  739      1





######################### PATH_1017 k=17 #####################################


Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 136
Next Cluster 68
Cluster 68 sampled by Traj 141
Next Cluster 68
Cluster 68 sampled by Traj 140
Next Cluster 1
Cluster 1 sampled by Traj 137
Next Cluster 68
Cluster 68 sampled by Traj 132
Next Cluster 1
Cluster 1 sampled by Traj 139
Next Cluster 68
Cluster 68 sampled by Traj 138
Next Cluster 68
Cluster 68 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 715
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=17
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=17
path_new=np.array([[ 22, 995],[ 54, 170],[  5, 158],[ 70, 715]])
path_start_end_new=np.array([[22, 54],[54,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 5, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [421]: path_new                                                                                                             
Out[421]: 
array([[ 22, 995],
       [ 54, 170],
       [  5, 158],
       [ 70, 715]])

In [422]: path_start_end_new                                                                                                   
Out[422]: 
array([[22, 54],
       [54,  5],
       [ 5, 70],
       [70, 25]])

In [423]: path_Cluster_new                                                                                                     
Out[423]: [22, 54, 5, 70, 25]

In [424]: path_table_new                                                                                                       
Out[424]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1      TPS_10000  gn_273_xpr2          265             54      TPS_10000  gn_273_xpr1        735            5
2      TPS_10000  gn_158_xpr2           85              5      TPS_10000  gn_158_xpr1        743           70
3      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [425]: path_data_new                                                                                                        
Out[425]: 
   Traj  Start  End  Order
0   995      0  965      1
1   170      0  999      1
2   158    999  172     -1
3   715    999    0     -1




######################### PATH_1017 k=18 #####################################


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=18
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=18
path_new=np.array([[ 22, 994],[ 54, 170],[ 69, 188],[ 20, 192],[  5, 158],[ 70, 715]])
path_start_end_new=np.array([[22, 54],[54, 69],[69, 20],[20,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 69, 20, 5, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [438]: path_new                                                                                                             
Out[438]: 
array([[ 22, 994],
       [ 54, 170],
       [ 69, 188],
       [ 20, 192],
       [  5, 158],
       [ 70, 715]])

In [439]: path_start_end_new                                                                                                   
Out[439]: 
array([[22, 54],
       [54, 69],
       [69, 20],
       [20,  5],
       [ 5, 70],
       [70, 25]])

In [440]: path_Cluster_new                                                                                                     
Out[440]: [22, 54, 69, 20, 5, 70, 25]

In [441]: path_table_new                                                                                                       
Out[441]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1      TPS_10000  gn_273_xpr2          265             54      TPS_10000  gn_273_xpr2        201           69
2      TPS_10000  gn_416_xpr2           93             69      TPS_10000  gn_416_xpr1        750           20
3      TPS_10000  gn_455_xpr1          742             20      TPS_10000  gn_455_xpr1         92            5
4      TPS_10000  gn_158_xpr2           85              5      TPS_10000  gn_158_xpr1        743           70
5      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [442]: path_data_new                                                                                                        
Out[442]: 
   Traj  Start  End  Order
0   994     48  999      1
1   170      0   64      1
2   188    842    0     -1
3   192      0  650      1
4   158    999  172     -1
5   715    999    0     -1




######################### PATH_1017 k=19 #####################################


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=19
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=19
path_new=np.array([[ 22, 994],[ 54, 170],[ 69, 188],[ 20, 192],[  5, 158],[ 70, 715]])
path_start_end_new=np.array([[22, 54],[54, 69],[69, 20],[20,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 69, 20, 5, 70, 25]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [438]: path_new                                                                                                             
Out[438]: 
array([[ 22, 994],
       [ 54, 170],
       [ 69, 188],
       [ 20, 192],
       [  5, 158],
       [ 70, 715]])

In [439]: path_start_end_new                                                                                                   
Out[439]: 
array([[22, 54],
       [54, 69],
       [69, 20],
       [20,  5],
       [ 5, 70],
       [70, 25]])

In [440]: path_Cluster_new                                                                                                     
Out[440]: [22, 54, 69, 20, 5, 70, 25]

In [441]: path_table_new                                                                                                       
Out[441]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1      TPS_10000  gn_273_xpr2          265             54      TPS_10000  gn_273_xpr2        201           69
2      TPS_10000  gn_416_xpr2           93             69      TPS_10000  gn_416_xpr1        750           20
3      TPS_10000  gn_455_xpr1          742             20      TPS_10000  gn_455_xpr1         92            5
4      TPS_10000  gn_158_xpr2           85              5      TPS_10000  gn_158_xpr1        743           70
5      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [442]: path_data_new                                                                                                        
Out[442]: 
   Traj  Start  End  Order
0   994     48  999      1
1   170      0   64      1
2   188    842    0     -1
3   192      0  650      1
4   158    999  172     -1
5   715    999    0     -1




######################### PATH_1017 k=20 #####################################


Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 69
Cluster 69 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1097
Next Cluster 34
Cluster 34 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1121
Next Cluster 34
Cluster 34 sampled by Traj 1095
Next Cluster 34
Cluster 34 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 715
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=20
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=20
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [464]: path_new                                                                                                             
Out[464]: 
array([[  22,  994],
       [  54,  175],
       [  69,  168],
       [   5,  158],
       [  34, 1084],
       [  70,  715]])

In [465]: path_start_end_new                                                                                                   
Out[465]: 
array([[22, 54],
       [54, 69],
       [69,  5],
       [ 5, 34],
       [34, 70],
       [70, 25]])

In [466]: path_Cluster_new                                                                                                     
Out[466]: [22, 54, 69, 5, 34, 70, 25]

In [467]: path_table_new                                                                                                       
Out[467]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1       TPS_10000  gn_308_xpr2          730             54       TPS_10000  gn_308_xpr1        111           69
2       TPS_10000  gn_258_xpr2          252             69       TPS_10000  gn_258_xpr1        461            5
3       TPS_10000  gn_158_xpr2           85              5       TPS_10000  gn_158_xpr1        754           34
4  TPS_12500_cp_2  gn_087_xpr2          506             34  TPS_12500_cp_2  gn_087_xpr1        357           70
5       TPS_30000  gn_130_xpr1          225             70       TPS_30000  gn_130_xpr2        775           25

In [468]: path_data_new                                                                                                        
Out[468]: 
   Traj  Start  End  Order
0   994     48  999      1
1   175    840    0     -1
2   168    712    0     -1
3   158    999  161     -1
4  1084      0  862      1
5   715    999    0     -1




######################### PATH_1017 k=21 #####################################

Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 715
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=21
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=21
path_new=np.array([[ 22, 994],[ 54, 175],[ 69, 171],[  5, 158],[ 70, 715]])
path_start_end_new=np.array([[22, 54],[54, 69],[69,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 69, 5, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [482]: path_new                                                                                                             
Out[482]: 
array([[ 22, 994],
       [ 54, 175],
       [ 69, 171],
       [  5, 158],
       [ 70, 715]])

In [483]: path_start_end_new                                                                                                   
Out[483]: 
array([[22, 54],
       [54, 69],
       [69,  5],
       [ 5, 70],
       [70, 25]])

In [484]: path_Cluster_new                                                                                                     
Out[484]: [22, 54, 69, 5, 70, 25]

In [485]: path_table_new                                                                                                       
Out[485]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1      TPS_10000  gn_308_xpr2          730             54      TPS_10000  gn_308_xpr1        111           69
2      TPS_10000  gn_283_xpr1          530             69      TPS_10000  gn_283_xpr2        458            5
3      TPS_10000  gn_158_xpr2           85              5      TPS_10000  gn_158_xpr1        743           70
4      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [486]: path_data_new                                                                                                        
Out[486]: 
   Traj  Start  End  Order
0   994     48  999      1
1   175    840    0     -1
2   171    999   12     -1
3   158    999  172     -1
4   715    999    0     -1




######################### PATH_1017 k=22 #####################################


Cluster 22 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 715
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=22
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=22
path_new=np.array([[ 22, 995],[ 54, 170],[  5, 191],[ 20, 185],[ 69, 175],[ 70, 715]])
path_start_end_new=np.array([[22, 54],[54,  5],[ 5, 20],[20, 69],[69, 70],[70, 25]])
path_Cluster_new=[22, 54, 5, 20, 69, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [510]: path_new                                                                                                             
Out[510]: 
array([[ 22, 995],
       [ 54, 170],
       [  5, 191],
       [ 20, 185],
       [ 69, 175],
       [ 70, 715]])

In [511]: path_start_end_new                                                                                                   
Out[511]: 
array([[22, 54],
       [54,  5],
       [ 5, 20],
       [20, 69],
       [69, 70],
       [70, 25]])

In [512]: path_Cluster_new                                                                                                     
Out[512]: [22, 54, 5, 20, 69, 70, 25]

In [513]: path_table_new                                                                                                       
Out[513]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1      TPS_10000  gn_273_xpr2          265             54      TPS_10000  gn_273_xpr1        735            5
2      TPS_10000  gn_448_xpr1           19              5      TPS_10000  gn_448_xpr1        501           20
3      TPS_10000  gn_397_xpr1           30             20      TPS_10000  gn_397_xpr2        673           69
4      TPS_10000  gn_308_xpr1          111             69      TPS_10000  gn_308_xpr2        738           70
5      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [514]: path_data_new                                                                                                        
Out[514]: 
   Traj  Start  End  Order
0   995      0  965      1
1   170      0  999      1
2   191    517  999      1
3   185    702    0     -1
4   175      0  848      1
5   715    999    0     -1




######################### PATH_1017 k=23 #####################################

Cluster 22 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 1063
Next Cluster 39
Cluster 39 sampled by Traj 1072
Next Cluster 39
Cluster 39 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 490
Next Cluster 70
Cluster 70 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 715
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=23
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)




k=23

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)




fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [555]: path_new                                                                                                             
Out[555]: 
array([[  22,  994],
       [  54,   76],
       [   3, 1063],
       [  39, 1060],
       [  70,  715]])

In [556]: path_start_end_new                                                                                                   
Out[556]: 
array([[22, 54],
       [54,  3],
       [ 3, 39],
       [39, 70],
       [70, 25]])

In [557]: path_table_new                                                                                                       
Out[557]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1     TPS_5000_cp  gn_028_xpr2          258             54     TPS_5000_cp  gn_028_xpr1        742            3
2  TPS_10000_cp_2  gn_207_xpr2          808              3  TPS_10000_cp_2  gn_207_xpr1        189           39
3  TPS_10000_cp_2  gn_164_xpr2          678             39  TPS_10000_cp_2  gn_164_xpr1        295           70
4       TPS_30000  gn_130_xpr1          225             70       TPS_30000  gn_130_xpr2        775           25

In [558]: path_data_new                                                                                                        
Out[558]: 
   Traj  Start  End  Order
0   994     48  999      1
1    76    999    0     -1
2  1063      3  999      1
3  1060     27  999      1
4   715    999    0     -1




######################### PATH_1017 k=24 #####################################


Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 51
Cluster 51 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 363
Next Cluster 71
Cluster 71 sampled by Traj 372
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 71
Cluster 71 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 158
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 715
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=24
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=24
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [629]: path_new                                                                                                             
Out[629]: 
array([[  22,  995],
       [  54, 1040],
       [  70,  363],
       [  71,  362],
       [  70, 1041],
       [  34,  158],
       [   5,  189],
       [  20,  188],
       [  69,  160],
       [   5,  483],
       [  70,  715]])

In [630]: path_start_end_new                                                                                                   
Out[630]: 
array([[22, 54],
       [54, 70],
       [70, 71],
       [71, 70],
       [70, 34],
       [34,  5],
       [ 5, 20],
       [20, 69],
       [69,  5],
       [ 5, 70],
       [70, 25]])

In [631]: path_table_new                                                                                                       
Out[631]: 
     Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1   TPS_7500_cp_2  gn_117_xpr2          900             54  TPS_7500_cp_2  gn_117_xpr1         93           70
2    TPS_20000_cp  gn_033_xpr2          182             70   TPS_20000_cp  gn_033_xpr1        808           71
3    TPS_20000_cp  gn_030_xpr2          144             71   TPS_20000_cp  gn_030_xpr1        841           70
4   TPS_7500_cp_2  gn_125_xpr2          235             70  TPS_7500_cp_2  gn_125_xpr2        662           34
5       TPS_10000  gn_158_xpr1          754             34      TPS_10000  gn_158_xpr2         85            5
6       TPS_10000  gn_418_xpr2          347              5      TPS_10000  gn_418_xpr1        132           20
7       TPS_10000  gn_416_xpr1          750             20      TPS_10000  gn_416_xpr2         93           69
8       TPS_10000  gn_178_xpr1          410             69      TPS_10000  gn_178_xpr2        249            5
9    TPS_22500_cp  gn_013_xpr2          487              5   TPS_22500_cp  gn_013_xpr1        499           70
10      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [632]: path_data_new                                                                                                        
Out[632]: 
    Traj  Start  End  Order
0    995      0  965      1
1   1040      0  992      1
2    363     10  999      1
3    362    985    1     -1
4   1041    546  973      1
5    158    161  999      1
6    189    152  630      1
7    188      0  842      1
8    160    341  999      1
9    483    985    0     -1
10   715    999    0     -1

In [633]: path_Cluster_new                                                                                                     
Out[633]: [22, 54, 70, 71, 70, 34, 5, 20, 69, 5, 70, 25]



######################### PATH_1017 k=25 #####################################


Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 187
Next Cluster 69
Cluster 69 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 70
Cluster 70 sampled by Traj 715
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=25
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=25
path_new=np.array([[ 22, 994],[ 54, 175],[ 69, 174],[  5, 483],[ 70, 715]])
path_start_end_new=np.array([[22, 54],[54, 69],[69,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 69, 5, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [648]: path_new                                                                                                             
Out[648]: 
array([[ 22, 994],
       [ 54, 175],
       [ 69, 174],
       [  5, 483],
       [ 70, 715]])

In [649]: path_start_end_new                                                                                                   
Out[649]: 
array([[22, 54],
       [54, 69],
       [69,  5],
       [ 5, 70],
       [70, 25]])

In [650]: path_Cluster_new                                                                                                     
Out[650]: [22, 54, 69, 5, 70, 25]

In [651]: path_table_new                                                                                                       
Out[651]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1      TPS_10000  gn_308_xpr2          730             54      TPS_10000  gn_308_xpr1        111           69
2      TPS_10000  gn_296_xpr2          796             69      TPS_10000  gn_296_xpr1        204            5
3   TPS_22500_cp  gn_013_xpr2          487              5   TPS_22500_cp  gn_013_xpr1        499           70
4      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [652]: path_data_new                                                                                                        
Out[652]: 
   Traj  Start  End  Order
0   994     48  999      1
1   175    840    0     -1
2   174      0  999      1
3   483    985    0     -1
4   715    999    0     -1




######################### PATH_1017 k=26 #####################################



Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 175
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 160
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 5
Cluster 5 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 715
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=26
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)





k=26
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)




fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)





######################### PATH_1017 k=27 #####################################



Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 714
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=27
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.png".format(nclusters,k),dpi=1200)


######################### PATH_1017 k=28 #####################################


Cluster 22 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 1170
Next Cluster 42
Cluster 42 sampled by Traj 1171
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 71
Cluster 71 sampled by Traj 372
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 714
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=28
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.png".format(nclusters,k),dpi=1200)




######################### PATH_1017 k=29 #####################################



Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 714
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=29
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=29
path_new=np.array([[ 22, 994],[ 54, 117],[ 70, 714]])
path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1025.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [47]: path_new                                                                                                                 
Out[47]: 
array([[ 22, 994],
       [ 54, 117],
       [ 70, 714]])

In [48]: path_start_end_new                                                                                                       
Out[48]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [49]: path_Cluster_new                                                                                                         
Out[49]: [22, 54, 70, 25]

In [50]: path_table_new                                                                                                           
Out[50]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1       TPS_7500  gn_067_xpr1          379             54       TPS_7500  gn_067_xpr1          4           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [51]: path_data_new                                                                                                            
Out[51]: 
   Traj  Start  End  Order
0   994     48  999      1
1   117    302  677      1
2   714      0  739      1






######################### PATH_1017 k=30 #####################################

Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 489
Next Cluster 70
Cluster 70 sampled by Traj 715
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=30
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=30
path_new=np.array([[  22,  994],[  54, 1133],[  70,  715]])
path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 25]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [86]: path_new                                                                                                                 
Out[86]: 
array([[  22,  994],
       [  54, 1133],
       [  70,  715]])

In [87]: path_start_end_new                                                                                                       
Out[87]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [88]: path_Cluster_new                                                                                                         
Out[88]: [22, 54, 70, 25]

In [89]: path_table_new                                                                                                           
Out[89]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
2       TPS_30000  gn_130_xpr1          225             70       TPS_30000  gn_130_xpr2        775           25

In [90]: path_data_new                                                                                                            
Out[90]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1133    607    0     -1
2   715    999    0     -1






######################### PATH_1017 k=31 #####################################



Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 86
Next Cluster 3
Cluster 3 sampled by Traj 1063
Next Cluster 3
Cluster 3 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 490
Next Cluster 70
Cluster 70 sampled by Traj 714
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=31
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=31
path_new=np.array([[  22,  994],[  54, 1133],[  70,  714]])
path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 25]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)




In [95]: path_new                                                                                                                 
Out[95]: 
array([[  22,  994],
       [  54, 1133],
       [  70,  714]])

In [96]: path_start_end_new                                                                                                       
Out[96]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [97]: path_Cluster_new                                                                                                         
Out[97]: [22, 54, 70, 25]

In [98]: path_table_new                                                                                                           
Out[98]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
2       TPS_30000  gn_129_xpr2          499             70       TPS_30000  gn_129_xpr1        241           25

In [99]: path_data_new                                                                                                            
Out[99]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1133    607    0     -1
2   714      0  739      1




######################### PATH_1017 k=32 #####################################



Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 16
Next Cluster 74
Cluster 74 sampled by Traj 18
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 189
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 714
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=32
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=32
path_new=np.array([[ 22, 994],[ 54, 271],[ 70, 175],[ 69, 198],[ 20, 190],[  5, 158],[ 70, 714]])
path_start_end_new=np.array([[22, 54],[54, 70],[70, 69],[69, 20],[20,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 69, 20, 5, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)




fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [119]: path_new                                                                                                                
Out[119]: 
array([[ 22, 994],
       [ 54, 271],
       [ 70, 175],
       [ 69, 198],
       [ 20, 190],
       [  5, 158],
       [ 70, 714]])

In [120]: path_start_end_new                                                                                                      
Out[120]: 
array([[22, 54],
       [54, 70],
       [70, 69],
       [69, 20],
       [20,  5],
       [ 5, 70],
       [70, 25]])

In [121]: path_Cluster_new                                                                                                        
Out[121]: [22, 54, 70, 69, 20, 5, 70, 25]

In [122]: path_table_new                                                                                                          
Out[122]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_17500_cp  gn_064_xpr1          363             54   TPS_17500_cp  gn_064_xpr2        204           70
2      TPS_10000  gn_308_xpr2          738             70      TPS_10000  gn_308_xpr1        111           69
3      TPS_10000  gn_504_xpr1          906             69      TPS_10000  gn_504_xpr2         79           20
4      TPS_10000  gn_438_xpr1          336             20      TPS_10000  gn_438_xpr2        281            5
5      TPS_10000  gn_158_xpr2           85              5      TPS_10000  gn_158_xpr1        743           70
6      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [123]: path_data_new                                                                                                           
Out[123]: 
   Traj  Start  End  Order
0   994     48  999      1
1   271    433  999      1
2   175    848    0     -1
3   198     15  999      1
4   190    214  830      1
5   158    999  172     -1
6   714      0  739      1





######################### PATH_1017 k=33 #####################################


Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 27
Cluster 27 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 1178
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 27
Cluster 27 sampled by Traj 1182
Next Cluster 42
Cluster 42 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 714
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=33
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=33
path_new=np.array([[  22,  995],[  54,  362],[  71, 1171],[  27, 1182],[  42, 1170],[  70,  714]])
path_start_end_new=np.array([[22, 54],[54, 71],[71, 27],[27, 42],[42, 70],[70, 25]])
path_Cluster_new=[22, 54, 71, 27, 42, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [129]: path_new                                                                                                                
Out[129]: 
array([[  22,  995],
       [  54,  362],
       [  71, 1171],
       [  27, 1182],
       [  42, 1170],
       [  70,  714]])

In [130]: path_start_end_new                                                                                                      
Out[130]: 
array([[22, 54],
       [54, 71],
       [71, 27],
       [27, 42],
       [42, 70],
       [70, 25]])

In [131]: path_Cluster_new                                                                                                        
Out[131]: [22, 54, 71, 27, 42, 70, 25]

In [132]: path_table_new                                                                                                          
Out[132]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
1    TPS_20000_cp  gn_030_xpr1          842             54    TPS_20000_cp  gn_030_xpr2        144           71
2  TPS_20000_cp_2  gn_060_xpr1          524             71  TPS_20000_cp_2  gn_060_xpr1        386           27
3  TPS_20000_cp_2  gn_144_xpr2          277             27  TPS_20000_cp_2  gn_144_xpr1        622           42
4  TPS_20000_cp_2  gn_044_xpr2          464             42  TPS_20000_cp_2  gn_044_xpr1        536           70
5       TPS_30000  gn_129_xpr2          499             70       TPS_30000  gn_129_xpr1        241           25

In [133]: path_data_new                                                                                                           
Out[133]: 
   Traj  Start  End  Order
0   995      0  965      1
1   362      0  985      1
2  1171     35  173      1
3  1182    898    0     -1
4  1170      0  999      1
5   714      0  739      1




######################### PATH_1017 k=34 #####################################


Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1095
Next Cluster 38
Cluster 38 sampled by Traj 1112
Next Cluster 38
Cluster 38 sampled by Traj 1113
Next Cluster 33
Cluster 33 sampled by Traj 1114
Next Cluster 38
Cluster 38 sampled by Traj 1104
Next Cluster 33
Cluster 33 sampled by Traj 1121
Next Cluster 33
Cluster 33 sampled by Traj 1111
Next Cluster 38
Cluster 38 sampled by Traj 1126
Next Cluster 33
Cluster 33 sampled by Traj 1115
Next Cluster 38
Cluster 38 sampled by Traj 1097
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 69
Cluster 69 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 69
Cluster 69 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 714
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=34
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=34
path_new=np.array([[ 22, 994],[ 54, 979],[  5, 159],[ 70, 714]])
path_start_end_new=np.array([[22, 54],[54,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 5, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1025.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [147]: path_new                                                                                                                
Out[147]: 
array([[ 22, 994],
       [ 54, 979],
       [  5, 159],
       [ 70, 714]])

In [148]: path_start_end_new                                                                                                      
Out[148]: 
array([[22, 54],
       [54,  5],
       [ 5, 70],
       [70, 25]])

In [149]: path_Cluster_new                                                                                                        
Out[149]: [22, 54, 5, 70, 25]

In [150]: path_table_new                                                                                                          
Out[150]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_2500_cp_2  gn_004_xpr2           69             54  TPS_2500_cp_2  gn_004_xpr1        410            5
2      TPS_10000  gn_176_xpr1          501              5      TPS_10000  gn_176_xpr2          2           70
3      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [151]: path_data_new                                                                                                           
Out[151]: 
   Traj  Start  End  Order
0   994     48  999      1
1   979      0  478      1
2   159      0  502      1
3   714      0  739      1




######################### PATH_1017 k=35 #####################################


Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 715
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=35
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=35
path_new=np.array([[  22,  994],[  54, 1056],[  70,  715]])
path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 25]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [154]: path_new                                                                                                                
Out[154]: 
array([[  22,  994],
       [  54, 1056],
       [  70,  715]])

In [155]: path_start_end_new                                                                                                      
Out[155]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [156]: path_Cluster_new                                                                                                        
Out[156]: [22, 54, 70, 25]

In [157]: path_table_new                                                                                                          
Out[157]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_10000_cp_2  gn_058_xpr1          323             54  TPS_10000_cp_2  gn_058_xpr2        327           70
2       TPS_30000  gn_130_xpr1          225             70       TPS_30000  gn_130_xpr2        775           25

In [158]: path_data_new                                                                                                           
Out[158]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1056    350  999      1
2   715    999    0     -1




######################### PATH_1017 k=36 #####################################


Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 51
Cluster 51 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 714
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=36
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=36
path_new=np.array([[ 22, 994],[ 54, 362],[ 70, 714]])
path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [173]: path_new                                                                                                                
Out[173]: 
array([[ 22, 994],
       [ 54, 362],
       [ 70, 714]])

In [174]: path_start_end_new                                                                                                      
Out[174]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [175]: path_Cluster_new                                                                                                        
Out[175]: [22, 54, 70, 25]

In [176]: path_table_new                                                                                                          
Out[176]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_20000_cp  gn_030_xpr1          842             54   TPS_20000_cp  gn_030_xpr1        807           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [177]: path_data_new                                                                                                           
Out[177]: 
   Traj  Start  End  Order
0   994     48  999      1
1   362      0   35      1
2   714      0  739      1




######################### PATH_1017 k=37 #####################################

Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 20
Cluster 20 sampled by Traj 187
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 189
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 714
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=37
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)




k=37
path_new=np.array([[ 22, 994],[ 54, 979],[ 20, 184],[ 69, 160],[  5, 158],[ 70, 714]])
path_start_end_new=np.array([[22, 54],[54, 20],[20, 69],[69,  5],[ 5, 70],[70, 25]])
path_Cluster_new=[22, 54, 20, 69, 5, 70, 25]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [215]: path_new                                                                                                                
Out[215]: 
array([[ 22, 994],
       [ 54, 979],
       [ 20, 184],
       [ 69, 160],
       [  5, 158],
       [ 70, 714]])

In [216]: path_start_end_new                                                                                                      
Out[216]: 
array([[22, 54],
       [54, 20],
       [20, 69],
       [69,  5],
       [ 5, 70],
       [70, 25]])

In [217]: path_Cluster_new                                                                                                        
Out[217]: [22, 54, 20, 69, 5, 70, 25]

In [218]: path_table_new                                                                                                          
Out[218]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_2500_cp_2  gn_004_xpr2           69             54  TPS_2500_cp_2  gn_004_xpr1        344           20
2      TPS_10000  gn_390_xpr1          284             20      TPS_10000  gn_390_xpr2        436           69
3      TPS_10000  gn_178_xpr1          410             69      TPS_10000  gn_178_xpr2        249            5
4      TPS_10000  gn_158_xpr2           85              5      TPS_10000  gn_158_xpr1        743           70
5      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [219]: path_data_new                                                                                                           
Out[219]: 
   Traj  Start  End  Order
0   994     48  999      1
1   979      0  412      1
2   184    719    0     -1
3   160    341  999      1
4   158    999  172     -1
5   714      0  739      1



######################### PATH_1017 k=38 #####################################


Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 39
Cluster 39 sampled by Traj 1063
Next Cluster 39
Cluster 39 sampled by Traj 1072
Next Cluster 39
Cluster 39 sampled by Traj 1071
Next Cluster 39
Cluster 39 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 489
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 715
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=38
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=38

path_new=np.array([[  22,  994],[  54, 1044],[  70,  715]])
path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 25]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)




fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)


In [224]: path_new                                                                                                                
Out[224]: 
array([[  22,  994],
       [  54, 1044],
       [  70,  715]])

In [225]: path_start_end_new                                                                                                      
Out[225]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [226]: path_Cluster_new                                                                                                        
Out[226]: [22, 54, 70, 25]

In [227]: path_table_new                                                                                                          
Out[227]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_7500_cp_2  gn_156_xpr1          744             54  TPS_7500_cp_2  gn_156_xpr2        230           70
2      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [228]: path_data_new                                                                                                           
Out[228]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1044    999   26     -1
2   715    999    0     -1





######################### PATH_1017 k=39 #####################################


Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 714
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=39
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)




k=39
path_new=np.array([[  22,  994],[  54, 1031],[  70,  714]])
path_start_end_new=np.array([[22, 54],[54, 70],[70, 25]])
path_Cluster_new=[22, 54, 70, 25]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1025.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [233]: path_new                                                                                                                
Out[233]: 
array([[  22,  994],
       [  54, 1031],
       [  70,  714]])

In [234]: path_start_end_new                                                                                                      
Out[234]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [235]: path_Cluster_new                                                                                                        
Out[235]: [22, 54, 70, 25]

In [236]: path_table_new                                                                                                          
Out[236]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_5000_cp_2  gn_066_xpr2          349             54  TPS_5000_cp_2  gn_066_xpr1        138           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [237]: path_data_new                                                                                                           
Out[237]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1031      0  486      1
2   714      0  739      1




######################### PATH_1017 k=40 #####################################


Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 377
Next Cluster 64
Cluster 64 sampled by Traj 372
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 70
Cluster 70 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 715
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=40
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=40
path_new=np.array([[ 22, 994],[ 54, 367],[ 71, 272],[ 70, 715]])
path_start_end_new=np.array([[22, 54],[54, 71],[71, 70],[70, 25]])
path_Cluster_new=[22, 54, 71, 70, 25]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1017.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1017.01222024.png".format(nclusters,k),dpi=1200)



In [252]: path_new                                                                                                                
Out[252]: 
array([[ 22, 994],
       [ 54, 367],
       [ 71, 272],
       [ 70, 715]])

In [253]: path_start_end_new                                                                                                      
Out[253]: 
array([[22, 54],
       [54, 71],
       [71, 70],
       [70, 25]])

In [254]: path_Cluster_new                                                                                                        
Out[254]: [22, 54, 71, 70, 25]

In [255]: path_table_new                                                                                                          
Out[255]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_20000_cp  gn_073_xpr1          888             54   TPS_20000_cp  gn_073_xpr2         62           71
2   TPS_17500_cp  gn_079_xpr1          334             71   TPS_17500_cp  gn_079_xpr2         87           70
3      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [256]: path_data_new                                                                                                           
Out[256]: 
   Traj  Start  End  Order
0   994     48  999      1
1   367     50  999      1
2   272    579  999      1
3   715    999    0     -1





######################### PATH_1020 k=0 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 714
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 490
Next Cluster 70
Cluster 70 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 659
Next Cluster 10
Cluster 10 sampled by Traj 941
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=0
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=0
path_new=np.array([[  17,    0],[  54, 1038],[  70,  158],[  34, 1084],[  70,  930],[  10,  941]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 34],[34, 70],[70, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 34, 70, 10, 48]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)


In [277]: path_new                                                                                                                
Out[277]: 
array([[  17,    0],
       [  54, 1038],
       [  70,  158],
       [  34, 1084],
       [  70,  930],
       [  10,  941]])

In [278]: path_start_end_new                                                                                                      
Out[278]: 
array([[17, 54],
       [54, 70],
       [70, 34],
       [34, 70],
       [70, 10],
       [10, 48]])

In [279]: path_Cluster_new                                                                                                        
Out[279]: [17, 54, 70, 34, 70, 10, 48]

In [280]: path_table_new                                                                                                          
Out[280]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1   TPS_7500_cp_2  gn_014_xpr1          849             54   TPS_7500_cp_2  gn_014_xpr2         33           70
2       TPS_10000  gn_158_xpr2           54             70       TPS_10000  gn_158_xpr1        754           34
3  TPS_12500_cp_2  gn_087_xpr2          506             34  TPS_12500_cp_2  gn_087_xpr1        357           70
4    TPS_37500_cp  gn_090_xpr1          185             70    TPS_37500_cp  gn_090_xpr2        815           10
5    TPS_37500_cp  gn_207_xpr1           29             10    TPS_37500_cp  gn_207_xpr1        651           48

In [281]: path_data_new                                                                                                           
Out[281]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1038      0  881      1
2   158    968  161     -1
3  1084      0  862      1
4   930    999    0     -1
5   941    622    0     -1



######################### PATH_1020 k=1 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 659
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 941
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=1
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=1
path_new=np.array([[ 17,   0],[ 54, 208],[ 70, 654],[ 72, 665],[ 10, 941]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 72],[72, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 72, 10, 48]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)


In [296]: path_new                                                                                                                
Out[296]: 
array([[ 17,   0],
       [ 54, 208],
       [ 70, 654],
       [ 72, 665],
       [ 10, 941]])

In [297]: path_start_end_new                                                                                                      
Out[297]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [298]: path_Cluster_new                                                                                                        
Out[298]: [17, 54, 70, 72, 10, 48]

In [299]: path_table_new                                                                                                          
Out[299]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1     TPS_12500  gn_011_xpr1          726             54     TPS_12500  gn_011_xpr2        217           70
2  TPS_27500_cp  gn_082_xpr2          295             70  TPS_27500_cp  gn_082_xpr1        705           72
3  TPS_27500_cp  gn_125_xpr2          190             72  TPS_27500_cp  gn_125_xpr1        671           10
4  TPS_37500_cp  gn_207_xpr1           29             10  TPS_37500_cp  gn_207_xpr1        651           48

In [300]: path_data_new                                                                                                           
Out[300]: 
   Traj  Start  End  Order
0     0      0  945      1
1   208     57  999      1
2   654      0  999      1
3   665    139  999      1
4   941    622    0     -1




######################### PATH_1020 k=2 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 71
Cluster 71 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=2
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=2
path_new=np.array([[  17,    0],[  54, 1040],[  70,  654],[  72,  664],[  10,  940]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 72],[72, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 72, 10, 48]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)


In [342]: path_new                                                                                                                
Out[342]: 
array([[  17,    0],
       [  54, 1040],
       [  70,  654],
       [  72,  664],
       [  10,  940]])

In [343]: path_start_end_new                                                                                                      
Out[343]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [344]: path_Cluster_new                                                                                                        
Out[344]: [17, 54, 70, 72, 10, 48]

In [345]: path_table_new                                                                                                          
Out[345]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_117_xpr2          900             54  TPS_7500_cp_2  gn_117_xpr1         93           70
2   TPS_27500_cp  gn_082_xpr2          295             70   TPS_27500_cp  gn_082_xpr1        705           72
3   TPS_27500_cp  gn_121_xpr1          408             72   TPS_27500_cp  gn_121_xpr2        284           10
4   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [346]: path_data_new                                                                                                           
Out[346]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1040      0  992      1
2   654      0  999      1
3   664    308  999      1
4   940    999    0     -1



######################### PATH_1020 k=3 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 272
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=3
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=3
path_new=np.array([[  17,    0],[  54, 1029],[  70,  662],[  10,  940]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 10, 48]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [402]: path_new                                                                                                                
Out[402]: 
array([[  17,    0],
       [  54, 1029],
       [  70,  662],
       [  10,  940]])

In [403]: path_start_end_new                                                                                                      
Out[403]: 
array([[17, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [404]: path_Cluster_new                                                                                                        
Out[404]: [17, 54, 70, 10, 48]

In [405]: path_table_new                                                                                                          
Out[405]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_5000_cp_2  gn_011_xpr1          752             54  TPS_5000_cp_2  gn_011_xpr2         19           70
2   TPS_27500_cp  gn_108_xpr1           40             70   TPS_27500_cp  gn_108_xpr2        671           10
3   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [406]: path_data_new                                                                                                           
Out[406]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1029      0  770      1
2   662    268  978      1
3   940    999    0     -1





######################### PATH_1020 k=4 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 16
Next Cluster 18
Cluster 18 sampled by Traj 20
Next Cluster 40
Cluster 40 sampled by Traj 25
Next Cluster 18
Cluster 18 sampled by Traj 34
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 51
Cluster 51 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 715
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 34
Cluster 34 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1097
Next Cluster 34
Cluster 34 sampled by Traj 1121
Next Cluster 33
Cluster 33 sampled by Traj 1104
Next Cluster 38
Cluster 38 sampled by Traj 1114
Next Cluster 38
Cluster 38 sampled by Traj 1095
Next Cluster 34
Cluster 34 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 272
Next Cluster 70
Cluster 70 sampled by Traj 489
Next Cluster 70
Cluster 70 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 27
Cluster 27 sampled by Traj 1182
Next Cluster 27
Cluster 27 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 1170
Next Cluster 27
Cluster 27 sampled by Traj 1178
Next Cluster 42
Cluster 42 sampled by Traj 1195
Next Cluster 42
Cluster 42 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 175
Next Cluster 55
Cluster 55 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 372
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=4
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=4
path_new=np.array([[  17,    5],[  74,   16],[  18,   28],[  54, 1133],[  70,  662],[  10,  940]])
path_start_end_new=np.array([[17, 74],[74, 18],[18, 54],[54, 70],[70, 10],[10, 48]])
path_Cluster_new=[17, 74, 18, 54, 70, 10, 48]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)


In [428]: path_new                                                                                                                
Out[428]: 
array([[  17,    5],
       [  74,   16],
       [  18,   28],
       [  54, 1133],
       [  70,  662],
       [  10,  940]])

In [429]: path_start_end_new                                                                                                      
Out[429]: 
array([[17, 74],
       [74, 18],
       [18, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [430]: path_Cluster_new                                                                                                        
Out[430]: [17, 74, 18, 54, 70, 10, 48]

In [431]: path_table_new                                                                                                          
Out[431]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_029_xpr2          264             17     TPS_2500_cp  gn_029_xpr1        736           74
1     TPS_2500_cp  gn_119_xpr2          100             74     TPS_2500_cp  gn_119_xpr1        900           18
2     TPS_2500_cp  gn_199_xpr2          165             18     TPS_2500_cp  gn_199_xpr1        766           54
3  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
4    TPS_27500_cp  gn_108_xpr1           40             70    TPS_27500_cp  gn_108_xpr2        671           10
5    TPS_37500_cp  gn_204_xpr1           96             10    TPS_37500_cp  gn_204_xpr2        904           48

In [432]: path_data_new                                                                                                           
Out[432]: 
   Traj  Start  End  Order
0     5    999    0     -1
1    16    999    0     -1
2    28    999   69     -1
3  1133    607    0     -1
4   662    268  978      1
5   940    999    0     -1




######################### PATH_1020 k=5 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 7
Cluster 7 sampled by Traj 437
Next Cluster 7
Cluster 7 sampled by Traj 410
Next Cluster 30
Cluster 30 sampled by Traj 448
Next Cluster 4
Cluster 4 sampled by Traj 442
Next Cluster 7
Cluster 7 sampled by Traj 443
Next Cluster 4
Cluster 4 sampled by Traj 446
Next Cluster 4
Cluster 4 sampled by Traj 461
Next Cluster 4
Cluster 4 sampled by Traj 429
Next Cluster 4
Cluster 4 sampled by Traj 445
Next Cluster 30
Cluster 30 sampled by Traj 393
Next Cluster 30
Cluster 30 sampled by Traj 396
Next Cluster 14
Cluster 14 sampled by Traj 383
Next Cluster 64
Cluster 64 sampled by Traj 377
Next Cluster 1
Cluster 1 sampled by Traj 136
Next Cluster 1
Cluster 1 sampled by Traj 134
Next Cluster 1
Cluster 1 sampled by Traj 140
Next Cluster 68
Cluster 68 sampled by Traj 132
Next Cluster 1
Cluster 1 sampled by Traj 137
Next Cluster 68
Cluster 68 sampled by Traj 139
Next Cluster 1
Cluster 1 sampled by Traj 138
Next Cluster 68
Cluster 68 sampled by Traj 141
Next Cluster 68
Cluster 68 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 867
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 58
Cluster 58 sampled by Traj 866
Next Cluster 10
Cluster 10 sampled by Traj 659
Next Cluster 72
Cluster 72 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 59
Cluster 59 sampled by Traj 870
Next Cluster 10
Cluster 10 sampled by Traj 941
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=5
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=5
path_new=np.array([[  17,    0],[  54, 1033],[  70,  930],[  10,  941]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 10, 48]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [478]: path_new                                                                                                                
Out[478]: 
array([[  17,    0],
       [  54, 1033],
       [  70,  930],
       [  10,  941]])

In [479]: path_start_end_new                                                                                                      
Out[479]: 
array([[17, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [480]: path_Cluster_new                                                                                                        
Out[480]: [17, 54, 70, 10, 48]

In [481]: path_table_new                                                                                                          
Out[481]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_5000_cp_2  gn_105_xpr1          549             54  TPS_5000_cp_2  gn_105_xpr2        141           70
2   TPS_37500_cp  gn_090_xpr1          185             70   TPS_37500_cp  gn_090_xpr2        815           10
3   TPS_37500_cp  gn_207_xpr1           29             10   TPS_37500_cp  gn_207_xpr1        651           48

In [482]: path_data_new                                                                                                           
Out[482]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1033    999  310     -1
2   930    999    0     -1
3   941    622    0     -1


######################### PATH_1020 k=6 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=6
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=6
path_new=np.array([[  17,    0],[  54, 1038],[  70,  662],[  72,  665],[  10,  940]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 72],[72, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 72, 10, 48]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [504]: path_new                                                                                                                
Out[504]: 
array([[  17,    0],
       [  54, 1038],
       [  70,  662],
       [  72,  665],
       [  10,  940]])

In [505]: path_start_end_new                                                                                                      
Out[505]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [506]: path_Cluster_new                                                                                                        
Out[506]: [17, 54, 70, 72, 10, 48]

In [507]: path_table_new                                                                                                          
Out[507]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_014_xpr1          849             54  TPS_7500_cp_2  gn_014_xpr2         33           70
2   TPS_27500_cp  gn_108_xpr1           40             70   TPS_27500_cp  gn_108_xpr1         25           72
3   TPS_27500_cp  gn_125_xpr2          190             72   TPS_27500_cp  gn_125_xpr1        671           10
4   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [508]: path_data_new                                                                                                           
Out[508]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1038      0  881      1
2   662    268  283      1
3   665    139  999      1
4   940    999    0     -1




######################### PATH_1020 k=7 #####################################



Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 18
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 74
Cluster 74 sampled by Traj 16
Next Cluster 18
Cluster 18 sampled by Traj 30
Next Cluster 40
Cluster 40 sampled by Traj 35
Next Cluster 56
Cluster 56 sampled by Traj 48
Next Cluster 21
Cluster 21 sampled by Traj 45
Next Cluster 56
Cluster 56 sampled by Traj 32
Next Cluster 40
Cluster 40 sampled by Traj 20
Next Cluster 40
Cluster 40 sampled by Traj 25
Next Cluster 18
Cluster 18 sampled by Traj 29
Next Cluster 40
Cluster 40 sampled by Traj 38
Next Cluster 40
Cluster 40 sampled by Traj 34
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 490
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 10
Cluster 10 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 870
Next Cluster 59
Cluster 59 sampled by Traj 866
Next Cluster 10
Cluster 10 sampled by Traj 822
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 661
Next Cluster 10
Cluster 10 sampled by Traj 941
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=7
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)




k=7
path_new=np.array([[  17,    5],[  74,   16],[  18,   28],[  54, 1039],[  70,  930],[  10,  941]])
path_start_end_new=np.array([[17, 74],[74, 18],[18, 54],[54, 70],[70, 10],[10, 48]])
path_Cluster_new=[17, 74, 18, 54, 70, 10, 48]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)




In [511]: path_new                                                                                                                
Out[511]: 
array([[  17,    5],
       [  74,   16],
       [  18,   28],
       [  54, 1039],
       [  70,  930],
       [  10,  941]])

In [512]: path_start_end_new                                                                                                      
Out[512]: 
array([[17, 74],
       [74, 18],
       [18, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [513]: path_Cluster_new                                                                                                        
Out[513]: [17, 74, 18, 54, 70, 10, 48]

In [514]: path_table_new                                                                                                          
Out[514]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_029_xpr2          264             17    TPS_2500_cp  gn_029_xpr1        736           74
1    TPS_2500_cp  gn_119_xpr2          100             74    TPS_2500_cp  gn_119_xpr1        900           18
2    TPS_2500_cp  gn_199_xpr2          165             18    TPS_2500_cp  gn_199_xpr1        766           54
3  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
4   TPS_37500_cp  gn_090_xpr1          185             70   TPS_37500_cp  gn_090_xpr2        815           10
5   TPS_37500_cp  gn_207_xpr1           29             10   TPS_37500_cp  gn_207_xpr1        651           48

In [515]: path_data_new                                                                                                           
Out[515]: 
   Traj  Start  End  Order
0     5    999    0     -1
1    16    999    0     -1
2    28    999   69     -1
3  1039    999    0     -1
4   930    999    0     -1
5   941    622    0     -1




######################### PATH_1020 k=8 #####################################


Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=8
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=8
path_new=np.array([[ 17,   0],[ 54, 208],[ 70, 654],[ 72, 664],[ 10, 941]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 72],[72, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 72, 10, 48]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [539]: path_new                                                                                                                
Out[539]: 
array([[ 17,   0],
       [ 54, 208],
       [ 70, 654],
       [ 72, 664],
       [ 10, 941]])

In [540]: path_start_end_new                                                                                                      
Out[540]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [541]: path_Cluster_new                                                                                                        
Out[541]: [17, 54, 70, 72, 10, 48]

In [542]: path_table_new                                                                                                          
Out[542]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1     TPS_12500  gn_011_xpr1          726             54     TPS_12500  gn_011_xpr2        217           70
2  TPS_27500_cp  gn_082_xpr2          295             70  TPS_27500_cp  gn_082_xpr1        705           72
3  TPS_27500_cp  gn_121_xpr1          408             72  TPS_27500_cp  gn_121_xpr2        284           10
4  TPS_37500_cp  gn_207_xpr1           29             10  TPS_37500_cp  gn_207_xpr1        651           48

In [543]: path_data_new                                                                                                           
Out[543]: 
   Traj  Start  End  Order
0     0      0  945      1
1   208     57  999      1
2   654      0  999      1
3   664    308  999      1
4   941    622    0     -1





######################### PATH_1020 k=9 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 822
Next Cluster 10
Cluster 10 sampled by Traj 867
Next Cluster 10
Cluster 10 sampled by Traj 660
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 10
Cluster 10 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 866
Next Cluster 10
Cluster 10 sampled by Traj 691
Next Cluster 10
Cluster 10 sampled by Traj 940
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=9
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=9
path_new=np.array([[  17,    0],[  54, 1039],[  70,  662],[  10,  940]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 10, 48]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [587]: path_new                                                                                                                
Out[587]: 
array([[  17,    0],
       [  54, 1039],
       [  70,  662],
       [  10,  940]])

In [588]: path_start_end_new                                                                                                      
Out[588]: 
array([[17, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [589]: path_Cluster_new                                                                                                        
Out[589]: [17, 54, 70, 10, 48]

In [590]: path_table_new                                                                                                          
Out[590]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
2   TPS_27500_cp  gn_108_xpr1           40             70   TPS_27500_cp  gn_108_xpr2        671           10
3   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [591]: path_data_new                                                                                                           
Out[591]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1039    999    0     -1
2   662    268  978      1
3   940    999    0     -1




######################### PATH_1020 k=10 #####################################

Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 59
Cluster 59 sampled by Traj 868
Next Cluster 59
Cluster 59 sampled by Traj 873
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=10
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.png".format(nclusters,k),dpi=1200)



In [596]: path_new                                                                                                                
Out[596]: 
array([[ 17,   0],
       [ 70, 930],
       [ 10, 940]])

In [597]: path_start_end_new                                                                                                      
Out[597]: 
array([[17, 70],
       [70, 10],
       [10, 48]])

In [598]: path_Cluster_new                                                                                                        
Out[598]: [17, 70, 10, 48]

In [599]: path_table_new                                                                                                          
Out[599]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_37500_cp  gn_090_xpr1          185             70  TPS_37500_cp  gn_090_xpr2        815           10
2  TPS_37500_cp  gn_204_xpr1           96             10  TPS_37500_cp  gn_204_xpr2        904           48

In [600]: path_data_new                                                                                                           
Out[600]: 
   Traj  Start  End  Order
0     0      0  501      1
1   930    999    0     -1
2   940    999    0     -1



######################### PATH_1020 k=11 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 16
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 16
Cluster 16 sampled by Traj 1142
Next Cluster 36
Cluster 36 sampled by Traj 1149
Next Cluster 16
Cluster 16 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 715
Next Cluster 25
Cluster 25 sampled by Traj 740
Next Cluster 12
Cluster 12 sampled by Traj 738
Next Cluster 12
Cluster 12 sampled by Traj 737
Next Cluster 12
Cluster 12 sampled by Traj 739
Next Cluster 12
Cluster 12 sampled by Traj 736
Next Cluster 25
Cluster 25 sampled by Traj 714
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 70
Cluster 70 sampled by Traj 272
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 1171
Next Cluster 27
Cluster 27 sampled by Traj 1182
Next Cluster 42
Cluster 42 sampled by Traj 1195
Next Cluster 29
^[[ACluster 29 sampled by Traj 1201
Next Cluster 60
Cluster 60 sampled by Traj 1204
Next Cluster 60
Cluster 60 sampled by Traj 1210
Next Cluster 61
Cluster 61 sampled by Traj 1213
Next Cluster 61
Cluster 61 sampled by Traj 1212
Next Cluster 60
Cluster 60 sampled by Traj 1203
Next Cluster 61
Cluster 61 sampled by Traj 1206
Next Cluster 60
Cluster 60 sampled by Traj 1200
Next Cluster 29
Cluster 29 sampled by Traj 1194
Next Cluster 42
Cluster 42 sampled by Traj 1170
Next Cluster 27
Cluster 27 sampled by Traj 1179
Next Cluster 27
Cluster 27 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 822
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 59
Cluster 59 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 941
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=11
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=11
path_new=np.array([[ 17,   0],[ 70, 654],[ 72, 660],[ 10, 871],[ 59, 869],[ 10, 941]])
path_start_end_new=np.array([[17, 70],[70, 72],[72, 10],[10, 59],[59, 10],[10, 48]])
path_Cluster_new=[17, 70, 72, 10, 59, 10, 48]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [651]: path_new                                                                                                                
Out[651]: 
array([[ 17,   0],
       [ 70, 654],
       [ 72, 660],
       [ 10, 871],
       [ 59, 869],
       [ 10, 941]])

In [652]: path_start_end_new                                                                                                      
Out[652]: 
array([[17, 70],
       [70, 72],
       [72, 10],
       [10, 59],
       [59, 10],
       [10, 48]])

In [653]: path_Cluster_new                                                                                                        
Out[653]: [17, 70, 72, 10, 59, 10, 48]

In [654]: path_table_new                                                                                                          
Out[654]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_27500_cp  gn_082_xpr2          295             70  TPS_27500_cp  gn_082_xpr1        705           72
2  TPS_27500_cp  gn_103_xpr1          141             72  TPS_27500_cp  gn_103_xpr2        295           10
3  TPS_35000_cp  gn_192_xpr1          157             10  TPS_35000_cp  gn_192_xpr2        639           59
4  TPS_35000_cp  gn_188_xpr1          409             59  TPS_35000_cp  gn_188_xpr2        499           10
5  TPS_37500_cp  gn_207_xpr1           29             10  TPS_37500_cp  gn_207_xpr1        651           48

In [655]: path_data_new                                                                                                           
Out[655]: 
   Traj  Start  End  Order
0     0      0  501      1
1   654      0  999      1
2   660    392  827      1
3   871    795    0     -1
4   869     92  999      1
5   941    622    0     -1


######################### PATH_1020 k=12 #####################################


Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 138
Next Cluster 68
Cluster 68 sampled by Traj 139
Next Cluster 1
Cluster 1 sampled by Traj 137
Next Cluster 1
Cluster 1 sampled by Traj 140
Next Cluster 1
Cluster 1 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 51
Cluster 51 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 940
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=12
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=12
path_new=np.array([[ 17,   0],[ 54, 118],[  1, 117],[ 70, 930],[ 10, 940]])
path_start_end_new=np.array([[17, 54],[54,  1],[ 1, 70],[70, 10],[10, 48]])
path_Cluster_new=[17, 54, 1, 70, 10, 48]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [687]: path_new                                                                                                                
Out[687]: 
array([[ 17,   0],
       [ 54, 118],
       [  1, 117],
       [ 70, 930],
       [ 10, 940]])

In [688]: path_start_end_new                                                                                                      
Out[688]: 
array([[17, 54],
       [54,  1],
       [ 1, 70],
       [70, 10],
       [10, 48]])

In [689]: path_Cluster_new                                                                                                        
Out[689]: [17, 54, 1, 70, 10, 48]

In [690]: path_table_new                                                                                                          
Out[690]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1      TPS_7500  gn_109_xpr2           29             54      TPS_7500  gn_109_xpr1        692            1
2      TPS_7500  gn_067_xpr1          637              1      TPS_7500  gn_067_xpr1          4           70
3  TPS_37500_cp  gn_090_xpr1          185             70  TPS_37500_cp  gn_090_xpr2        815           10
4  TPS_37500_cp  gn_204_xpr1           96             10  TPS_37500_cp  gn_204_xpr2        904           48

In [691]: path_data_new                                                                                                           
Out[691]: 
   Traj  Start  End  Order
0     0      0  945      1
1   118    279  999      1
2   117     44  677      1
3   930    999    0     -1
4   940    999    0     -1




######################### PATH_1020 k=13 #####################################


Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 43
Cluster 43 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 870
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 59
Cluster 59 sampled by Traj 866
Next Cluster 10
Cluster 10 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 685
Next Cluster 10
Cluster 10 sampled by Traj 691
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=13
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=13
path_new=np.array([[ 17,   0],[ 54, 170],[  5, 159],[ 70, 808],[ 43, 812],[ 10, 941]])
path_start_end_new=np.array([[17, 54],[54,  5],[ 5, 70],[70, 43],[43, 10],[10, 48]])
path_Cluster_new=[17, 54, 5, 70, 43, 10, 48]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1025.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [709]: path_new                                                                                                                
Out[709]: 
array([[ 17,   0],
       [ 54, 170],
       [  5, 159],
       [ 70, 808],
       [ 43, 812],
       [ 10, 941]])

In [710]: path_start_end_new                                                                                                      
Out[710]: 
array([[17, 54],
       [54,  5],
       [ 5, 70],
       [70, 43],
       [43, 10],
       [10, 48]])

In [711]: path_Cluster_new                                                                                                        
Out[711]: [17, 54, 5, 70, 43, 10, 48]

In [712]: path_table_new                                                                                                          
Out[712]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1     TPS_10000  gn_273_xpr2          265             54     TPS_10000  gn_273_xpr1        735            5
2     TPS_10000  gn_176_xpr1          501              5     TPS_10000  gn_176_xpr2          2           70
3  TPS_35000_cp  gn_049_xpr2          301             70  TPS_35000_cp  gn_049_xpr1        699           43
4  TPS_35000_cp  gn_072_xpr1          394             43  TPS_35000_cp  gn_072_xpr2        606           10
5  TPS_37500_cp  gn_207_xpr1           29             10  TPS_37500_cp  gn_207_xpr1        651           48

In [713]: path_data_new                                                                                                           
Out[713]: 
   Traj  Start  End  Order
0     0      0  945      1
1   170      0  999      1
2   159      0  502      1
3   808    999    0     -1
4   812    999    0     -1
5   941    622    0     -1



######################### PATH_1020 k=14 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 870
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=14
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=14
path_new=np.array([[  17,    0],[  54, 1044],[  70,  651],[  72,  664],[  10,  941]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 72],[72, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 72, 10, 48]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [815]: path_new                                                                                                                
Out[815]: 
array([[  17,    0],
       [  54, 1044],
       [  70,  651],
       [  72,  664],
       [  10,  941]])

In [816]: path_start_end_new                                                                                                      
Out[816]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [817]: path_Cluster_new                                                                                                        
Out[817]: [17, 54, 70, 72, 10, 48]

In [818]: path_table_new                                                                                                          
Out[818]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_156_xpr1          744             54  TPS_7500_cp_2  gn_156_xpr2        230           70
2   TPS_27500_cp  gn_076_xpr1          635             70   TPS_27500_cp  gn_076_xpr2        354           72
3   TPS_27500_cp  gn_121_xpr1          408             72   TPS_27500_cp  gn_121_xpr2        284           10
4   TPS_37500_cp  gn_207_xpr1           29             10   TPS_37500_cp  gn_207_xpr1        651           48

In [819]: path_data_new                                                                                                           
Out[819]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1044    999   26     -1
2   651     11  999      1
3   664    308  999      1
4   941    622    0     -1



######################### PATH_1020 k=15 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 175
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 69
Cluster 69 sampled by Traj 189
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=15
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=15
path_new=np.array([[  17,    0],[  54, 1040],[  70,  651],[  72,  665],[  10,  941]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 72],[72, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 72, 10, 48]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [891]: path_new                                                                                                                
Out[891]: 
array([[  17,    0],
       [  54, 1040],
       [  70,  651],
       [  72,  665],
       [  10,  941]])

In [892]: path_start_end_new                                                                                                      
Out[892]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [893]: path_Cluster_new                                                                                                        
Out[893]: [17, 54, 70, 72, 10, 48]

In [894]: path_table_new                                                                                                          
Out[894]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_117_xpr2          900             54  TPS_7500_cp_2  gn_117_xpr1         93           70
2   TPS_27500_cp  gn_076_xpr1          635             70   TPS_27500_cp  gn_076_xpr2        354           72
3   TPS_27500_cp  gn_125_xpr2          190             72   TPS_27500_cp  gn_125_xpr1        671           10
4   TPS_37500_cp  gn_207_xpr1           29             10   TPS_37500_cp  gn_207_xpr1        651           48

In [895]: path_data_new                                                                                                           
Out[895]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1040      0  992      1
2   651     11  999      1
3   665    139  999      1
4   941    622    0     -1




######################### PATH_1020 k=16 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 1063
Next Cluster 39
Cluster 39 sampled by Traj 1072
Next Cluster 39
Cluster 39 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 685
Next Cluster 32
Cluster 32 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 659
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 941
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=16
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)




k=16
path_new=np.array([[  17,    0],[  54,   76],[   3, 1063],[  39, 1061],[  70,  662],[  72,  660],[  10,  941]])
path_start_end_new=np.array([[17, 54],[54,  3],[ 3, 39],[39, 70],[70, 72],[72, 10],[10, 48]])
path_Cluster_new=[17, 54, 3, 39, 70, 72, 10, 48]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [10]: path_new                                                                                                         
Out[10]: 
array([[  17,    0],
       [  54,   76],
       [   3, 1063],
       [  39, 1061],
       [  70,  662],
       [  72,  660],
       [  10,  941]])

In [11]: path_start_end_new                                                                                               
Out[11]: 
array([[17, 54],
       [54,  3],
       [ 3, 39],
       [39, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [12]: path_Cluster_new                                                                                                 
Out[12]: [17, 54, 3, 39, 70, 72, 10, 48]

In [13]: path_table_new                                                                                                   
Out[13]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1     TPS_5000_cp  gn_028_xpr2          258             54     TPS_5000_cp  gn_028_xpr1        742            3
2  TPS_10000_cp_2  gn_207_xpr2          808              3  TPS_10000_cp_2  gn_207_xpr1        189           39
3  TPS_10000_cp_2  gn_176_xpr1          949             39  TPS_10000_cp_2  gn_176_xpr1        171           70
4    TPS_27500_cp  gn_108_xpr1           40             70    TPS_27500_cp  gn_108_xpr1         25           72
5    TPS_27500_cp  gn_103_xpr1          141             72    TPS_27500_cp  gn_103_xpr2        295           10
6    TPS_37500_cp  gn_207_xpr1           29             10    TPS_37500_cp  gn_207_xpr1        651           48

In [14]: path_data_new                                                                                                    
Out[14]: 
   Traj  Start  End  Order
0     0      0  945      1
1    76    999    0     -1
2  1063      3  999      1
3  1061      0  778      1
4   662    268  283      1
5   660    392  827      1
6   941    622    0     -1





######################### PATH_1020 k=17 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 714
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 659
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=17
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=17
path_new=np.array([[ 17,   0],[ 70, 930],[ 10, 940]])
path_start_end_new=np.array([[17, 70],[70, 10],[10, 48]])
path_Cluster_new=[17, 70, 10, 48]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [26]: path_new                                                                                                         
Out[26]: 
array([[ 17,   0],
       [ 70, 930],
       [ 10, 940]])

In [27]: path_start_end_new                                                                                               
Out[27]: 
array([[17, 70],
       [70, 10],
       [10, 48]])

In [28]: path_Cluster_new                                                                                                 
Out[28]: [17, 70, 10, 48]

In [29]: path_table_new                                                                                                   
Out[29]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_37500_cp  gn_090_xpr1          185             70  TPS_37500_cp  gn_090_xpr2        815           10
2  TPS_37500_cp  gn_204_xpr1           96             10  TPS_37500_cp  gn_204_xpr2        904           48

In [30]: path_data_new                                                                                                    
Out[30]: 
   Traj  Start  End  Order
0     0      0  501      1
1   930    999    0     -1
2   940    999    0     -1





######################### PATH_1020 k=18 #####################################



Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 189
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=18
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=18
path_new=np.array([[ 17,   0],[ 54, 362],[ 71, 361],[ 70, 651],[ 72, 665],[ 10, 940]])
path_start_end_new=np.array([[17, 54],[54, 71],[71, 70],[70, 72],[72, 10],[10, 48]])
path_Cluster_new=[17, 54, 71, 70, 72, 10, 48]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)



In [41]: path_new                                                                                                         
Out[41]: 
array([[ 17,   0],
       [ 54, 362],
       [ 71, 361],
       [ 70, 651],
       [ 72, 665],
       [ 10, 940]])

In [42]: path_start_end_new                                                                                               
Out[42]: 
array([[17, 54],
       [54, 71],
       [71, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [43]: path_Cluster_new                                                                                                 
Out[43]: [17, 54, 71, 70, 72, 10, 48]

In [44]: path_table_new                                                                                                   
Out[44]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_20000_cp  gn_030_xpr1          842             54  TPS_20000_cp  gn_030_xpr2        144           71
2  TPS_20000_cp  gn_024_xpr2          395             71  TPS_20000_cp  gn_024_xpr1        605           70
3  TPS_27500_cp  gn_076_xpr1          635             70  TPS_27500_cp  gn_076_xpr2        354           72
4  TPS_27500_cp  gn_125_xpr2          190             72  TPS_27500_cp  gn_125_xpr1        671           10
5  TPS_37500_cp  gn_204_xpr1           96             10  TPS_37500_cp  gn_204_xpr2        904           48

In [45]: path_data_new                                                                                                    
Out[45]: 
   Traj  Start  End  Order
0     0      0  945      1
1   362      0  985      1
2   361    999    0     -1
3   651     11  999      1
4   665    139  999      1
5   940    999    0     -1





######################### PATH_1020 k=19 #####################################



Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 10
Cluster 10 sampled by Traj 868
Next Cluster 59
Cluster 59 sampled by Traj 883
Next Cluster 59
Cluster 59 sampled by Traj 873
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=19
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=19
path_new=np.array([[  17,    0],[  54, 1040],[  70,  662],[  72,  661],[  10,  940]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 72],[72, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 72, 10, 48]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1020.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1020.01222024.png".format(nclusters,k),dpi=1200)




In [54]: path_new                                                                                                         
Out[54]: 
array([[  17,    0],
       [  54, 1040],
       [  70,  662],
       [  72,  661],
       [  10,  940]])

In [55]: path_start_end_new                                                                                               
Out[55]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [56]: path_Cluster_new                                                                                                 
Out[56]: [17, 54, 70, 72, 10, 48]

In [57]: path_table_new                                                                                                   
Out[57]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_117_xpr2          900             54  TPS_7500_cp_2  gn_117_xpr1         93           70
2   TPS_27500_cp  gn_108_xpr1           40             70   TPS_27500_cp  gn_108_xpr1         25           72
3   TPS_27500_cp  gn_105_xpr1           96             72   TPS_27500_cp  gn_105_xpr2        757           10
4   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [58]: path_data_new                                                                                                    
Out[58]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1040      0  992      1
2   662    268  283      1
3   661    852    0     -1
4   940    999    0     -1





######################### PATH_1022 k=0 #####################################



Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 489
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=0
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=0
path_new=np.array([[  17,    0],[  54, 1043],[  70,  489]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 46]])
path_Cluster_new=[17, 54, 70, 46]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)



In [72]: path_new                                                                                                         
Out[72]: 
array([[  17,    0],
       [  54, 1043],
       [  70,  489]])

In [73]: path_start_end_new                                                                                               
Out[73]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [74]: path_Cluster_new                                                                                                 
Out[74]: [17, 54, 70, 46]

In [75]: path_table_new                                                                                                   
Out[75]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_128_xpr2          163             54  TPS_7500_cp_2  gn_128_xpr1        823           70
2   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46

In [76]: path_data_new                                                                                                    
Out[76]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1043    999   14     -1
2   489    999  173     -1




######################### PATH_1022 k=1 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 714
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 175
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 489
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=1
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)




k=1
path_new=np.array([[ 17,   0],[ 70, 489]])
path_start_end_new=np.array([[17, 70],[70, 46]])
path_Cluster_new=[17, 70, 46]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)


In [84]: path_new                                                                                                         
Out[84]: 
array([[ 17,   0],
       [ 70, 489]])

In [85]: path_start_end_new                                                                                               
Out[85]: 
array([[17, 70],
       [70, 46]])

In [86]: path_Cluster_new                                                                                                 
Out[86]: [17, 70, 46]

In [87]: path_table_new                                                                                                   
Out[87]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_22500_cp  gn_029_xpr2          208             70  TPS_22500_cp  gn_029_xpr1        619           46

In [88]: path_data_new                                                                                                    
Out[88]: 
   Traj  Start  End  Order
0     0      0  501      1
1   489    999  173     -1





######################### PATH_1022 k=2 #####################################



Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 58
Cluster 58 sampled by Traj 866
Next Cluster 59
Cluster 59 sampled by Traj 871
Next Cluster 10
Cluster 10 sampled by Traj 868
Next Cluster 59
Cluster 59 sampled by Traj 867
Next Cluster 10
Cluster 10 sampled by Traj 941
Next Cluster 10
Cluster 10 sampled by Traj 489
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=2
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=2
path_new=np.array([[  17,    0],[  54, 1038],[  70,  930],[  10,  489]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 10],[10, 46]])
path_Cluster_new=[17, 54, 70, 10, 46]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)



In [93]: path_new                                                                                                         
Out[93]: 
array([[  17,    0],
       [  54, 1038],
       [  70,  930],
       [  10,  489]])

In [94]: path_start_end_new                                                                                               
Out[94]: 
array([[17, 54],
       [54, 70],
       [70, 10],
       [10, 46]])

In [95]: path_Cluster_new                                                                                                 
Out[95]: [17, 54, 70, 10, 46]

In [96]: path_table_new                                                                                                   
Out[96]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_014_xpr1          849             54  TPS_7500_cp_2  gn_014_xpr2         33           70
2   TPS_37500_cp  gn_090_xpr1          185             70   TPS_37500_cp  gn_090_xpr2        815           10
3   TPS_22500_cp  gn_029_xpr1          792             10   TPS_22500_cp  gn_029_xpr1         85           46

In [97]: path_data_new                                                                                                    
Out[97]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1038      0  881      1
2   930    999    0     -1
3   489      0  707      1





######################### PATH_1022 k=3 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=3
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=3
path_new=np.array([[  17,    0],[  54, 1056],[  70,  490]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 46]])
path_Cluster_new=[17, 54, 70, 46]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)



In [101]: path_new                                                                                                        
Out[101]: 
array([[  17,    0],
       [  54, 1056],
       [  70,  490]])

In [102]: path_start_end_new                                                                                              
Out[102]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [103]: path_Cluster_new                                                                                                
Out[103]: [17, 54, 70, 46]

In [104]: path_table_new                                                                                                  
Out[104]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_10000_cp_2  gn_058_xpr1          323             54  TPS_10000_cp_2  gn_058_xpr2        327           70
2    TPS_22500_cp  gn_030_xpr1           41             70    TPS_22500_cp  gn_030_xpr1        684           46

In [105]: path_data_new                                                                                                   
Out[105]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1056    350  999      1
2   490    356  999      1





######################### PATH_1022 k=4 #####################################


Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 138
Next Cluster 1
Cluster 1 sampled by Traj 141
Next Cluster 1
Cluster 1 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 189
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 714
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 490
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=4
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=4
path_new=np.array([[ 17,   0],[ 54, 208],[ 70, 490]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 46]])
path_Cluster_new=[17, 54, 70, 46]

path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)



In [130]: path_new                                                                                                        
Out[130]: 
array([[ 17,   0],
       [ 54, 208],
       [ 70, 490]])

In [131]: path_start_end_new                                                                                              
Out[131]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [132]: path_Cluster_new                                                                                                
Out[132]: [17, 54, 70, 46]

In [133]: path_table_new                                                                                                  
Out[133]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1     TPS_12500  gn_011_xpr1          726             54     TPS_12500  gn_011_xpr2        217           70
2  TPS_22500_cp  gn_030_xpr1           41             70  TPS_22500_cp  gn_030_xpr1        684           46

In [134]: path_data_new                                                                                                   
Out[134]: 
   Traj  Start  End  Order
0     0      0  945      1
1   208     57  999      1
2   490    356  999      1





######################### PATH_1022 k=5 #####################################



Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 20
Cluster 20 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1121
Next Cluster 38
Cluster 38 sampled by Traj 1111
Next Cluster 33
Cluster 33 sampled by Traj 1112
Next Cluster 33
Cluster 33 sampled by Traj 1104
Next Cluster 38
Cluster 38 sampled by Traj 1113
Next Cluster 33
Cluster 33 sampled by Traj 1114
Next Cluster 38
Cluster 38 sampled by Traj 1095
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 489
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=5
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)




k=5
path_new=np.array([[  17,    0],[  54,  979],[  20,  171],[   5,  190],[  20,  191],[   5,  189],[  69,  184],[  20,  188],[  69,  187],[   5,  158],[  34, 1084],[  70,  489]])
path_start_end_new=np.array([[17, 54],[54, 20],[20,  5],[ 5, 20],[20,  5],[ 5, 69],[69, 20],[20, 69],[69,  5],[ 5, 34],[34, 70],[70, 46]])
path_Cluster_new=[17, 54, 20, 5, 20, 5, 69, 20, 69, 5, 34, 70, 46]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)



In [142]: path_new                                                                                                        
Out[142]: 
array([[  17,    0],
       [  54,  979],
       [  20,  171],
       [   5,  190],
       [  20,  191],
       [   5,  189],
       [  69,  184],
       [  20,  188],
       [  69,  187],
       [   5,  158],
       [  34, 1084],
       [  70,  489]])

In [143]: path_start_end_new                                                                                              
Out[143]: 
array([[17, 54],
       [54, 20],
       [20,  5],
       [ 5, 20],
       [20,  5],
       [ 5, 69],
       [69, 20],
       [20, 69],
       [69,  5],
       [ 5, 34],
       [34, 70],
       [70, 46]])

In [144]: path_Cluster_new                                                                                                
Out[144]: [17, 54, 20, 5, 20, 5, 69, 20, 69, 5, 34, 70, 46]

In [145]: path_table_new                                                                                                  
Out[145]: 
      Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0      TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1    TPS_2500_cp_2  gn_004_xpr2           69             54   TPS_2500_cp_2  gn_004_xpr1        344           20
2        TPS_10000  gn_283_xpr2          469             20       TPS_10000  gn_283_xpr1         18            5
3        TPS_10000  gn_438_xpr2          281              5       TPS_10000  gn_438_xpr1        336           20
4        TPS_10000  gn_448_xpr1          501             20       TPS_10000  gn_448_xpr1         19            5
5        TPS_10000  gn_418_xpr2          347              5       TPS_10000  gn_418_xpr2        499           69
6        TPS_10000  gn_390_xpr2          436             69       TPS_10000  gn_390_xpr1        284           20
7        TPS_10000  gn_416_xpr1          750             20       TPS_10000  gn_416_xpr2         93           69
8        TPS_10000  gn_409_xpr1          181             69       TPS_10000  gn_409_xpr2        544            5
9        TPS_10000  gn_158_xpr2           85              5       TPS_10000  gn_158_xpr1        754           34
10  TPS_12500_cp_2  gn_087_xpr2          506             34  TPS_12500_cp_2  gn_087_xpr1        357           70
11    TPS_22500_cp  gn_029_xpr2          208             70    TPS_22500_cp  gn_029_xpr1        619           46

In [146]: path_data_new                                                                                                   
Out[146]: 
    Traj  Start  End  Order
0      0      0  945      1
1    979      0  412      1
2    171      1  487      1
3    190    830  214     -1
4    191    999  517     -1
5    189    152    0     -1
6    184      0  719      1
7    188      0  842      1
8    187    833  109     -1
9    158    999  161     -1
10  1084      0  862      1
11   489    999  173     -1




######################### PATH_1022 k=6 #####################################



Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 489
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=6
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=6
path_new=np.array([[  17,    0],[  54, 1033],[  70,  489]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 46]])
path_Cluster_new=[17, 54, 70, 46]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)


In [152]: path_new                                                                                                        
Out[152]: 
array([[  17,    0],
       [  54, 1033],
       [  70,  489]])

In [153]: path_start_end_new                                                                                              
Out[153]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [154]: path_Cluster_new                                                                                                
Out[154]: [17, 54, 70, 46]

In [155]: path_table_new                                                                                                  
Out[155]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_5000_cp_2  gn_105_xpr1          549             54  TPS_5000_cp_2  gn_105_xpr2        141           70
2   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46

In [156]: path_data_new                                                                                                   
Out[156]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1033    999  310     -1
2   489    999  173     -1





######################### PATH_1022 k=7 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 27
Cluster 27 sampled by Traj 1182
Next Cluster 42
Cluster 42 sampled by Traj 1171
Next Cluster 27
Cluster 27 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 1178
Next Cluster 42
Cluster 42 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=7
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=7
path_new=np.array([[ 17,   0],[ 54, 367],[ 71, 362],[ 70, 489]])
path_start_end_new=np.array([[17, 54],[54, 71],[71, 70],[70, 46]])
path_Cluster_new=[17, 54, 71, 70, 46]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)



In [160]: path_new                                                                                                        
Out[160]: 
array([[ 17,   0],
       [ 54, 367],
       [ 71, 362],
       [ 70, 489]])

In [161]: path_start_end_new                                                                                              
Out[161]: 
array([[17, 54],
       [54, 71],
       [71, 70],
       [70, 46]])

In [162]: path_Cluster_new                                                                                                
Out[162]: [17, 54, 71, 70, 46]

In [163]: path_table_new                                                                                                  
Out[163]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_20000_cp  gn_073_xpr1          888             54  TPS_20000_cp  gn_073_xpr2         62           71
2  TPS_20000_cp  gn_030_xpr2          144             71  TPS_20000_cp  gn_030_xpr1        841           70
3  TPS_22500_cp  gn_029_xpr2          208             70  TPS_22500_cp  gn_029_xpr1        619           46

In [164]: path_data_new                                                                                                   
Out[164]: 
   Traj  Start  End  Order
0     0      0  945      1
1   367     50  999      1
2   362    985    1     -1
3   489    999  173     -1



######################### PATH_1022 k=8 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 1171
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 490
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=8
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)




k=8
path_new=np.array([[ 17,   0],[ 54, 362],[ 70, 490]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 46]])
path_Cluster_new=[17, 54, 70, 46]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)



In [177]: path_new                                                                                                        
Out[177]: 
array([[ 17,   0],
       [ 54, 362],
       [ 70, 490]])

In [178]: path_start_end_new                                                                                              
Out[178]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [179]: path_Cluster_new                                                                                                
Out[179]: [17, 54, 70, 46]

In [180]: path_table_new                                                                                                  
Out[180]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_20000_cp  gn_030_xpr1          842             54  TPS_20000_cp  gn_030_xpr1        807           70
2  TPS_22500_cp  gn_030_xpr1           41             70  TPS_22500_cp  gn_030_xpr1        684           46

In [181]: path_data_new                                                                                                   
Out[181]: 
   Traj  Start  End  Order
0     0      0  945      1
1   362      0   35      1
2   490    356  999      1




######################### PATH_1022 k=9 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=9
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)




k=9
path_new=np.array([[ 17,   0],[ 54, 362],[ 71, 363],[ 70, 489]])
path_start_end_new=np.array([[17, 54],[54, 71],[71, 70],[70, 46]])
path_Cluster_new=[17, 54, 71, 70, 46]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)



In [209]: path_new                                                                                                        
Out[209]: 
array([[ 17,   0],
       [ 54, 362],
       [ 71, 363],
       [ 70, 489]])

In [210]: path_start_end_new                                                                                              
Out[210]: 
array([[17, 54],
       [54, 71],
       [71, 70],
       [70, 46]])

In [211]: path_Cluster_new                                                                                                
Out[211]: [17, 54, 71, 70, 46]

In [212]: path_table_new                                                                                                  
Out[212]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_20000_cp  gn_030_xpr1          842             54  TPS_20000_cp  gn_030_xpr2        144           71
2  TPS_20000_cp  gn_033_xpr1          808             71  TPS_20000_cp  gn_033_xpr2        182           70
3  TPS_22500_cp  gn_029_xpr2          208             70  TPS_22500_cp  gn_029_xpr1        619           46

In [213]: path_data_new                                                                                                   
Out[213]: 
   Traj  Start  End  Order
0     0      0  945      1
1   362      0  985      1
2   363    999   10     -1
3   489    999  173     -1





######################### PATH_1022 k=10 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 490
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=10
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=10
path_new=np.array([[  17,    0],[  54, 1040],[  70,  490]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 46]])
path_Cluster_new=[17, 54, 70, 46]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)


In [220]: path_new                                                                                                        
Out[220]: 
array([[  17,    0],
       [  54, 1040],
       [  70,  490]])

In [221]: path_start_end_new                                                                                              
Out[221]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [222]: path_Cluster_new                                                                                                
pOut[222]: [17, 54, 70, 46]

In [223]: path_table_new                                                                                                  
Out[223]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_117_xpr2          900             54  TPS_7500_cp_2  gn_117_xpr1         93           70
2   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [224]: path_data_new                                                                                                   
Out[224]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1040      0  992      1
2   490    356  999      1




######################### PATH_1022 k=11 #####################################


Cluster 17 sampled by Traj 6
Next Cluster 74
Cluster 74 sampled by Traj 18
Next Cluster 18
Cluster 18 sampled by Traj 16
Next Cluster 74
Cluster 74 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 490
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=11
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=11
path_new=np.array([[ 17,   0],[ 70, 490]])
path_start_end_new=np.array([[17, 70],[70, 46]])
path_Cluster_new=[17, 70, 46]



path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)



In [240]: path_new                                                                                                        
Out[240]: 
array([[ 17,   0],
       [ 70, 490]])

In [241]: path_start_end_new                                                                                              
Out[241]: 
array([[17, 70],
       [70, 46]])

In [242]: path_Cluster_new                                                                                                
Out[242]: [17, 70, 46]

In [243]: path_table_new                                                                                                  
Out[243]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_22500_cp  gn_030_xpr1           41             70  TPS_22500_cp  gn_030_xpr1        684           46

In [244]: path_data_new                                                                                                   
Out[244]: 
   Traj  Start  End  Order
0     0      0  501      1
1   490    356  999      1





######################### PATH_1022 k=12 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=12
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=12
path_new=np.array([[  17,    0],[  54, 1056],[  70,  489]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 46]])
path_Cluster_new=[17, 54, 70, 46]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)


In [250]: path_new                                                                                                        
Out[250]: 
array([[  17,    0],
       [  54, 1056],
       [  70,  489]])

In [251]: path_start_end_new                                                                                              
Out[251]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [252]: path_Cluster_new                                                                                                
Out[252]: [17, 54, 70, 46]

In [253]: path_table_new                                                                                                  
Out[253]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_10000_cp_2  gn_058_xpr1          323             54  TPS_10000_cp_2  gn_058_xpr2        327           70
2    TPS_22500_cp  gn_029_xpr2          208             70    TPS_22500_cp  gn_029_xpr1        619           46

In [254]: path_data_new                                                                                                   
Out[254]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1056    350  999      1
2   489    999  173     -1





######################### PATH_1022 k=13 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1095
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 659
Next Cluster 72
Cluster 72 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 361
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 27
Cluster 27 sampled by Traj 1178
Next Cluster 42
Cluster 42 sampled by Traj 1194
Next Cluster 42
Cluster 42 sampled by Traj 1179
Next Cluster 42
Cluster 42 sampled by Traj 1195
Next Cluster 42
Cluster 42 sampled by Traj 1182
Next Cluster 42
Cluster 42 sampled by Traj 1170
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 55
Cluster 55 sampled by Traj 226
Next Cluster 55
Cluster 55 sampled by Traj 240
Next Cluster 55
Cluster 55 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 189
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 490
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=13
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=13
path_new=np.array([[ 17,   0],[ 70, 490]])
path_start_end_new=np.array([[17, 70],[70, 46]])
path_Cluster_new=[17, 70, 46]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)



In [260]: path_new                                                                                                        
Out[260]: 
array([[ 17,   0],
       [ 70, 490]])

In [261]: path_start_end_new                                                                                              
Out[261]: 
array([[17, 70],
       [70, 46]])

In [262]: path_Cluster_new                                                                                                
Out[262]: [17, 70, 46]

In [263]: path_table_new                                                                                                  
Out[263]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_22500_cp  gn_030_xpr1           41             70  TPS_22500_cp  gn_030_xpr1        684           46

In [264]: path_data_new                                                                                                   
Out[264]: 
   Traj  Start  End  Order
0     0      0  501      1
1   490    356  999      1




######################### PATH_1022 k=14 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 18
Next Cluster 18
Cluster 18 sampled by Traj 30
Next Cluster 18
Cluster 18 sampled by Traj 25
Next Cluster 18
Cluster 18 sampled by Traj 29
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=14
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)



k=14
path_new=np.array([[  17,    5],[  74,   18],[  18,   28],[  54, 1055],[  70,  489]])
path_start_end_new=np.array([[17, 74],[74, 18],[18, 54],[54, 70],[70, 46]])
path_Cluster_new=[17, 74, 18, 54, 70, 46]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1022.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.01222024.png".format(nclusters,k),dpi=1200)



In [273]: path_new                                                                                                        
Out[273]: 
array([[  17,    5],
       [  74,   18],
       [  18,   28],
       [  54, 1055],
       [  70,  489]])

In [274]: path_start_end_new                                                                                              
Out[274]: 
array([[17, 74],
       [74, 18],
       [18, 54],
       [54, 70],
       [70, 46]])

In [275]: path_Cluster_new                                                                                                
Out[275]: [17, 74, 18, 54, 70, 46]

In [276]: path_table_new                                                                                                  
Out[276]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_029_xpr2          264             17     TPS_2500_cp  gn_029_xpr1        736           74
1     TPS_2500_cp  gn_165_xpr1          487             74     TPS_2500_cp  gn_165_xpr2        499           18
2     TPS_2500_cp  gn_199_xpr2          165             18     TPS_2500_cp  gn_199_xpr1        766           54
3  TPS_10000_cp_2  gn_010_xpr1          783             54  TPS_10000_cp_2  gn_010_xpr2        217           70
4    TPS_22500_cp  gn_029_xpr2          208             70    TPS_22500_cp  gn_029_xpr1        619           46

In [277]: path_data_new                                                                                                   
Out[277]: 
   Traj  Start  End  Order
0     5    999    0     -1
1    18    985    0     -1
2    28    999   69     -1
3  1055      0  999      1
4   489    999  173     -1





######################### PATH_1022 k=15 #####################################


Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 490
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=15
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.png".format(nclusters,k),dpi=1200)



In [282]: path_new                                                                                                        
Out[282]: 
array([[ 17,   0],
       [ 70, 490]])

In [283]: path_start_end_new                                                                                              
Out[283]: 
array([[17, 70],
       [70, 46]])

In [284]: path_Cluster_new                                                                                                
Out[284]: [17, 70, 46]

In [285]: path_table_new                                                                                                  
Out[285]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_22500_cp  gn_030_xpr1           41             70  TPS_22500_cp  gn_030_xpr1        684           46

In [286]: path_data_new                                                                                                   
Out[286]: 
   Traj  Start  End  Order
0     0      0  501      1
1   490    356  999      1





######################### PATH_1022 k=16 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 18
Next Cluster 18
Cluster 18 sampled by Traj 34
Next Cluster 18
Cluster 18 sampled by Traj 25
Next Cluster 18
Cluster 18 sampled by Traj 30
Next Cluster 18
Cluster 18 sampled by Traj 16
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 489
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=16
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.png".format(nclusters,k),dpi=1200)




In [291]: path_new                                                                                                        
Out[291]: 
array([[ 17,   5],
       [ 74,  18],
       [ 18,  28],
       [ 54, 271],
       [ 70, 489]])

In [292]: path_start_end_new                                                                                              
Out[292]: 
array([[17, 74],
       [74, 18],
       [18, 54],
       [54, 70],
       [70, 46]])

In [293]: path_Cluster_new                                                                                                
Out[293]: [17, 74, 18, 54, 70, 46]

In [294]: path_table_new                                                                                                  
Out[294]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_029_xpr2          264             17   TPS_2500_cp  gn_029_xpr1        736           74
1   TPS_2500_cp  gn_165_xpr1          487             74   TPS_2500_cp  gn_165_xpr2        499           18
2   TPS_2500_cp  gn_199_xpr2          165             18   TPS_2500_cp  gn_199_xpr1        766           54
3  TPS_17500_cp  gn_064_xpr1          363             54  TPS_17500_cp  gn_064_xpr2        204           70
4  TPS_22500_cp  gn_029_xpr2          208             70  TPS_22500_cp  gn_029_xpr1        619           46

In [295]: path_data_new                                                                                                   
Out[295]: 
   Traj  Start  End  Order
0     5    999    0     -1
1    18    985    0     -1
2    28    999   69     -1
3   271    433  999      1
4   489    999  173     -1





######################### PATH_1022 k=17 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 250
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=17
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.png".format(nclusters,k),dpi=1200)



In [309]: path_new                                                                                                        
Out[309]: 
array([[ 17,   0],
       [ 54, 271],
       [ 70, 252],
       [ 51, 251],
       [ 70, 490]])

In [310]: path_start_end_new                                                                                              
Out[310]: 
array([[17, 54],
       [54, 70],
       [70, 51],
       [51, 70],
       [70, 46]])

In [311]: path_Cluster_new                                                                                                
Out[311]: [17, 54, 70, 51, 70, 46]

In [312]: path_table_new                                                                                                  
Out[312]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_17500_cp  gn_064_xpr1          363             54  TPS_17500_cp  gn_064_xpr2        204           70
2  TPS_15000_cp  gn_530_xpr1          349             70  TPS_15000_cp  gn_530_xpr2        256           51
3  TPS_15000_cp  gn_528_xpr1          649             51  TPS_15000_cp  gn_528_xpr1         52           70
4  TPS_22500_cp  gn_030_xpr1           41             70  TPS_22500_cp  gn_030_xpr1        684           46

In [313]: path_data_new                                                                                                   
Out[313]: 
   Traj  Start  End  Order
0     0      0  945      1
1   271    433  999      1
2   252    604    0     -1
3   251    247  844      1
4   490    356  999      1




######################### PATH_1022 k=18 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 489
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=18
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.png".format(nclusters,k),dpi=1200)



In [316]: path_new                                                                                                        
Out[316]: 
array([[  17,    0],
       [  54, 1133],
       [  70,  489]])

In [317]: path_start_end_new                                                                                              
Out[317]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [318]: path_Cluster_new                                                                                                
Out[318]: [17, 54, 70, 46]

In [319]: path_table_new                                                                                                  
Out[319]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
2    TPS_22500_cp  gn_029_xpr2          208             70    TPS_22500_cp  gn_029_xpr1        619           46

In [320]: path_data_new                                                                                                   
Out[320]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1133    607    0     -1
2   489    999  173     -1




######################### PATH_1022 k=19 #####################################


Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1097
Next Cluster 38
Cluster 38 sampled by Traj 1126
Next Cluster 33
Cluster 33 sampled by Traj 1112
Next Cluster 33
Cluster 33 sampled by Traj 1114
Next Cluster 38
Cluster 38 sampled by Traj 1095
Next Cluster 34
Cluster 34 sampled by Traj 1121
Next Cluster 34
Cluster 34 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 51
Cluster 51 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=19
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.png".format(nclusters,k),dpi=1200)



In [335]: path_new                                                                                                        
Out[335]: 
array([[  17,    0],
       [  54, 1041],
       [  34, 1083],
       [  70,  490]])

In [336]: path_start_end_new                                                                                              
Out[336]: 
array([[17, 54],
       [54, 34],
       [34, 70],
       [70, 46]])

In [337]: path_Cluster_new                                                                                                
Out[337]: [17, 54, 34, 70, 46]

In [338]: path_table_new                                                                                                  
Out[338]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_046_xpr1          779             34  TPS_12500_cp_2  gn_046_xpr2        221           70
3    TPS_22500_cp  gn_030_xpr1           41             70    TPS_22500_cp  gn_030_xpr1        684           46

In [339]: path_data_new                                                                                                   
Out[339]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1041      0  973      1
2  1083    999    0     -1
3   490    356  999      1



######################### PATH_1022 k=20 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 192
Next Cluster 5
Cluster 5 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 714
Next Cluster 70
Cluster 70 sampled by Traj 490
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=20
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1022.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1022.png".format(nclusters,k),dpi=1200)



In [344]: path_new                                                                                                        
Out[344]: 
array([[ 17,   0],
       [ 54, 170],
       [  5, 158],
       [ 70, 490]])

In [345]: path_start_end_new                                                                                              
Out[345]: 
array([[17, 54],
       [54,  5],
       [ 5, 70],
       [70, 46]])

In [346]: path_Cluster_new                                                                                                
Out[346]: [17, 54, 5, 70, 46]

In [347]: path_table_new                                                                                                  
Out[347]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1     TPS_10000  gn_273_xpr2          265             54     TPS_10000  gn_273_xpr1        735            5
2     TPS_10000  gn_158_xpr2           85              5     TPS_10000  gn_158_xpr1        743           70
3  TPS_22500_cp  gn_030_xpr1           41             70  TPS_22500_cp  gn_030_xpr1        684           46

In [348]: path_data_new                                                                                                   
Out[348]: 
   Traj  Start  End  Order
0     0      0  945      1
1   170      0  999      1
2   158    999  172     -1
3   490    356  999      1





######################### PATH_1023 k=0 #####################################


Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=0
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [376]: path_new                                                                                                        
Out[376]: 
array([[  22,  994],
       [  54, 1041],
       [  34, 1095]])

In [377]: path_start_end_new                                                                                              
Out[377]: 
array([[22, 54],
       [54, 34],
       [34, 38]])

In [378]: path_Cluster_new                                                                                                
Out[378]: [22, 54, 34, 38]

In [379]: path_table_new                                                                                                  
Out[379]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [380]: path_data_new                                                                                                   
Out[380]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1041      0  973      1
2  1095    999    0     -1




######################### PATH_1023 k=1 #####################################


Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 363
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1121
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=1
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)


In [398]: path_new                                                                                                        
Out[398]: 
array([[  22,  994],
       [  54,  208],
       [  70, 1083],
       [  34, 1121]])

In [399]: path_start_end_new                                                                                              
Out[399]: 
array([[22, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [401]: path_Cluster_new                                                                                                
Out[401]: [22, 54, 70, 34, 38]

In [402]: path_table_new                                                                                                  
Out[402]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1       TPS_12500  gn_011_xpr1          726             54       TPS_12500  gn_011_xpr2        217           70
2  TPS_12500_cp_2  gn_046_xpr2          221             70  TPS_12500_cp_2  gn_046_xpr1        779           34
3  TPS_12500_cp_2  gn_284_xpr1          547             34  TPS_12500_cp_2  gn_284_xpr1        467           38

In [403]: path_data_new                                                                                                   
Out[403]: 
   Traj  Start  End  Order
0   994     48  999      1
1   208     57  999      1
2  1083      0  999      1
3  1121     14   94      1





######################### PATH_1023 k=2 #####################################


Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 250
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 1182
Next Cluster 42
Cluster 42 sampled by Traj 1178
Next Cluster 27
Cluster 27 sampled by Traj 1179
Next Cluster 27
Cluster 27 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 490
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1121
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=2
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)




In [407]: path_new                                                                                                        
Out[407]: 
array([[  22,  995],
       [  54, 1055],
       [  70, 1083],
       [  34, 1121]])

In [408]: path_start_end_new                                                                                              
Out[408]: 
array([[22, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [409]: path_Cluster_new                                                                                                
Out[409]: [22, 54, 70, 34, 38]

In [410]: path_table_new                                                                                                  
Out[410]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
1  TPS_10000_cp_2  gn_010_xpr1          783             54  TPS_10000_cp_2  gn_010_xpr2        217           70
2  TPS_12500_cp_2  gn_046_xpr2          221             70  TPS_12500_cp_2  gn_046_xpr1        779           34
3  TPS_12500_cp_2  gn_284_xpr1          547             34  TPS_12500_cp_2  gn_284_xpr1        467           38

In [411]: path_data_new                                                                                                   
Out[411]: 
   Traj  Start  End  Order
0   995      0  965      1
1  1055      0  999      1
2  1083      0  999      1
3  1121     14   94      1






######################### PATH_1023 k=3 #####################################


Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1121
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=3
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [414]: path_new                                                                                                        
Out[414]: 
array([[  22,  994],
       [  54, 1038],
       [  70, 1083],
       [  34, 1121]])

In [415]: path_start_end_new                                                                                              
Out[415]: 
array([[22, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [416]: path_Cluster_new                                                                                                
Out[416]: [22, 54, 70, 34, 38]

In [417]: path_table_new                                                                                                  
Out[417]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_014_xpr1          849             54   TPS_7500_cp_2  gn_014_xpr2         33           70
2  TPS_12500_cp_2  gn_046_xpr2          221             70  TPS_12500_cp_2  gn_046_xpr1        779           34
3  TPS_12500_cp_2  gn_284_xpr1          547             34  TPS_12500_cp_2  gn_284_xpr1        467           38

In [418]: path_data_new                                                                                                   
Out[418]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1038      0  881      1
2  1083      0  999      1
3  1121     14   94      1




######################### PATH_1023 k=4 #####################################


Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 171
Next Cluster 20
Cluster 20 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 489
Next Cluster 46
Cluster 46 sampled by Traj 490
Next Cluster 70
Cluster 70 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1121
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=4
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [474]: path_new                                                                                                        
Out[474]: 
array([[  22,  995],
       [  54, 1041],
       [  34, 1121]])

In [475]: path_start_end_new                                                                                              
Out[475]: 
array([[22, 54],
       [54, 34],
       [34, 38]])

In [476]: path_Cluster_new                                                                                                
Out[476]: [22, 54, 34, 38]

In [477]: path_table_new                                                                                                  
Out[477]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_284_xpr1          547             34  TPS_12500_cp_2  gn_284_xpr1        467           38

In [478]: path_data_new                                                                                                   
Out[478]: 
   Traj  Start  End  Order
0   995      0  965      1
1  1041      0  973      1
2  1121     14   94      1




######################### PATH_1023 k=5 #####################################


Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=5
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [481]: path_new                                                                                                        
Out[481]: 
array([[  22,  994],
       [  54, 1133],
       [  70, 1041],
       [  34, 1097]])

In [482]: path_start_end_new                                                                                              
Out[482]: 
array([[22, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [483]: path_Cluster_new                                                                                                
Out[483]: [22, 54, 70, 34, 38]

In [484]: path_table_new                                                                                                  
Out[484]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
2   TPS_7500_cp_2  gn_125_xpr2          235             70   TPS_7500_cp_2  gn_125_xpr2        662           34
3  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [485]: path_data_new                                                                                                   
Out[485]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1133    607    0     -1
2  1041    546  973      1
3  1097      0  999      1




######################### PATH_1023 k=6 #####################################


Cluster 22 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=6
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [498]: path_new                                                                                                        
Out[498]: 
array([[  22,  994],
       [  54, 1043],
       [  70, 1041],
       [  34, 1097]])

In [499]: path_start_end_new                                                                                              
Out[499]: 
array([[22, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [500]: path_Cluster_new                                                                                                
Out[500]: [22, 54, 70, 34, 38]

In [501]: path_table_new                                                                                                  
Out[501]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_128_xpr2          163             54   TPS_7500_cp_2  gn_128_xpr1        823           70
2   TPS_7500_cp_2  gn_125_xpr2          235             70   TPS_7500_cp_2  gn_125_xpr2        662           34
3  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [502]: path_data_new                                                                                                   
Out[502]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1043    999   14     -1
2  1041    546  973      1
3  1097      0  999      1




######################### PATH_1023 k=7 #####################################

Cluster 22 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=7
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [506]: path_new                                                                                                        
Out[506]: 
array([[  22,  994],
       [  54, 1041],
       [  34, 1095]])

In [507]: path_start_end_new                                                                                              
Out[507]: 
array([[22, 54],
       [54, 34],
       [34, 38]])

In [508]: path_Cluster_new                                                                                                
Out[508]: [22, 54, 34, 38]

In [509]: path_table_new                                                                                                  
Out[509]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [510]: path_data_new                                                                                                   
Out[510]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1041      0  973      1
2  1095    999    0     -1





######################### PATH_1023 k=8 #####################################


Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 186
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=8
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [518]: path_new                                                                                                        
Out[518]: 
array([[  22,  994],
       [  54, 1055],
       [  70, 1083],
       [  34, 1097]])

In [519]: path_start_end_new                                                                                              
Out[519]: 
array([[22, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [520]: path_Cluster_new                                                                                                
Out[520]: [22, 54, 70, 34, 38]

In [521]: path_table_new                                                                                                  
Out[521]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_10000_cp_2  gn_010_xpr1          783             54  TPS_10000_cp_2  gn_010_xpr2        217           70
2  TPS_12500_cp_2  gn_046_xpr2          221             70  TPS_12500_cp_2  gn_046_xpr1        779           34
3  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [522]: path_data_new                                                                                                   
Out[522]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1055      0  999      1
2  1083      0  999      1
3  1097      0  999      1




######################### PATH_1023 k=9 #####################################


Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 62
Cluster 62 sampled by Traj 222
Next Cluster 24
Cluster 24 sampled by Traj 221
Next Cluster 62
Cluster 62 sampled by Traj 220
Next Cluster 62
Cluster 62 sampled by Traj 223
Next Cluster 24
Cluster 24 sampled by Traj 230
Next Cluster 24
Cluster 24 sampled by Traj 231
Next Cluster 24
Cluster 24 sampled by Traj 240
Next Cluster 55
Cluster 55 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 27
Cluster 27 sampled by Traj 1182
Next Cluster 42
Cluster 42 sampled by Traj 1178
Next Cluster 42
Cluster 42 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=9
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [542]: path_new                                                                                                        
Out[542]: 
array([[  22,  994],
       [  54,  170],
       [   5,  158],
       [  34, 1097]])

In [543]: path_start_end_new                                                                                              
Out[543]: 
array([[22, 54],
       [54,  5],
       [ 5, 34],
       [34, 38]])

In [544]: path_Cluster_new                                                                                                
Out[544]: [22, 54, 5, 34, 38]

In [545]: path_table_new                                                                                                  
Out[545]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1       TPS_10000  gn_273_xpr2          265             54       TPS_10000  gn_273_xpr1        735            5
2       TPS_10000  gn_158_xpr2           85              5       TPS_10000  gn_158_xpr1        754           34
3  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [546]: path_data_new                                                                                                   
Out[546]: 
   Traj  Start  End  Order
0   994     48  999      1
1   170      0  999      1
2   158    999  161     -1
3  1097      0  999      1





######################### PATH_1023 k=10 #####################################


Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 490
Next Cluster 70
Cluster 70 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 27
Cluster 27 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=10
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [556]: path_new                                                                                                        
Out[556]: 
array([[  22,  994],
       [  54, 1041],
       [  34, 1097]])

In [557]: path_start_end_new                                                                                              
Out[557]: 
array([[22, 54],
       [54, 34],
       [34, 38]])

In [558]: path_Cluster_new                                                                                                
Out[558]: [22, 54, 34, 38]

In [559]: path_table_new                                                                                                  
Out[559]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [560]: path_data_new                                                                                                   
Out[560]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1041      0  973      1
2  1097      0  999      1



######################### PATH_1023 k=11 #####################################



Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 86
Next Cluster 3
Cluster 3 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1121
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=11
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)


In [565]: path_new                                                                                                        
Out[565]: 
array([[  22,  994],
       [  54, 1055],
       [  70, 1041],
       [  34, 1121]])

In [566]: path_start_end_new                                                                                              
Out[566]: 
array([[22, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [567]: path_Cluster_new                                                                                                
Out[567]: [22, 54, 70, 34, 38]

In [568]: path_table_new                                                                                                  
Out[568]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_10000_cp_2  gn_010_xpr1          783             54  TPS_10000_cp_2  gn_010_xpr2        217           70
2   TPS_7500_cp_2  gn_125_xpr2          235             70   TPS_7500_cp_2  gn_125_xpr2        662           34
3  TPS_12500_cp_2  gn_284_xpr1          547             34  TPS_12500_cp_2  gn_284_xpr1        467           38

In [569]: path_data_new                                                                                                   
Out[569]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1055      0  999      1
2  1041    546  973      1
3  1121     14   94      1




######################### PATH_1023 k=12 #####################################


Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=12
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [577]: path_new                                                                                                        
Out[577]: 
array([[  22,  994],
       [  54, 1041],
       [  34, 1097]])

In [578]: path_start_end_new                                                                                              
Out[578]: 
array([[22, 54],
       [54, 34],
       [34, 38]])

In [579]: path_Cluster_new                                                                                                
Out[579]: [22, 54, 34, 38]

In [580]: path_table_new                                                                                                  
Out[580]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [581]: path_data_new                                                                                                   
Out[581]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1041      0  973      1
2  1097      0  999      1



######################### PATH_1023 k=13 #####################################


Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=13
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [593]: path_new                                                                                                        
Out[593]: 
array([[  22,  994],
       [  54,  170],
       [   5,  158],
       [  34, 1095]])

In [594]: path_start_end_new                                                                                              
Out[594]: 
array([[22, 54],
       [54,  5],
       [ 5, 34],
       [34, 38]])

In [595]: path_Cluster_new                                                                                                
Out[595]: [22, 54, 5, 34, 38]

In [596]: path_table_new                                                                                                  
Out[596]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1       TPS_10000  gn_273_xpr2          265             54       TPS_10000  gn_273_xpr1        735            5
2       TPS_10000  gn_158_xpr2           85              5       TPS_10000  gn_158_xpr1        754           34
3  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [597]: path_data_new                                                                                                   
Out[597]: 
   Traj  Start  End  Order
0   994     48  999      1
1   170      0  999      1
2   158    999  161     -1
3  1095    999    0     -1



######################### PATH_1023 k=14 #####################################


Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 175
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 189
Next Cluster 69
Cluster 69 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1121
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=14
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)


In [600]: path_new                                                                                                        
Out[600]: 
array([[  22,  994],
       [  54, 1033],
       [  70,  159],
       [   5,  187],
       [  20,  191],
       [   5,  158],
       [  34, 1121]])

In [601]: path_start_end_new                                                                                              
Out[601]: 
array([[22, 54],
       [54, 70],
       [70,  5],
       [ 5, 20],
       [20,  5],
       [ 5, 34],
       [34, 38]])

In [602]: path_Cluster_new                                                                                                
Out[602]: [22, 54, 70, 5, 20, 5, 34, 38]

In [603]: path_table_new                                                                                                  
Out[603]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_5000_cp_2  gn_105_xpr1          549             54   TPS_5000_cp_2  gn_105_xpr2        141           70
2       TPS_10000  gn_176_xpr2            2             70       TPS_10000  gn_176_xpr1        501            5
3       TPS_10000  gn_409_xpr2          544              5       TPS_10000  gn_409_xpr2        352           20
4       TPS_10000  gn_448_xpr1          501             20       TPS_10000  gn_448_xpr1         19            5
5       TPS_10000  gn_158_xpr2           85              5       TPS_10000  gn_158_xpr1        754           34
6  TPS_12500_cp_2  gn_284_xpr1          547             34  TPS_12500_cp_2  gn_284_xpr1        467           38

In [604]: path_data_new                                                                                                   
Out[604]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1033    999  310     -1
2   159    502    0     -1
3   187    109  301      1
4   191    999  517     -1
5   158    999  161     -1
6  1121     14   94      1





######################### PATH_1023 k=15 #####################################


Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 1134
Next Cluster 16
Cluster 16 sampled by Traj 1150
Next Cluster 16
Cluster 16 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=15
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [609]: path_new                                                                                                        
Out[609]: 
array([[  22,  994],
       [  54, 1044],
       [  70, 1134],
       [  16, 1136],
       [  70,  158],
       [  34, 1095]])

In [610]: path_start_end_new                                                                                              
Out[610]: 
array([[22, 54],
       [54, 70],
       [70, 16],
       [16, 70],
       [70, 34],
       [34, 38]])

In [611]: path_Cluster_new                                                                                                
Out[611]: [22, 54, 70, 16, 70, 34, 38]

In [612]: path_table_new                                                                                                  
Out[612]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_156_xpr1          744             54   TPS_7500_cp_2  gn_156_xpr2        230           70
2  TPS_17500_cp_2  gn_019_xpr2          140             70  TPS_17500_cp_2  gn_019_xpr1        751           16
3  TPS_17500_cp_2  gn_045_xpr1          467             16  TPS_17500_cp_2  gn_045_xpr2        380           70
4       TPS_10000  gn_158_xpr2           54             70       TPS_10000  gn_158_xpr1        754           34
5  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [613]: path_data_new                                                                                                   
Out[613]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1044    999   26     -1
2  1134    999  109     -1
3  1136      0  846      1
4   158    968  161     -1
5  1095    999    0     -1




######################### PATH_1023 k=16 #####################################


Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 1171
Next Cluster 27
Cluster 27 sampled by Traj 1179
Next Cluster 27
Cluster 27 sampled by Traj 1178
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 27
Cluster 27 sampled by Traj 1182
Next Cluster 27
Cluster 27 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 715
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 70
Cluster 70 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=16
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)




In [19]: path_new                                                                                               
Out[19]: 
array([[  22,  995],
       [  54, 1041],
       [  34, 1097]])

In [20]: path_start_end_new                                                                                     
Out[20]: 
array([[22, 54],
       [54, 34],
       [34, 38]])

In [21]: path_Cluster_new                                                                                       
Out[21]: [22, 54, 34, 38]

In [22]: path_table_new                                                                                         
Out[22]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [23]: path_data_new                                                                                          
Out[23]: 
   Traj  Start  End  Order
0   995      0  965      1
1  1041      0  973      1
2  1097      0  999      1






######################### PATH_1023 k=17 #####################################


Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1121
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=17
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)



In [36]: path_new                                                                                               
Out[36]: 
array([[  22,  994],
       [  54,  367],
       [  71,  362],
       [  70, 1083],
       [  34, 1121]])

In [37]: path_start_end_new                                                                                     
Out[37]: 
array([[22, 54],
       [54, 71],
       [71, 70],
       [70, 34],
       [34, 38]])

In [38]: path_Cluster_new                                                                                       
Out[38]: [22, 54, 71, 70, 34, 38]

In [39]: path_table_new                                                                                         
Out[39]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1    TPS_20000_cp  gn_073_xpr1          888             54    TPS_20000_cp  gn_073_xpr2         62           71
2    TPS_20000_cp  gn_030_xpr2          144             71    TPS_20000_cp  gn_030_xpr1        841           70
3  TPS_12500_cp_2  gn_046_xpr2          221             70  TPS_12500_cp_2  gn_046_xpr1        779           34
4  TPS_12500_cp_2  gn_284_xpr1          547             34  TPS_12500_cp_2  gn_284_xpr1        467           38

In [40]: path_data_new                                                                                          
Out[40]: 
   Traj  Start  End  Order
0   994     48  999      1
1   367     50  999      1
2   362    985    1     -1
3  1083      0  999      1
4  1121     14   94      1





######################### PATH_1023 k=18 #####################################


Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=18
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)




In [53]: path_new                                                                                               
Out[53]: 
array([[  22,  994],
       [  54, 1044],
       [  70,  159],
       [   5,  158],
       [  34, 1095]])

In [54]: path_start_end_new                                                                                     
Out[54]: 
array([[22, 54],
       [54, 70],
       [70,  5],
       [ 5, 34],
       [34, 38]])

In [55]: path_Cluster_new                                                                                       
Out[55]: [22, 54, 70, 5, 34, 38]

In [56]: path_table_new                                                                                         
Out[56]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_156_xpr1          744             54   TPS_7500_cp_2  gn_156_xpr2        230           70
2       TPS_10000  gn_176_xpr2            2             70       TPS_10000  gn_176_xpr1        501            5
3       TPS_10000  gn_158_xpr2           85              5       TPS_10000  gn_158_xpr1        754           34
4  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [57]: path_data_new                                                                                          
Out[57]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1044    999   26     -1
2   159    502    0     -1
3   158    999  161     -1
4  1095    999    0     -1




######################### PATH_1023 k=19 #####################################


Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 715
Next Cluster 70
Cluster 70 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 1170
Next Cluster 27
Cluster 27 sampled by Traj 1178
Next Cluster 27
Cluster 27 sampled by Traj 1182
Next Cluster 27
Cluster 27 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 1179
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 27
Cluster 27 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 55
Cluster 55 sampled by Traj 226
Next Cluster 55
Cluster 55 sampled by Traj 240
Next Cluster 24
Cluster 24 sampled by Traj 220
Next Cluster 62
Cluster 62 sampled by Traj 221
Next Cluster 24
Cluster 24 sampled by Traj 222
Next Cluster 55
Cluster 55 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=19
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1023.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1023.png".format(nclusters,k),dpi=1200)


In [65]: path_new                                                                                               
Out[65]: 
array([[  22,  994],
       [  54, 1044],
       [  70,  159],
       [   5,  158],
       [  34, 1095]])

In [66]: path_start_end_new                                                                                     
Out[66]: 
array([[22, 54],
       [54, 70],
       [70,  5],
       [ 5, 34],
       [34, 38]])

In [67]: path_Cluster_new                                                                                       
Out[67]: [22, 54, 70, 5, 34, 38]

In [68]: path_table_new                                                                                         
Out[68]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_156_xpr1          744             54   TPS_7500_cp_2  gn_156_xpr2        230           70
2       TPS_10000  gn_176_xpr2            2             70       TPS_10000  gn_176_xpr1        501            5
3       TPS_10000  gn_158_xpr2           85              5       TPS_10000  gn_158_xpr1        754           34
4  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [69]: path_data_new                                                                                          
Out[69]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1044    999   26     -1
2   159    502    0     -1
3   158    999  161     -1
4  1095    999    0     -1



######################### PATH_1015 k=0 #####################################


Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                        

k=0
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [190]: path_new                                                                                                         
Out[190]: 
array([[  22,  994],
       [  54, 1041],
       [  34, 1083],
       [  70,  490]])

In [191]: path_start_end_new                                                                                               
Out[191]: 
array([[22, 54],
       [54, 34],
       [34, 70],
       [70, 46]])

In [192]: path_Cluster_new                                                                                                 
Out[192]: [22, 54, 34, 70, 46]

In [193]: path_table_new                                                                                                   
Out[193]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_046_xpr1          779             34  TPS_12500_cp_2  gn_046_xpr2        221           70
3    TPS_22500_cp  gn_030_xpr1           41             70    TPS_22500_cp  gn_030_xpr1        684           46

In [194]: path_data_new                                                                                                    
Out[194]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1041      0  973      1
2  1083    999    0     -1
3   490    356  999      1


######################### PATH_1015 k=1 #####################################


Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 685
Next Cluster 10
Cluster 10 sampled by Traj 867
Next Cluster 59
Cluster 59 sampled by Traj 883
Next Cluster 59
Cluster 59 sampled by Traj 871
Next Cluster 10
Cluster 10 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 489
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)



k=1
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [202]: path_new                                                                                                         
Out[202]: 
array([[ 22, 994],
       [ 54, 362],
       [ 70, 930],
       [ 10, 489]])

In [203]: path_start_end_new                                                                                               
Out[203]: 
array([[22, 54],
       [54, 70],
       [70, 10],
       [10, 46]])

In [204]: path_Cluster_new                                                                                                 
Out[204]: [22, 54, 70, 10, 46]

In [205]: path_table_new                                                                                                   
Out[205]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_20000_cp  gn_030_xpr1          842             54   TPS_20000_cp  gn_030_xpr1        807           70
2   TPS_37500_cp  gn_090_xpr1          185             70   TPS_37500_cp  gn_090_xpr2        815           10
3   TPS_22500_cp  gn_029_xpr1          792             10   TPS_22500_cp  gn_029_xpr1         85           46

In [206]: path_data_new                                                                                                    
Out[206]: 
   Traj  Start  End  Order
0   994     48  999      1
1   362      0   35      1
2   930    999    0     -1
3   489      0  707      1



######################### PATH_1015 k=2 #####################################


Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 27
Cluster 27 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


k=2
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)

                                                    
In [212]: path_new                                                                                                         
Out[212]: 
array([[  22,  994],
       [  54, 1041],
       [  34, 1095]])

In [213]: path_start_end_new                                                                                               
Out[213]: 
array([[22, 54],
       [54, 34],
       [34, 38]])

In [214]: path_Cluster_new                                                                                                 
Out[214]: [22, 54, 34, 38]

In [215]: path_table_new                                                                                                   
Out[215]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [216]: path_data_new                                                                                                    
Out[216]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1041      0  973      1
2  1095    999    0     -1




######################### PATH_1015 k=3 #####################################


Cluster 18 sampled by Traj 20
Next Cluster 18
Cluster 18 sampled by Traj 34
Next Cluster 40
Cluster 40 sampled by Traj 35
Next Cluster 56
Cluster 56 sampled by Traj 33
Next Cluster 56
Cluster 56 sampled by Traj 61
Next Cluster 21
Cluster 21 sampled by Traj 47
Next Cluster 56
Cluster 56 sampled by Traj 75
Next Cluster 21
Cluster 21 sampled by Traj 45
Next Cluster 56
Cluster 56 sampled by Traj 38
Next Cluster 56
Cluster 56 sampled by Traj 50
Next Cluster 21
Cluster 21 sampled by Traj 64
Next Cluster 56
Cluster 56 sampled by Traj 36
Next Cluster 56
Cluster 56 sampled by Traj 63
Next Cluster 21
Cluster 21 sampled by Traj 48
Next Cluster 56
Cluster 56 sampled by Traj 32
Next Cluster 40
Cluster 40 sampled by Traj 44
Next Cluster 40
Cluster 40 sampled by Traj 30
Next Cluster 40
Cluster 40 sampled by Traj 39
Next Cluster 40
Cluster 40 sampled by Traj 25
Next Cluster 18
Cluster 18 sampled by Traj 16
Next Cluster 18
Cluster 18 sampled by Traj 29
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 715
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


k=3
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [221]: path_new                                                                                                         
Out[221]: 
array([[ 18,  28],
       [ 54, 117],
       [ 70, 715]])

In [222]: path_start_end_new                                                                                               
Out[222]: 
array([[18, 54],
       [54, 70],
       [70, 25]])

In [223]: path_Cluster_new                                                                                                 
Out[223]: [18, 54, 70, 25]

In [225]: path_table_new                                                                                                   
Out[225]: 
  Start_window   Start_traj  Start_frame  Start_cluster   End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp  gn_199_xpr2          165             18  TPS_2500_cp  gn_199_xpr1        766           54
1     TPS_7500  gn_067_xpr1          379             54     TPS_7500  gn_067_xpr1          4           70
2    TPS_30000  gn_130_xpr1          225             70    TPS_30000  gn_130_xpr2        775           25

In [226]: path_data_new                                                                                                    
Out[226]: 
   Traj  Start  End  Order
0    28    999   69     -1
1   117    302  677      1
2   715    999    0     -1





######################### PATH_1015 k=4 #####################################


Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


k=4
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [240]: path_new                                                                                                         
Out[240]: 
array([[  57, 1012],
       [  22,  994],
       [  54,  362],
       [  70,  489]])

In [241]: path_start_end_new                                                                                               
Out[241]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [242]: path_Cluster_new                                                                                                 
Out[242]: [57, 22, 54, 70, 46]

In [243]: path_table_new                                                                                                   
Out[243]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_234_xpr2          244             57  TPS_2500_cp_2  gn_234_xpr1        742           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2   TPS_20000_cp  gn_030_xpr1          842             54   TPS_20000_cp  gn_030_xpr1        807           70
3   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46

In [244]: path_data_new                                                                                                    
Out[244]: 
   Traj  Start  End  Order
0  1012    999   14     -1
1   994     48  999      1
2   362      0   35      1
3   489    999  173     -1




######################### PATH_1015 k=5 #####################################


Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 1170
Next Cluster 27
Cluster 27 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 715
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


k=5
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [248]: path_new                                                                                                         
Out[248]: 
array([[ 22, 994],
       [ 54, 271],
       [ 70, 715]])

In [249]: path_start_end_new                                                                                               
Out[249]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [250]: path_Cluster_new                                                                                                 
Out[250]: [22, 54, 70, 25]

In [251]: path_table_new                                                                                                   
Out[251]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_17500_cp  gn_064_xpr1          363             54   TPS_17500_cp  gn_064_xpr2        204           70
2      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [252]: path_data_new                                                                                                    
Out[252]: 
   Traj  Start  End  Order
0   994     48  999      1
1   271    433  999      1
2   715    999    0     -1




######################### PATH_1015 k=6 #####################################

Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 714
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


k=6
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [258]: path_new                                                                                                         
Out[258]: 
array([[  22,  994],
       [  54, 1040],
       [  70,  714]])

In [259]: path_start_end_new                                                                                               
Out[259]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [260]: path_table_new                                                                                                   
Out[260]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_7500_cp_2  gn_117_xpr2          900             54  TPS_7500_cp_2  gn_117_xpr1         93           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [261]: path_data_new                                                                                                    
Out[261]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1040      0  992      1
2   714      0  739      1

In [262]: path_Cluster_new                                                                                                 
Out[262]: [22, 54, 70, 25]



######################### PATH_1015 k=7 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 490
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


k=7
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [265]: path_new                                                                                                         
Out[265]: 
array([[  17,    0],
       [  54, 1031],
       [  70,  490]])

In [266]: path_start_end_new                                                                                               
Out[266]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [267]: path_Cluster_new                                                                                                 
Out[267]: [17, 54, 70, 46]

In [268]: path_table_new                                                                                                   
Out[268]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_5000_cp_2  gn_066_xpr2          349             54  TPS_5000_cp_2  gn_066_xpr1        138           70
2   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [269]: path_data_new                                                                                                    
Out[269]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1031      0  486      1
2   490    356  999      1



######################### PATH_1015 k=8 #####################################


Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 1063
Next Cluster 39
Cluster 39 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1041
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 58
Cluster 58 sampled by Traj 866
Next Cluster 59
Cluster 59 sampled by Traj 868
Next Cluster 59
Cluster 59 sampled by Traj 882
Next Cluster 59
Cluster 59 sampled by Traj 883
Next Cluster 59
Cluster 59 sampled by Traj 871
Next Cluster 59
Cluster 59 sampled by Traj 867
Next Cluster 59
Cluster 59 sampled by Traj 873
Next Cluster 59
Cluster 59 sampled by Traj 870
Next Cluster 10
Cluster 10 sampled by Traj 940
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


k=8
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [279]: path_new                                                                                                         
Out[279]: 
array([[  22,  995],
       [  54,   76],
       [   3, 1063],
       [  39, 1061],
       [  70,  930],
       [  10,  940]])

In [280]: path_start_end_new                                                                                               
Out[280]: 
array([[22, 54],
       [54,  3],
       [ 3, 39],
       [39, 70],
       [70, 10],
       [10, 48]])

In [281]: path_Cluster_new                                                                                                 
Out[281]: [22, 54, 3, 39, 70, 10, 48]

In [282]: path_table_new                                                                                                   
Out[282]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
1     TPS_5000_cp  gn_028_xpr2          258             54     TPS_5000_cp  gn_028_xpr1        742            3
2  TPS_10000_cp_2  gn_207_xpr2          808              3  TPS_10000_cp_2  gn_207_xpr1        189           39
3  TPS_10000_cp_2  gn_176_xpr1          949             39  TPS_10000_cp_2  gn_176_xpr1        171           70
4    TPS_37500_cp  gn_090_xpr1          185             70    TPS_37500_cp  gn_090_xpr2        815           10
5    TPS_37500_cp  gn_204_xpr1           96             10    TPS_37500_cp  gn_204_xpr2        904           48

In [283]: path_data_new                                                                                                    
Out[283]: 
   Traj  Start  End  Order
0   995      0  965      1
1    76    999    0     -1
2  1063      3  999      1
3  1061      0  778      1
4   930    999    0     -1
5   940    999    0     -1





######################### PATH_1015 k=9 #####################################


Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 1084
Next Cluster 34
Cluster 34 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


k=9
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [286]: path_new                                                                                                         
Out[286]: 
array([[  57, 1009],
       [  22,  994],
       [  54, 1029],
       [  70, 1084],
       [  34, 1097]])

In [287]: path_start_end_new                                                                                               
Out[287]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [288]: path_Cluster_new                                                                                                 
Out[288]: [57, 22, 54, 70, 34, 38]

In [289]: path_table_new                                                                                                   
Out[289]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_222_xpr1          341             57   TPS_2500_cp_2  gn_222_xpr2        426           22
1   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
2   TPS_5000_cp_2  gn_011_xpr1          752             54   TPS_5000_cp_2  gn_011_xpr2         19           70
3  TPS_12500_cp_2  gn_087_xpr1          357             70  TPS_12500_cp_2  gn_087_xpr2        506           34
4  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [290]: path_data_new                                                                                                    
Out[290]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   994     48  999      1
2  1029      0  770      1
3  1084    862    0     -1
4  1097      0  999      1



######################### PATH_1015 k=10 #####################################


Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 168
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 714
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


k=10
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [298]: path_new                                                                                                         
Out[298]: 
array([[ 18,  28],
       [ 54, 170],
       [  5, 158],
       [ 70, 714]])

In [299]: path_start_end_new                                                                                               
Out[299]: 
array([[18, 54],
       [54,  5],
       [ 5, 70],
       [70, 25]])

In [300]: path_Cluster_new                                                                                                 
Out[300]: [18, 54, 5, 70, 25]

In [301]: path_table_new                                                                                                   
Out[301]: 
  Start_window   Start_traj  Start_frame  Start_cluster   End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp  gn_199_xpr2          165             18  TPS_2500_cp  gn_199_xpr1        766           54
1    TPS_10000  gn_273_xpr2          265             54    TPS_10000  gn_273_xpr1        735            5
2    TPS_10000  gn_158_xpr2           85              5    TPS_10000  gn_158_xpr1        743           70
3    TPS_30000  gn_129_xpr2          499             70    TPS_30000  gn_129_xpr1        241           25

In [302]: path_data_new                                                                                                    
Out[302]: 
   Traj  Start  End  Order
0    28    999   69     -1
1   170      0  999      1
2   158    999  172     -1
3   714      0  739      1



######################### PATH_1015 k=11 #####################################


Cluster 18 sampled by Traj 28
Next Cluster 18
Cluster 18 sampled by Traj 30
Next Cluster 18
Cluster 18 sampled by Traj 25
Next Cluster 18
Cluster 18 sampled by Traj 18
Next Cluster 74
Cluster 74 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 490
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


k=11
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)




In [307]: path_new                                                                                                         
Out[307]: 
array([[ 18,  18],
       [ 74,   5],
       [ 17,   0],
       [ 54, 208],
       [ 70, 490]])

In [308]: path_start_end_new                                                                                               
Out[308]: 
array([[18, 74],
       [74, 17],
       [17, 54],
       [54, 70],
       [70, 46]])

In [309]: path_Cluster_new                                                                                                 
Out[309]: [18, 74, 17, 54, 70, 46]

In [310]: path_table_new                                                                                                   
Out[310]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_165_xpr2          499             18   TPS_2500_cp  gn_165_xpr1        487           74
1   TPS_2500_cp  gn_029_xpr1          736             74   TPS_2500_cp  gn_029_xpr2        264           17
2   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
3     TPS_12500  gn_011_xpr1          726             54     TPS_12500  gn_011_xpr2        217           70
4  TPS_22500_cp  gn_030_xpr1           41             70  TPS_22500_cp  gn_030_xpr1        684           46

In [311]: path_data_new                                                                                                    
Out[311]: 
   Traj  Start  End  Order
0    18      0  985      1
1     5      0  999      1
2     0      0  945      1
3   208     57  999      1
4   490    356  999      1




######################### PATH_1015 k=12 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 16
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 74
Cluster 74 sampled by Traj 18
Next Cluster 18
Cluster 18 sampled by Traj 34
Next Cluster 40
Cluster 40 sampled by Traj 44
Next Cluster 56
Cluster 56 sampled by Traj 39
Next Cluster 40
Cluster 40 sampled by Traj 36
Next Cluster 56
Cluster 56 sampled by Traj 50
Next Cluster 21
Cluster 21 sampled by Traj 75
Next Cluster 56
Cluster 56 sampled by Traj 48
Next Cluster 56
Cluster 56 sampled by Traj 49
Next Cluster 21
Cluster 21 sampled by Traj 63
Next Cluster 56
Cluster 56 sampled by Traj 46
Next Cluster 21
Cluster 21 sampled by Traj 47
Next Cluster 21
Cluster 21 sampled by Traj 45
Next Cluster 56
Cluster 56 sampled by Traj 61
Next Cluster 56
Cluster 56 sampled by Traj 35
Next Cluster 56
Cluster 56 sampled by Traj 62
Next Cluster 56
Cluster 56 sampled by Traj 33
Next Cluster 56
Cluster 56 sampled by Traj 32
Next Cluster 56
Cluster 56 sampled by Traj 64
Next Cluster 56
Cluster 56 sampled by Traj 38
Next Cluster 40
Cluster 40 sampled by Traj 29
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 39
Cluster 39 sampled by Traj 1072
Next Cluster 52
Cluster 52 sampled by Traj 1071
Next Cluster 39
Cluster 39 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 168
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


k=12
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [316]: path_new                                                                                                         
Out[316]: 
array([[  17,    5],
       [  74,   18],
       [  18,   28],
       [  54, 1133],
       [  70, 1083],
       [  34, 1095]])

In [317]: path_start_end_new                                                                                               
Out[317]: 
array([[17, 74],
       [74, 18],
       [18, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [318]: path_Cluster_new                                                                                                 
Out[318]: [17, 74, 18, 54, 70, 34, 38]

In [319]: path_table_new                                                                                                   
Out[319]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_029_xpr2          264             17     TPS_2500_cp  gn_029_xpr1        736           74
1     TPS_2500_cp  gn_165_xpr1          487             74     TPS_2500_cp  gn_165_xpr2        499           18
2     TPS_2500_cp  gn_199_xpr2          165             18     TPS_2500_cp  gn_199_xpr1        766           54
3  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
4  TPS_12500_cp_2  gn_046_xpr2          221             70  TPS_12500_cp_2  gn_046_xpr1        779           34
5  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [320]: path_data_new                                                                                                    
Out[320]: 
   Traj  Start  End  Order
0     5    999    0     -1
1    18    985    0     -1
2    28    999   69     -1
3  1133    607    0     -1
4  1083      0  999      1
5  1095    999    0     -1





######################### PATH_1015 k=13 #####################################


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)


Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 43
Cluster 43 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 868
Next Cluster 10
Cluster 10 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 489
Final





k=13
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [15]: path_new                                                                                                      
Out[15]: 
array([[  57, 1007],
       [  22,  994],
       [  54, 1133],
       [  70,  808],
       [  43,  812],
       [  10,  489]])

In [16]: path_start_end_new                                                                                            
Out[16]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 43],
       [43, 10],
       [10, 46]])

In [17]: path_Cluster_new                                                                                              
Out[17]: [57, 22, 54, 70, 43, 10, 46]

In [18]: path_table_new                                                                                                
Out[18]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_219_xpr2          836             57   TPS_2500_cp_2  gn_219_xpr1        159           22
1   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
3    TPS_35000_cp  gn_049_xpr2          301             70    TPS_35000_cp  gn_049_xpr1        699           43
4    TPS_35000_cp  gn_072_xpr1          394             43    TPS_35000_cp  gn_072_xpr2        606           10
5    TPS_22500_cp  gn_029_xpr1          792             10    TPS_22500_cp  gn_029_xpr1         85           46

In [19]: path_data_new                                                                                                 
Out[19]: 
   Traj  Start  End  Order
0  1007      5  999      1
1   994     48  999      1
2  1133    607    0     -1
3   808    999    0     -1
4   812    999    0     -1
5   489      0  707      1


######################### PATH_1015 k=14 #####################################

Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 490
Final


path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=14
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [24]: path_new                                                                                                      
Out[24]: 
array([[  57, 1011],
       [  22,  994],
       [  54, 1029],
       [  70,  490]])

In [25]: path_start_end_new                                                                                            
Out[25]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [26]: path_Cluster_new                                                                                              
Out[26]: [57, 22, 54, 70, 46]

In [27]: path_table_new                                                                                                
Out[27]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_226_xpr2          934             57  TPS_2500_cp_2  gn_226_xpr2         45           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_5000_cp_2  gn_011_xpr1          752             54  TPS_5000_cp_2  gn_011_xpr2         19           70
3   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [28]: path_data_new                                                                                                 
Out[28]: 
   Traj  Start  End  Order
0  1011      0  889      1
1   994     48  999      1
2  1029      0  770      1
3   490    356  999      1





######################### PATH_1015 k=15 #####################################


Cluster 18 sampled by Traj 29
Next Cluster 18
Cluster 18 sampled by Traj 30
Next Cluster 18
Cluster 18 sampled by Traj 34
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 18
Cluster 18 sampled by Traj 20
Next Cluster 18
Cluster 18 sampled by Traj 16
Next Cluster 18
Cluster 18 sampled by Traj 18
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=15
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [35]: path_new                                                                                                      
Out[35]: 
array([[  18,   18],
       [  74,    6],
       [  17,    0],
       [  54,  170],
       [   5,  158],
       [  34, 1095]])

In [36]: path_start_end_new                                                                                            
Out[36]: 
array([[18, 74],
       [74, 17],
       [17, 54],
       [54,  5],
       [ 5, 34],
       [34, 38]])

In [37]: path_Cluster_new                                                                                              
Out[37]: [18, 74, 17, 54, 5, 34, 38]

In [38]: path_table_new                                                                                                
Out[38]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_165_xpr2          499             18     TPS_2500_cp  gn_165_xpr1        487           74
1     TPS_2500_cp  gn_037_xpr1          478             74     TPS_2500_cp  gn_037_xpr2        251           17
2     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
3       TPS_10000  gn_273_xpr2          265             54       TPS_10000  gn_273_xpr1        735            5
4       TPS_10000  gn_158_xpr2           85              5       TPS_10000  gn_158_xpr1        754           34
5  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [39]: path_data_new                                                                                                 
Out[39]: 
   Traj  Start  End  Order
0    18      0  985      1
1     6    999  271     -1
2     0      0  945      1
3   170      0  999      1
4   158    999  161     -1
5  1095    999    0     -1




######################### PATH_1015 k=16 #####################################


                    
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 489
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=16
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)




In [43]: path_new                                                                                                                         
Out[43]: 
array([[  57, 1009],
       [  22,  994],
       [  54,  362],
       [  71,  363],
       [  70,  654],
       [  72,  664],
       [  10,  489]])

In [44]: path_start_end_new                                                                                                               
Out[44]: 
array([[57, 22],
       [22, 54],
       [54, 71],
       [71, 70],
       [70, 72],
       [72, 10],
       [10, 46]])

In [45]: path_Cluster_new                                                                                                                 
Out[45]: [57, 22, 54, 71, 70, 72, 10, 46]

In [46]: path_table_new                                                                                                                   
Out[46]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_222_xpr1          341             57  TPS_2500_cp_2  gn_222_xpr2        426           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2   TPS_20000_cp  gn_030_xpr1          842             54   TPS_20000_cp  gn_030_xpr2        144           71
3   TPS_20000_cp  gn_033_xpr1          808             71   TPS_20000_cp  gn_033_xpr2        182           70
4   TPS_27500_cp  gn_082_xpr2          295             70   TPS_27500_cp  gn_082_xpr1        705           72
5   TPS_27500_cp  gn_121_xpr1          408             72   TPS_27500_cp  gn_121_xpr2        284           10
6   TPS_22500_cp  gn_029_xpr1          792             10   TPS_22500_cp  gn_029_xpr1         85           46

In [47]: path_data_new                                                                                                                    
Out[47]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   994     48  999      1
2   362      0  985      1
3   363    999   10     -1
4   654      0  999      1
5   664    308  999      1
6   489      0  707      1





######################### PATH_1015 k=17 #####################################


Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=17
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [55]: path_new                                                                                                                         
Out[55]: 
array([[  57, 1009],
       [  22,  994],
       [  54, 1041],
       [  34, 1097]])

In [56]: path_start_end_new                                                                                                               
Out[56]: 
array([[57, 22],
       [22, 54],
       [54, 34],
       [34, 38]])

In [57]: path_Cluster_new                                                                                                                 
Out[57]: [57, 22, 54, 34, 38]

In [58]: path_table_new                                                                                                                   
Out[58]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_222_xpr1          341             57   TPS_2500_cp_2  gn_222_xpr2        426           22
1   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
2   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
3  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [59]: path_data_new                                                                                                                    
Out[59]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   994     48  999      1
2  1041      0  973      1
3  1097      0  999      1



######################### PATH_1015 k=18 #####################################

Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 51
Cluster 51 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 714
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=18
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [65]: path_new                                                                                                                         
Out[65]: 
array([[  18,   28],
       [  54, 1055],
       [  70,  714]])

In [66]: path_start_end_new                                                                                                               
Out[66]: 
array([[18, 54],
       [54, 70],
       [70, 25]])

In [67]: path_Cluster_new                                                                                                                 
Out[67]: [18, 54, 70, 25]

In [68]: path_table_new                                                                                                                   
Out[68]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_199_xpr2          165             18     TPS_2500_cp  gn_199_xpr1        766           54
1  TPS_10000_cp_2  gn_010_xpr1          783             54  TPS_10000_cp_2  gn_010_xpr2        217           70
2       TPS_30000  gn_129_xpr2          499             70       TPS_30000  gn_129_xpr1        241           25

In [69]: path_data_new                                                                                                                    
Out[69]: 
   Traj  Start  End  Order
0    28    999   69     -1
1  1055      0  999      1
2   714      0  739      1



######################### PATH_1015 k=19 #####################################


Cluster 22 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 67
Cluster 67 sampled by Traj 691
Next Cluster 67
Cluster 67 sampled by Traj 695
Next Cluster 32
Cluster 32 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 10
Cluster 10 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 714
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=19
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [89]: path_new                                                                                                                         
Out[89]: 
array([[ 22, 995],
       [ 54, 208],
       [ 70, 714]])

In [90]: path_start_end_new                                                                                                               
Out[90]: 
array([[22, 54],
       [54, 70],
       [70, 25]])

In [91]: path_Cluster_new                                                                                                                 
Out[91]: [22, 54, 70, 25]

In [92]: path_table_new                                                                                                                   
Out[92]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1      TPS_12500  gn_011_xpr1          726             54      TPS_12500  gn_011_xpr2        217           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [93]: path_data_new                                                                                                                    
Out[93]: 
   Traj  Start  End  Order
0   995      0  965      1
1   208     57  999      1
2   714      0  739      1






######################### PATH_1015 k=20 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 55
Cluster 55 sampled by Traj 226
Next Cluster 55
Cluster 55 sampled by Traj 223
Next Cluster 55
Cluster 55 sampled by Traj 231
Next Cluster 24
Cluster 24 sampled by Traj 230
Next Cluster 24
Cluster 24 sampled by Traj 240
Next Cluster 24
Cluster 24 sampled by Traj 220
Next Cluster 24
Cluster 24 sampled by Traj 221
Next Cluster 62
Cluster 62 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 132
Next Cluster 68
Cluster 68 sampled by Traj 134
Next Cluster 68
Cluster 68 sampled by Traj 139
Next Cluster 68
Cluster 68 sampled by Traj 137
Next Cluster 1
Cluster 1 sampled by Traj 141
Next Cluster 1
Cluster 1 sampled by Traj 377
Next Cluster 1
Cluster 1 sampled by Traj 138
Next Cluster 1
Cluster 1 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 489
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=20
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [24]: path_new                                                                                                              
Out[24]: 
array([[ 17,   0],
       [ 54, 118],
       [  1, 117],
       [ 70, 489]])

In [25]: path_start_end_new                                                                                                    
Out[25]: 
array([[17, 54],
       [54,  1],
       [ 1, 70],
       [70, 46]])

In [26]: path_Cluster_new                                                                                                      
Out[26]: [17, 54, 1, 70, 46]

In [27]: path_table_new                                                                                                        
Out[27]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1      TPS_7500  gn_109_xpr2           29             54      TPS_7500  gn_109_xpr1        692            1
2      TPS_7500  gn_067_xpr1          637              1      TPS_7500  gn_067_xpr1          4           70
3  TPS_22500_cp  gn_029_xpr2          208             70  TPS_22500_cp  gn_029_xpr1        619           46

In [28]: path_data_new                                                                                                         
Out[28]: 
   Traj  Start  End  Order
0     0      0  945      1
1   118    279  999      1
2   117     44  677      1
3   489    999  173     -1




######################### PATH_1015 k=21 #####################################

Cluster 18 sampled by Traj 25
Next Cluster 40
Cluster 40 sampled by Traj 32
Next Cluster 40
Cluster 40 sampled by Traj 29
Next Cluster 18
Cluster 18 sampled by Traj 20
Next Cluster 18
Cluster 18 sampled by Traj 34
Next Cluster 18
Cluster 18 sampled by Traj 18
Next Cluster 74
Cluster 74 sampled by Traj 16
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 175
Next Cluster 39
Cluster 39 sampled by Traj 1063
Next Cluster 39
Cluster 39 sampled by Traj 1071
Next Cluster 52
Cluster 52 sampled by Traj 1072
Next Cluster 39
Cluster 39 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 72
Cluster 72 sampled by Traj 659
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 873
Next Cluster 59
Cluster 59 sampled by Traj 870
Next Cluster 59
Cluster 59 sampled by Traj 866
Next Cluster 10
Cluster 10 sampled by Traj 685
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 10
Cluster 10 sampled by Traj 691
Next Cluster 10
Cluster 10 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 489
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=21
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [39]: path_new                                                                                                              
Out[39]: 
array([[ 18,  28],
       [ 54, 362],
       [ 70, 662],
       [ 72, 665],
       [ 10, 489]])

In [40]: path_start_end_new                                                                                                    
Out[40]: 
array([[18, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 46]])

In [41]: path_Cluster_new                                                                                                      
Out[41]: [18, 54, 70, 72, 10, 46]

In [42]: path_table_new                                                                                                        
Out[42]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_199_xpr2          165             18   TPS_2500_cp  gn_199_xpr1        766           54
1  TPS_20000_cp  gn_030_xpr1          842             54  TPS_20000_cp  gn_030_xpr1        807           70
2  TPS_27500_cp  gn_108_xpr1           40             70  TPS_27500_cp  gn_108_xpr1         25           72
3  TPS_27500_cp  gn_125_xpr2          190             72  TPS_27500_cp  gn_125_xpr1        671           10
4  TPS_22500_cp  gn_029_xpr1          792             10  TPS_22500_cp  gn_029_xpr1         85           46

In [43]: path_data_new                                                                                                         
Out[43]: 
   Traj  Start  End  Order
0    28    999   69     -1
1   362      0   35      1
2   662    268  283      1
3   665    139  999      1
4   489      0  707      1






######################### PATH_1015 k=22 #####################################



In [46]: path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)                             
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 55
Cluster 55 sampled by Traj 240
Next Cluster 55
Cluster 55 sampled by Traj 231
Next Cluster 55
Cluster 55 sampled by Traj 222
Next Cluster 24
Cluster 24 sampled by Traj 223
Next Cluster 24
Cluster 24 sampled by Traj 230
Next Cluster 24
Cluster 24 sampled by Traj 221
Next Cluster 24
Cluster 24 sampled by Traj 226
Next Cluster 55
Cluster 55 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 1084
Next Cluster 34
Cluster 34 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1095
Next Cluster 34
Cluster 34 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 70
Cluster 70 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=22
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [48]: path_new                                                                                                              
Out[48]: 
array([[ 17,   0],
       [ 54, 175],
       [ 55, 213],
       [ 70, 489]])

In [49]: path_start_end_new                                                                                                    
Out[49]: 
array([[17, 54],
       [54, 55],
       [55, 70],
       [70, 46]])

In [50]: path_Cluster_new                                                                                                      
Out[50]: [17, 54, 55, 70, 46]

In [51]: path_table_new                                                                                                        
Out[51]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1     TPS_10000  gn_308_xpr2          730             54     TPS_10000  gn_308_xpr2        729           55
2     TPS_12500  gn_088_xpr2           86             55     TPS_12500  gn_088_xpr1        204           70
3  TPS_22500_cp  gn_029_xpr2          208             70  TPS_22500_cp  gn_029_xpr1        619           46

In [52]: path_data_new                                                                                                         
Out[52]: 
   Traj  Start  End  Order
0     0      0  945      1
1   175    840  839     -1
2   213    289    0     -1
3   489    999  173     -1



######################### PATH_1015 k=22 #####################################


Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 490
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=22
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [56]: path_new                                                                                                              
Out[56]: 
array([[  57, 1009],
       [  22,  994],
       [  54, 1031],
       [  70,  252],
       [  51,  251],
       [  70,  490]])

In [57]: path_start_end_new                                                                                                    
Out[57]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 51],
       [51, 70],
       [70, 46]])

In [58]: path_Cluster_new                                                                                                      
Out[58]: [57, 22, 54, 70, 51, 70, 46]

In [59]: path_table_new                                                                                                        
Out[59]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_222_xpr1          341             57  TPS_2500_cp_2  gn_222_xpr2        426           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_5000_cp_2  gn_066_xpr2          349             54  TPS_5000_cp_2  gn_066_xpr1        138           70
3   TPS_15000_cp  gn_530_xpr1          349             70   TPS_15000_cp  gn_530_xpr2        256           51
4   TPS_15000_cp  gn_528_xpr1          649             51   TPS_15000_cp  gn_528_xpr1         52           70
5   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [60]: path_data_new                                                                                                         
Out[60]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   994     48  999      1
2  1031      0  486      1
3   252    604    0     -1
4   251    247  844      1
5   490    356  999      1




######################### PATH_1015 k=23 #####################################


Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 691
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=23
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [65]: path_new                                                                                                              
Out[65]: 
array([[  57, 1009],
       [  22,  994],
       [  54, 1031],
       [  70,  252],
       [  51,  251],
       [  70,  490]])

In [66]: path_start_end_new                                                                                                    
Out[66]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 51],
       [51, 70],
       [70, 46]])

In [67]: path_Cluster_new                                                                                                      
Out[67]: [57, 22, 54, 70, 51, 70, 46]

In [68]: path_table_new                                                                                                        
Out[68]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_222_xpr1          341             57  TPS_2500_cp_2  gn_222_xpr2        426           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_5000_cp_2  gn_066_xpr2          349             54  TPS_5000_cp_2  gn_066_xpr1        138           70
3   TPS_15000_cp  gn_530_xpr1          349             70   TPS_15000_cp  gn_530_xpr2        256           51
4   TPS_15000_cp  gn_528_xpr1          649             51   TPS_15000_cp  gn_528_xpr1         52           70
5   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [69]: path_data_new                                                                                                         
Out[69]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   994     48  999      1
2  1031      0  486      1
3   252    604    0     -1
4   251    247  844      1
5   490    356  999      1





######################### PATH_1015 k=24 #####################################

Cluster 18 sampled by Traj 20
Next Cluster 18
Cluster 18 sampled by Traj 18
Next Cluster 74
Cluster 74 sampled by Traj 16
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 10
Cluster 10 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 684
Next Cluster 32
Cluster 32 sampled by Traj 685
Next Cluster 10
Cluster 10 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 691
Next Cluster 67
Cluster 67 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 867
Next Cluster 10
Cluster 10 sampled by Traj 870
Next Cluster 10
Cluster 10 sampled by Traj 873
Next Cluster 59
Cluster 59 sampled by Traj 871
Next Cluster 59
Cluster 59 sampled by Traj 883
Next Cluster 59
Cluster 59 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 941
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=24
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [74]: path_new                                                                                                              
Out[74]: 
array([[  18,   18],
       [  74,    6],
       [  17,    0],
       [  54, 1033],
       [  70,  654],
       [  72,  661],
       [  10,  941]])

In [75]: path_start_end_new                                                                                                    
Out[75]: 
array([[18, 74],
       [74, 17],
       [17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [76]: path_Cluster_new                                                                                                      
Out[76]: [18, 74, 17, 54, 70, 72, 10, 48]

In [77]: path_table_new                                                                                                        
Out[77]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_165_xpr2          499             18    TPS_2500_cp  gn_165_xpr1        487           74
1    TPS_2500_cp  gn_037_xpr1          478             74    TPS_2500_cp  gn_037_xpr2        251           17
2    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
3  TPS_5000_cp_2  gn_105_xpr1          549             54  TPS_5000_cp_2  gn_105_xpr2        141           70
4   TPS_27500_cp  gn_082_xpr2          295             70   TPS_27500_cp  gn_082_xpr1        705           72
5   TPS_27500_cp  gn_105_xpr1           96             72   TPS_27500_cp  gn_105_xpr2        757           10
6   TPS_37500_cp  gn_207_xpr1           29             10   TPS_37500_cp  gn_207_xpr1        651           48

In [78]: path_data_new                                                                                                         
Out[78]: 
   Traj  Start  End  Order
0    18      0  985      1
1     6    999  271     -1
2     0      0  945      1
3  1033    999  310     -1
4   654      0  999      1
5   661    852    0     -1
6   941    622    0     -1





######################### PATH_1015 k=25 #####################################



Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 870
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 660
Next Cluster 72
Cluster 72 sampled by Traj 659
Next Cluster 72
Cluster 72 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 489
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=25
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [163]: path_new                                                                                                             
Out[163]: 
array([[  22,  995],
       [  54, 1041],
       [  34, 1084],
       [  70,  489],
       [  10,  941]])

In [164]: path_start_end_new                                                                                                   
Out[164]: 
array([[22, 54],
       [54, 34],
       [34, 70],
       [70, 10],
       [10, 48]])

In [165]: path_Cluster_new                                                                                                     
Out[165]: [22, 54, 34, 70, 10, 48]

In [166]: path_table_new                                                                                                       
Out[166]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_087_xpr2          506             34  TPS_12500_cp_2  gn_087_xpr1        357           70
3    TPS_22500_cp  gn_029_xpr2          208             70    TPS_22500_cp  gn_029_xpr1        792           10
4    TPS_37500_cp  gn_207_xpr1           29             10    TPS_37500_cp  gn_207_xpr1        651           48

In [167]: path_data_new                                                                                                        
Out[167]: 
   Traj  Start  End  Order
0   995      0  965      1
1  1041      0  973      1
2  1084      0  862      1
3   489    999    0     -1
4   941    622    0     -1




######################### PATH_1015 k=26 #####################################



Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 272
Next Cluster 50
Cluster 50 sampled by Traj 279
Next Cluster 53
Cluster 53 sampled by Traj 346
Next Cluster 2
Cluster 2 sampled by Traj 293
Next Cluster 31
Cluster 31 sampled by Traj 341
Next Cluster 31
Cluster 31 sampled by Traj 304
Next Cluster 31
Cluster 31 sampled by Traj 343
Next Cluster 53
Cluster 53 sampled by Traj 328
Next Cluster 53
Cluster 53 sampled by Traj 319
Next Cluster 53
Cluster 53 sampled by Traj 321
Next Cluster 53
Cluster 53 sampled by Traj 335
Next Cluster 2
Cluster 2 sampled by Traj 356
Next Cluster 26
Cluster 26 sampled by Traj 349
Next Cluster 31
Cluster 31 sampled by Traj 329
Next Cluster 31
Cluster 31 sampled by Traj 327
Next Cluster 53
Cluster 53 sampled by Traj 289
Next Cluster 53
Cluster 53 sampled by Traj 288
Next Cluster 31
Cluster 31 sampled by Traj 357
Next Cluster 53
Cluster 53 sampled by Traj 830
Next Cluster 44
Cluster 44 sampled by Traj 822
Next Cluster 10
Cluster 10 sampled by Traj 866
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 10
Cluster 10 sampled by Traj 870
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 685
Next Cluster 10
Cluster 10 sampled by Traj 868
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 59
Cluster 59 sampled by Traj 867
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=26
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [191]: path_new                                                                                                             
Out[191]: 
array([[  57, 1009],
       [  22,  994],
       [  54,  367],
       [  71, 1171],
       [  70,  272],
       [  50,  279],
       [  53,  830],
       [  44,  822],
       [  10,  940]])

In [192]: path_start_end_new                                                                                                   
Out[192]: 
array([[57, 22],
       [22, 54],
       [54, 71],
       [71, 70],
       [70, 50],
       [50, 53],
       [53, 44],
       [44, 10],
       [10, 48]])

In [193]: path_Cluster_new                                                                                                     
Out[193]: [57, 22, 54, 71, 70, 50, 53, 44, 10, 48]

In [194]: path_table_new                                                                                                       
Out[194]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_222_xpr1          341             57   TPS_2500_cp_2  gn_222_xpr2        426           22
1   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
2    TPS_20000_cp  gn_073_xpr1          888             54    TPS_20000_cp  gn_073_xpr2         62           71
3  TPS_20000_cp_2  gn_060_xpr1          524             71  TPS_20000_cp_2  gn_060_xpr2         24           70
4    TPS_17500_cp  gn_079_xpr2           87             70    TPS_17500_cp  gn_079_xpr1        913           50
5    TPS_17500_cp  gn_138_xpr1          345             50    TPS_17500_cp  gn_138_xpr2        296           53
6    TPS_35000_cp  gn_112_xpr2          802             53    TPS_35000_cp  gn_112_xpr1        198           44
7    TPS_35000_cp  gn_093_xpr2          499             44    TPS_35000_cp  gn_093_xpr1        501           10
8    TPS_37500_cp  gn_204_xpr1           96             10    TPS_37500_cp  gn_204_xpr2        904           48

In [195]: path_data_new                                                                                                        
Out[195]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   994     48  999      1
2   367     50  999      1
3  1171     35  582      1
4   272    999    0     -1
5   279    999  359     -1
6   830    999    0     -1
7   822      0  999      1
8   940    999    0     -1






######################### PATH_1015 k=27 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 659
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 58
Cluster 58 sampled by Traj 854
Next Cluster 63
Cluster 63 sampled by Traj 849
Next Cluster 44
Cluster 44 sampled by Traj 822
Next Cluster 10
Cluster 10 sampled by Traj 873
Next Cluster 59
Cluster 59 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 868
Next Cluster 59
Cluster 59 sampled by Traj 867
Next Cluster 10
Cluster 10 sampled by Traj 664
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=27
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [260]: path_new                                                                                                             
Out[260]: 
array([[ 17,   0],
       [ 70, 662],
       [ 72, 659],
       [ 10, 940]])

In [261]: path_start_end_new                                                                                                   
Out[261]: 
array([[17, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [262]: path_Cluster_new                                                                                                     
Out[262]: [17, 70, 72, 10, 48]

In [263]: path_table_new                                                                                                       
Out[263]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_27500_cp  gn_108_xpr1           40             70  TPS_27500_cp  gn_108_xpr1         25           72
2  TPS_27500_cp  gn_102_xpr1          227             72  TPS_27500_cp  gn_102_xpr2        773           10
3  TPS_37500_cp  gn_204_xpr1           96             10  TPS_37500_cp  gn_204_xpr2        904           48

In [264]: path_data_new                                                                                                        
Out[264]: 
   Traj  Start  End  Order
0     0      0  501      1
1   662    268  283      1
2   659    999    0     -1
3   940    999    0     -1




######################### PATH_1015 k=28 #####################################


Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=28
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)




In [306]: path_new                                                                                                             
Out[306]: 
array([[ 22, 995],
       [ 54, 271],
       [ 70, 662],
       [ 10, 940]])

In [307]: path_start_end_new                                                                                                   
Out[307]: 
array([[22, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [308]: path_Cluster_new                                                                                                     
Out[308]: [22, 54, 70, 10, 48]

In [309]: path_table_new                                                                                                       
Out[309]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1   TPS_17500_cp  gn_064_xpr1          363             54   TPS_17500_cp  gn_064_xpr2        204           70
2   TPS_27500_cp  gn_108_xpr1           40             70   TPS_27500_cp  gn_108_xpr2        671           10
3   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [310]: path_data_new                                                                                                        
Out[310]: 
   Traj  Start  End  Order
0   995      0  965      1
1   271    433  999      1
2   662    268  978      1
3   940    999    0     -1




######################### PATH_1015 k=29 #####################################



Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 67
Cluster 67 sampled by Traj 691
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=29
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [396]: path_new                                                                                                             
Out[396]: 
array([[  57, 1007],
       [  22,  994],
       [  54, 1038],
       [  70,  662],
       [  10,  940]])

In [397]: path_start_end_new                                                                                                   
Out[397]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [398]: path_Cluster_new                                                                                                     
Out[398]: [57, 22, 54, 70, 10, 48]

In [399]: path_table_new                                                                                                       
Out[399]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_219_xpr2          836             57  TPS_2500_cp_2  gn_219_xpr1        159           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_7500_cp_2  gn_014_xpr1          849             54  TPS_7500_cp_2  gn_014_xpr2         33           70
3   TPS_27500_cp  gn_108_xpr1           40             70   TPS_27500_cp  gn_108_xpr2        671           10
4   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [400]: path_data_new                                                                                                        
Out[400]: 
   Traj  Start  End  Order
0  1007      5  999      1
1   994     48  999      1
2  1038      0  881      1
3   662    268  978      1
4   940    999    0     -1




######################### PATH_1015 k=30 #####################################


Cluster 18 sampled by Traj 30
Next Cluster 40
Cluster 40 sampled by Traj 36
Next Cluster 40
Cluster 40 sampled by Traj 34
Next Cluster 40
Cluster 40 sampled by Traj 32
Next Cluster 56
Cluster 56 sampled by Traj 64
Next Cluster 56
Cluster 56 sampled by Traj 49
Next Cluster 56
Cluster 56 sampled by Traj 47
Next Cluster 21
Cluster 21 sampled by Traj 48
Next Cluster 21
Cluster 21 sampled by Traj 63
Next Cluster 21
Cluster 21 sampled by Traj 33
Next Cluster 40
Cluster 40 sampled by Traj 25
Next Cluster 40
Cluster 40 sampled by Traj 38
Next Cluster 56
Cluster 56 sampled by Traj 61
Next Cluster 21
Cluster 21 sampled by Traj 46
Next Cluster 56
Cluster 56 sampled by Traj 62
Next Cluster 21
Cluster 21 sampled by Traj 45
Next Cluster 21
Cluster 21 sampled by Traj 50
Next Cluster 21
Cluster 21 sampled by Traj 75
Next Cluster 56
Cluster 56 sampled by Traj 44
Next Cluster 56
Cluster 56 sampled by Traj 35
Next Cluster 40
Cluster 40 sampled by Traj 29
Next Cluster 40
Cluster 40 sampled by Traj 20
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 43
Cluster 43 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 59
Cluster 59 sampled by Traj 866
Next Cluster 59
Cluster 59 sampled by Traj 873
Next Cluster 10
Cluster 10 sampled by Traj 661
Next Cluster 10
Cluster 10 sampled by Traj 941
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=30
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [403]: path_new                                                                                                             
Out[403]: 
array([[  18,   28],
       [  54, 1133],
       [  70,  808],
       [  43,  812],
       [  10,  941]])

In [404]: path_start_end_new                                                                                                   
Out[404]: 
array([[18, 54],
       [54, 70],
       [70, 43],
       [43, 10],
       [10, 48]])

In [405]: path_Cluster_new                                                                                                     
Out[405]: [18, 54, 70, 43, 10, 48]

In [406]: path_table_new                                                                                                       
Out[406]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_199_xpr2          165             18     TPS_2500_cp  gn_199_xpr1        766           54
1  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
2    TPS_35000_cp  gn_049_xpr2          301             70    TPS_35000_cp  gn_049_xpr1        699           43
3    TPS_35000_cp  gn_072_xpr1          394             43    TPS_35000_cp  gn_072_xpr2        606           10
4    TPS_37500_cp  gn_207_xpr1           29             10    TPS_37500_cp  gn_207_xpr1        651           48

In [407]: path_data_new                                                                                                        
Out[407]: 
   Traj  Start  End  Order
0    28    999   69     -1
1  1133    607    0     -1
2   808    999    0     -1
3   812    999    0     -1
4   941    622    0     -1




######################### PATH_1015 k=30 #####################################

Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 39
Cluster 39 sampled by Traj 175
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 1063
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1121
Next Cluster 38
Cluster 38 sampled by Traj 1095
Next Cluster 34
Cluster 34 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 43
Cluster 43 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=30
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [415]: path_new                                                                                                             
Out[415]: 
array([[  22,  994],
       [  54, 1056],
       [  70, 1083],
       [  34,  158],
       [  70,  808],
       [  43,  812],
       [  10,  941]])

In [416]: path_start_end_new                                                                                                   
Out[416]: 
array([[22, 54],
       [54, 70],
       [70, 34],
       [34, 70],
       [70, 43],
       [43, 10],
       [10, 48]])

In [417]: path_Cluster_new                                                                                                     
Out[417]: [22, 54, 70, 34, 70, 43, 10, 48]

In [418]: path_table_new                                                                                                       
Out[418]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_10000_cp_2  gn_058_xpr1          323             54  TPS_10000_cp_2  gn_058_xpr2        327           70
2  TPS_12500_cp_2  gn_046_xpr2          221             70  TPS_12500_cp_2  gn_046_xpr1        779           34
3       TPS_10000  gn_158_xpr1          754             34       TPS_10000  gn_158_xpr2         54           70
4    TPS_35000_cp  gn_049_xpr2          301             70    TPS_35000_cp  gn_049_xpr1        699           43
5    TPS_35000_cp  gn_072_xpr1          394             43    TPS_35000_cp  gn_072_xpr2        606           10
6    TPS_37500_cp  gn_207_xpr1           29             10    TPS_37500_cp  gn_207_xpr1        651           48

In [419]: path_data_new                                                                                                        
Out[419]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1056    350  999      1
2  1083      0  999      1
3   158    161  968      1
4   808    999    0     -1
5   812    999    0     -1
6   941    622    0     -1



######################### PATH_1015 k=31 #####################################


Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 187
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 489
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 715
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 866
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 59
Cluster 59 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 941
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=31
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [428]: path_new                                                                                                             
Out[428]: 
array([[  22,  994],
       [  54, 1039],
       [  70,  662],
       [  72,  664],
       [  10,  871],
       [  59,  869],
       [  10,  941]])

In [429]: path_start_end_new                                                                                                   
Out[429]: 
array([[22, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 59],
       [59, 10],
       [10, 48]])

In [430]: path_Cluster_new                                                                                                     
Out[430]: [22, 54, 70, 72, 10, 59, 10, 48]

In [431]: path_table_new                                                                                                       
Out[431]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
2   TPS_27500_cp  gn_108_xpr1           40             70   TPS_27500_cp  gn_108_xpr1         25           72
3   TPS_27500_cp  gn_121_xpr1          408             72   TPS_27500_cp  gn_121_xpr2        284           10
4   TPS_35000_cp  gn_192_xpr1          157             10   TPS_35000_cp  gn_192_xpr2        639           59
5   TPS_35000_cp  gn_188_xpr1          409             59   TPS_35000_cp  gn_188_xpr2        499           10
6   TPS_37500_cp  gn_207_xpr1           29             10   TPS_37500_cp  gn_207_xpr1        651           48

In [432]: path_data_new                                                                                                        
Out[432]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1039    999    0     -1
2   662    268  283      1
3   664    308  999      1
4   871    795    0     -1
5   869     92  999      1
6   941    622    0     -1



######################### PATH_1015 k=32 #####################################


Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 714
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 168
Next Cluster 69
Cluster 69 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 363
Next Cluster 71
Cluster 71 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 941
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=32
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [484]: path_new                                                                                                             
Out[484]: 
array([[  22,  995],
       [  54, 1029],
       [  70,  662],
       [  10,  941]])

In [485]: path_start_end_new                                                                                                   
Out[485]: 
array([[22, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [486]: path_Cluster_new                                                                                                     
Out[486]: [22, 54, 70, 10, 48]

In [487]: path_table_new                                                                                                       
Out[487]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1  TPS_5000_cp_2  gn_011_xpr1          752             54  TPS_5000_cp_2  gn_011_xpr2         19           70
2   TPS_27500_cp  gn_108_xpr1           40             70   TPS_27500_cp  gn_108_xpr2        671           10
3   TPS_37500_cp  gn_207_xpr1           29             10   TPS_37500_cp  gn_207_xpr1        651           48

In [488]: path_data_new                                                                                                        
Out[488]: 
   Traj  Start  End  Order
0   995      0  965      1
1  1029      0  770      1
2   662    268  978      1
3   941    622    0     -1




######################### PATH_1015 k=33 #####################################


Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=33
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [498]: path_new                                                                                                             
Out[498]: 
array([[  22,  994],
       [  54, 1039],
       [  70,  662],
       [  72,  660],
       [  10,  940]])

In [499]: path_start_end_new                                                                                                   
Out[499]: 
array([[22, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [500]: path_Cluster_new                                                                                                     
Out[500]: [22, 54, 70, 72, 10, 48]

In [501]: path_table_new                                                                                                       
Out[501]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
2   TPS_27500_cp  gn_108_xpr1           40             70   TPS_27500_cp  gn_108_xpr1         25           72
3   TPS_27500_cp  gn_103_xpr1          141             72   TPS_27500_cp  gn_103_xpr2        295           10
4   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [502]: path_data_new                                                                                                        
Out[502]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1039    999    0     -1
2   662    268  283      1
3   660    392  827      1
4   940    999    0     -1



######################### PATH_1015 k=34 #####################################


Cluster 40 sampled by Traj 39
Next Cluster 56
Cluster 56 sampled by Traj 38
Next Cluster 56
Cluster 56 sampled by Traj 33
Next Cluster 40
Cluster 40 sampled by Traj 20
Next Cluster 18
Cluster 18 sampled by Traj 25
Next Cluster 40
Cluster 40 sampled by Traj 29
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 16
Cluster 16 sampled by Traj 1142
Next Cluster 16
Cluster 16 sampled by Traj 1166
Next Cluster 36
Cluster 36 sampled by Traj 1149
Next Cluster 36
Cluster 36 sampled by Traj 1150
Next Cluster 16
Cluster 16 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=34
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [538]: path_new                                                                                                             
Out[538]: 
array([[  40,   29],
       [  18,   28],
       [  54, 1133],
       [  70,  272],
       [  71, 1171],
       [  70, 1136],
       [  16, 1134],
       [  70,  930],
       [  10,  940]])

In [539]: path_start_end_new                                                                                                   
Out[539]: 
array([[40, 18],
       [18, 54],
       [54, 70],
       [70, 71],
       [71, 70],
       [70, 16],
       [16, 70],
       [70, 10],
       [10, 48]])

In [540]: path_Cluster_new                                                                                                     
Out[540]: [40, 18, 54, 70, 71, 70, 16, 70, 10, 48]

In [541]: path_table_new                                                                                                       
Out[541]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_202_xpr2          175             40     TPS_2500_cp  gn_202_xpr1        764           18
1     TPS_2500_cp  gn_199_xpr2          165             18     TPS_2500_cp  gn_199_xpr1        766           54
2  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
3    TPS_17500_cp  gn_079_xpr2           87             70    TPS_17500_cp  gn_079_xpr1        334           71
4  TPS_20000_cp_2  gn_060_xpr1          524             71  TPS_20000_cp_2  gn_060_xpr2         24           70
5  TPS_17500_cp_2  gn_045_xpr2          380             70  TPS_17500_cp_2  gn_045_xpr1        467           16
6  TPS_17500_cp_2  gn_019_xpr1          751             16  TPS_17500_cp_2  gn_019_xpr2        140           70
7    TPS_37500_cp  gn_090_xpr1          185             70    TPS_37500_cp  gn_090_xpr2        815           10
8    TPS_37500_cp  gn_204_xpr1           96             10    TPS_37500_cp  gn_204_xpr2        904           48

In [542]: path_data_new                                                                                                        
Out[542]: 
   Traj  Start  End  Order
0    29     61  999      1
1    28    999   69     -1
2  1133    607    0     -1
3   272    999  579     -1
4  1171     35  582      1
5  1136    846    0     -1
6  1134    109  999      1
7   930    999    0     -1
8   940    999    0     -1




######################### PATH_1015 k=36 #####################################



Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 822
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 10
Cluster 10 sampled by Traj 664
Next Cluster 72
Cluster 72 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=36
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)




In [545]: path_new                                                                                                             
Out[545]: 
array([[  57, 1009],
       [  22,  994],
       [  54, 1133],
       [  70,  930],
       [  10,  940]])

In [546]: path_start_end_new                                                                                                   
Out[546]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [547]: path_Cluster_new                                                                                                     
Out[547]: [57, 22, 54, 70, 10, 48]

In [548]: path_table_new                                                                                                       
Out[548]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_222_xpr1          341             57   TPS_2500_cp_2  gn_222_xpr2        426           22
1   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
3    TPS_37500_cp  gn_090_xpr1          185             70    TPS_37500_cp  gn_090_xpr2        815           10
4    TPS_37500_cp  gn_204_xpr1           96             10    TPS_37500_cp  gn_204_xpr2        904           48

In [549]: path_data_new                                                                                                        
Out[549]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   994     48  999      1
2  1133    607    0     -1
3   930    999    0     -1
4   940    999    0     -1



######################### PATH_1015 k=37 #####################################


Cluster 18 sampled by Traj 16
Next Cluster 74
Cluster 74 sampled by Traj 18
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 372
Next Cluster 71
Cluster 71 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 940
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=37
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [559]: path_new                                                                                                             
Out[559]: 
array([[  18,   16],
       [  74,    6],
       [  17,    0],
       [  54, 1038],
       [  70,  662],
       [  72,  664],
       [  10,  940]])

In [560]: path_start_end_new                                                                                                   
Out[560]: 
array([[18, 74],
       [74, 17],
       [17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [561]: path_Cluster_new                                                                                                     
Out[561]: [18, 74, 17, 54, 70, 72, 10, 48]

In [562]: path_table_new                                                                                                       
Out[562]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_119_xpr1          900             18    TPS_2500_cp  gn_119_xpr2        100           74
1    TPS_2500_cp  gn_037_xpr1          478             74    TPS_2500_cp  gn_037_xpr2        251           17
2    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
3  TPS_7500_cp_2  gn_014_xpr1          849             54  TPS_7500_cp_2  gn_014_xpr2         33           70
4   TPS_27500_cp  gn_108_xpr1           40             70   TPS_27500_cp  gn_108_xpr1         25           72
5   TPS_27500_cp  gn_121_xpr1          408             72   TPS_27500_cp  gn_121_xpr2        284           10
6   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [563]: path_data_new                                                                                                        
Out[563]: 
   Traj  Start  End  Order
0    16      0  999      1
1     6    999  271     -1
2     0      0  945      1
3  1038      0  881      1
4   662    268  283      1
5   664    308  999      1
6   940    999    0     -1




######################### PATH_1015 k=38 #####################################


Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 59
Cluster 59 sampled by Traj 870
Next Cluster 10
Cluster 10 sampled by Traj 659
Next Cluster 10
Cluster 10 sampled by Traj 685
Next Cluster 10
Cluster 10 sampled by Traj 661
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 691
Next Cluster 67
Cluster 67 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 868
Next Cluster 59
Cluster 59 sampled by Traj 873
Next Cluster 59
Cluster 59 sampled by Traj 867
Next Cluster 59
Cluster 59 sampled by Traj 882
Next Cluster 59
Cluster 59 sampled by Traj 866
Next Cluster 10
Cluster 10 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 660
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=38
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [628]: path_new                                                                                                             
Out[628]: 
array([[  57, 1011],
       [  22,  994],
       [  54, 1038],
       [  70,  651],
       [  72,  662],
       [  10,  941]])

In [629]: path_start_end_new                                                                                                   
Out[629]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [630]: path_Cluster_new                                                                                                     
Out[630]: [57, 22, 54, 70, 72, 10, 48]

In [631]: path_table_new                                                                                                       
Out[631]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_226_xpr2          934             57  TPS_2500_cp_2  gn_226_xpr2         45           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_7500_cp_2  gn_014_xpr1          849             54  TPS_7500_cp_2  gn_014_xpr2         33           70
3   TPS_27500_cp  gn_076_xpr1          635             70   TPS_27500_cp  gn_076_xpr2        354           72
4   TPS_27500_cp  gn_108_xpr1           37             72   TPS_27500_cp  gn_108_xpr2        671           10
5   TPS_37500_cp  gn_207_xpr1           29             10   TPS_37500_cp  gn_207_xpr1        651           48

In [632]: path_data_new                                                                                                        
Out[632]: 
   Traj  Start  End  Order
0  1011      0  889      1
1   994     48  999      1
2  1038      0  881      1
3   651     11  999      1
4   662    271  978      1
5   941    622    0     -1



######################### PATH_1015 k=39 #####################################


Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 873
Next Cluster 10
Cluster 10 sampled by Traj 866
Next Cluster 10
Cluster 10 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 59
Cluster 59 sampled by Traj 868
Next Cluster 10
Cluster 10 sampled by Traj 685
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=39
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)




In [698]: path_new                                                                                                             
Out[698]: 
array([[  17,    0],
       [  54, 1033],
       [  70,  651],
       [  72,  665],
       [  10,  940]])

In [699]: path_start_end_new                                                                                                   
Out[699]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [700]: path_Cluster_new                                                                                                     
Out[700]: [17, 54, 70, 72, 10, 48]

In [701]: path_table_new                                                                                                       
Out[701]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_5000_cp_2  gn_105_xpr1          549             54  TPS_5000_cp_2  gn_105_xpr2        141           70
2   TPS_27500_cp  gn_076_xpr1          635             70   TPS_27500_cp  gn_076_xpr2        354           72
3   TPS_27500_cp  gn_125_xpr2          190             72   TPS_27500_cp  gn_125_xpr1        671           10
4   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [702]: path_data_new                                                                                                        
Out[702]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1033    999  310     -1
2   651     11  999      1
3   665    139  999      1
4   940    999    0     -1




######################### PATH_1015 k=40 #####################################

Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 1134
Next Cluster 16
Cluster 16 sampled by Traj 1166
Next Cluster 16
Cluster 16 sampled by Traj 1149
Next Cluster 16
Cluster 16 sampled by Traj 1150
Next Cluster 36
Cluster 36 sampled by Traj 1142
Next Cluster 16
Cluster 16 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 27
Cluster 27 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 72
Cluster 72 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 659
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=40
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [713]: path_new                                                                                                             
Out[713]: 
array([[  57, 1007],
       [  22,  994],
       [  54,    0],
       [  70, 1134],
       [  16, 1136],
       [  70,  482],
       [  27, 1170],
       [  70,  651],
       [  72,  659],
       [  10,  941]])

In [714]: path_start_end_new                                                                                                   
Out[714]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 16],
       [16, 70],
       [70, 27],
       [27, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [715]: path_Cluster_new                                                                                                     
Out[715]: [57, 22, 54, 70, 16, 70, 27, 70, 72, 10, 48]

In [716]: path_table_new                                                                                                       
Out[716]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_219_xpr2          836             57   TPS_2500_cp_2  gn_219_xpr1        159           22
1   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
2     TPS_2500_cp  gn_017_xpr2          274             54     TPS_2500_cp  gn_017_xpr1        171           70
3  TPS_17500_cp_2  gn_019_xpr2          140             70  TPS_17500_cp_2  gn_019_xpr1        751           16
4  TPS_17500_cp_2  gn_045_xpr1          467             16  TPS_17500_cp_2  gn_045_xpr2        380           70
5    TPS_22500_cp  gn_005_xpr1          556             70    TPS_22500_cp  gn_005_xpr2        437           27
6  TPS_20000_cp_2  gn_044_xpr2          435             27  TPS_20000_cp_2  gn_044_xpr1        536           70
7    TPS_27500_cp  gn_076_xpr1          635             70    TPS_27500_cp  gn_076_xpr2        354           72
8    TPS_27500_cp  gn_102_xpr1          227             72    TPS_27500_cp  gn_102_xpr2        773           10
9    TPS_37500_cp  gn_207_xpr1           29             10    TPS_37500_cp  gn_207_xpr1        651           48

In [717]: path_data_new                                                                                                        
Out[717]: 
   Traj  Start  End  Order
0  1007      5  999      1
1   994     48  999      1
2     0    945  501     -1
3  1134    999  109     -1
4  1136      0  846      1
5   482      0  992      1
6  1170     29  999      1
7   651     11  999      1
8   659    999    0     -1
9   941    622    0     -1




######################### PATH_1015 k=41 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 1170
Next Cluster 27
Cluster 27 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=41
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [723]: path_new                                                                                                             
Out[723]: 
array([[  17,    0],
       [  54, 1133],
       [  70,  662],
       [  10,  940]])

In [724]: path_start_end_new                                                                                                   
Out[724]: 
array([[17, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [725]: path_Cluster_new                                                                                                     
Out[725]: [17, 54, 70, 10, 48]

In [726]: path_table_new                                                                                                       
Out[726]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
2    TPS_27500_cp  gn_108_xpr1           40             70    TPS_27500_cp  gn_108_xpr2        671           10
3    TPS_37500_cp  gn_204_xpr1           96             10    TPS_37500_cp  gn_204_xpr2        904           48

In [727]: path_data_new                                                                                                        
Out[727]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1133    607    0     -1
2   662    268  978      1
3   940    999    0     -1




######################### PATH_1015 k=42 #####################################


Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 70
Cluster 70 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 714
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 70

Cluster 70 sampled by Traj 361
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 372
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 42
Cluster 42 sampled by Traj 1179
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=42
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [759]: path_new                                                                                                             
Out[759]: 
array([[  57, 1007],
       [  22,  995],
       [  54, 1039],
       [  70,  490]])

In [760]: path_start_end_new                                                                                                   
Out[760]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [761]: path_Cluster_new                                                                                                     
Out[761]: [57, 22, 54, 70, 46]

In [762]: path_table_new                                                                                                       
Out[762]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_219_xpr2          836             57  TPS_2500_cp_2  gn_219_xpr1        159           22
1  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
2  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
3   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [763]: path_data_new                                                                                                        
Out[763]: 
   Traj  Start  End  Order
0  1007      5  999      1
1   995      0  965      1
2  1039    999    0     -1
3   490    356  999      1





######################### PATH_1015 k=43 #####################################

Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=43
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [768]: path_new                                                                                                             
Out[768]: 
array([[  57, 1009],
       [  22,  995],
       [  54,  175],
       [  69,  160],
       [   5,  158],
       [  70,  490]])

In [769]: path_start_end_new                                                                                                   
Out[769]: 
array([[57, 22],
       [22, 54],
       [54, 69],
       [69,  5],
       [ 5, 70],
       [70, 46]])

In [770]: path_Cluster_new                                                                                                     
Out[770]: [57, 22, 54, 69, 5, 70, 46]

In [771]: path_table_new                                                                                                       
Out[771]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_222_xpr1          341             57  TPS_2500_cp_2  gn_222_xpr2        426           22
1  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
2      TPS_10000  gn_308_xpr2          730             54      TPS_10000  gn_308_xpr1        111           69
3      TPS_10000  gn_178_xpr1          410             69      TPS_10000  gn_178_xpr2        249            5
4      TPS_10000  gn_158_xpr2           85              5      TPS_10000  gn_158_xpr1        743           70
5   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [772]: path_data_new                                                                                                        
Out[772]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   995      0  965      1
2   175    840    0     -1
3   160    341  999      1
4   158    999  172     -1
5   490    356  999      1




######################### PATH_1015 k=44 #####################################

Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=44
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)




In [780]: path_new                                                                                                             
Out[780]: 
array([[  17,    0],
       [  54, 1033],
       [  70,  490]])

In [781]: path_start_end_new                                                                                                   
Out[781]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [782]: path_Cluster_new                                                                                                     
Out[782]: [17, 54, 70, 46]

In [783]: path_table_new                                                                                                       
Out[783]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_5000_cp_2  gn_105_xpr1          549             54  TPS_5000_cp_2  gn_105_xpr2        141           70
2   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [784]: path_data_new                                                                                                        
Out[784]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1033    999  310     -1
2   490    356  999      1





######################### PATH_1015 k=45 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 372
Next Cluster 71
Cluster 71 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 187
Next Cluster 5
Cluster 5 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 192
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 69
Cluster 69 sampled by Traj 189
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 659
Next Cluster 10
Cluster 10 sampled by Traj 941
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=45
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [794]: path_new                                                                                                             
Out[794]: 
array([[  17,    0],
       [  54, 1044],
       [  70,  654],
       [  72,  659],
       [  10,  941]])

In [795]: path_start_end_new                                                                                                   
Out[795]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [796]: path_Cluster_new                                                                                                     
Out[796]: [17, 54, 70, 72, 10, 48]

In [797]: path_table_new                                                                                                       
Out[797]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_156_xpr1          744             54  TPS_7500_cp_2  gn_156_xpr2        230           70
2   TPS_27500_cp  gn_082_xpr2          295             70   TPS_27500_cp  gn_082_xpr1        705           72
3   TPS_27500_cp  gn_102_xpr1          227             72   TPS_27500_cp  gn_102_xpr2        773           10
4   TPS_37500_cp  gn_207_xpr1           29             10   TPS_37500_cp  gn_207_xpr1        651           48

In [798]: path_data_new                                                                                                        
Out[798]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1044    999   26     -1
2   654      0  999      1
3   659    999    0     -1
4   941    622    0     -1



######################### PATH_1015 k=46 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1095
Next Cluster 38
Cluster 38 sampled by Traj 1097
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=46
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=46
path_new=np.array([[ 17,   0],[ 54, 271],[ 70, 489]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 46]])
path_Cluster_new=[17, 54, 70, 46]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1015.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=1,fillstyle='none', color='pink', marker="o", mew=0.6, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1015.01222024.larger.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 3))
ax.scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
ax.plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
ax.set_xlabel('Path',fontsize=16, fontweight='bold')
ax.set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
ax.set_title('BOLAS', fontweight='bold',fontsize=16)
ax.tick_params(axis='both', labelsize=12)
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.01222024.larger.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 3))
ax.scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c='#feb326', marker="o",zorder=2)
ax.plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='#feb326', linewidth=0.3,zorder=1)
ax.set_xlabel('Path',fontsize=16, fontweight='bold')
ax.set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
ax.set_title('BOLAS', fontweight='bold',fontsize=16)
ax.tick_params(axis='both', labelsize=12)
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.020824.larger.png".format(nclusters,k),dpi=1200)


path_list_d=pd.DataFrame(path_path_cluster_dist) 
path_list_d.to_csv("Path_list.lag=100.cluster={}.coord.region3.path{}.all.1015.022224.csv".format(nclusters,k))

In [801]: path_new                                                                                                             
Out[801]: 
array([[ 17,   0],
       [ 54, 271],
       [ 70, 489]])

In [802]: path_start_end_new                                                                                                   
Out[802]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [803]: path_Cluster_new                                                                                                     
Out[803]: [17, 54, 70, 46]

In [804]: path_table_new                                                                                                       
Out[804]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_17500_cp  gn_064_xpr1          363             54  TPS_17500_cp  gn_064_xpr2        204           70
2  TPS_22500_cp  gn_029_xpr2          208             70  TPS_22500_cp  gn_029_xpr1        619           46

In [805]: path_data_new                                                                                                        
Out[805]: 
   Traj  Start  End  Order
0     0      0  945      1
1   271    433  999      1
2   489    999  173     -1



######################### PATH_1015 k=47 #####################################



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=47
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [810]: path_new                                                                                                             
Out[810]: 
array([[  57, 1012],
       [  22,  995],
       [  54,  175],
       [  55,  213],
       [  70,  489]])

In [811]: path_start_end_new                                                                                                   
Out[811]: 
array([[57, 22],
       [22, 54],
       [54, 55],
       [55, 70],
       [70, 46]])

In [812]: path_Cluster_new                                                                                                     
Out[812]: [57, 22, 54, 55, 70, 46]

In [813]: path_table_new                                                                                                       
Out[813]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_234_xpr2          244             57  TPS_2500_cp_2  gn_234_xpr1        742           22
1  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
2      TPS_10000  gn_308_xpr2          730             54      TPS_10000  gn_308_xpr2        729           55
3      TPS_12500  gn_088_xpr2           86             55      TPS_12500  gn_088_xpr1        204           70
4   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46

In [814]: path_data_new                                                                                                        
Out[814]: 
   Traj  Start  End  Order
0  1012    999   14     -1
1   995      0  965      1
2   175    840  839     -1
3   213    289    0     -1
4   489    999  173     -1



######################### PATH_1015 k=48 #####################################


Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 272
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 489
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=48
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [819]: path_new                                                                                                             
Out[819]: 
array([[  57, 1009],
       [  22,  994],
       [  54,  362],
       [  70,  489]])

In [820]: path_start_end_new                                                                                                   
Out[820]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [821]: path_Cluster_new                                                                                                     
Out[821]: [57, 22, 54, 70, 46]

In [822]: path_table_new                                                                                                       
Out[822]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_222_xpr1          341             57  TPS_2500_cp_2  gn_222_xpr2        426           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2   TPS_20000_cp  gn_030_xpr1          842             54   TPS_20000_cp  gn_030_xpr1        807           70
3   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46

In [823]: path_data_new                                                                                                        
Out[823]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   994     48  999      1
2   362      0   35      1
3   489    999  173     -1




######################### PATH_1015 k=49 #####################################


Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 867
Next Cluster 59
Cluster 59 sampled by Traj 883
Next Cluster 49
Cluster 49 sampled by Traj 888
Next Cluster 65
Cluster 65 sampled by Traj 916
Next Cluster 65
Cluster 65 sampled by Traj 908
Next Cluster 73
Cluster 73 sampled by Traj 914
Next Cluster 65
Cluster 65 sampled by Traj 896
Next Cluster 65
Cluster 65 sampled by Traj 926
Next Cluster 73
Cluster 73 sampled by Traj 918
Next Cluster 73
Cluster 73 sampled by Traj 891
Next Cluster 65
Cluster 65 sampled by Traj 920
Next Cluster 73
Cluster 73 sampled by Traj 915
Next Cluster 73
Cluster 73 sampled by Traj 894
Next Cluster 65
Cluster 65 sampled by Traj 909
Next Cluster 73
Cluster 73 sampled by Traj 924
Next Cluster 65
Cluster 65 sampled by Traj 889
Next Cluster 49
Cluster 49 sampled by Traj 882
Next Cluster 59
Cluster 59 sampled by Traj 868
Next Cluster 59
Cluster 59 sampled by Traj 871
Next Cluster 59
Cluster 59 sampled by Traj 866
Next Cluster 58
Cluster 58 sampled by Traj 854
Next Cluster 58
Cluster 58 sampled by Traj 865
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=49
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [830]: path_new                                                                                                             
Out[830]: 
array([[  57, 1009],
       [  22,  994],
       [  54, 1044],
       [  70,  930],
       [  10,  489]])

In [831]: path_start_end_new                                                                                                   
Out[831]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 10],
       [10, 46]])

In [832]: path_Cluster_new                                                                                                     
Out[832]: [57, 22, 54, 70, 10, 46]

In [833]: path_data_new                                                                                                        
Out[833]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   994     48  999      1
2  1044    999   26     -1
3   930    999    0     -1
4   489      0  707      1




######################### PATH_1015 k=50 #####################################


Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 117
Next Cluster 1
Cluster 1 sampled by Traj 137
Next Cluster 1
Cluster 1 sampled by Traj 377
Next Cluster 1
Cluster 1 sampled by Traj 132
Next Cluster 68
Cluster 68 sampled by Traj 140
Next Cluster 1
Cluster 1 sampled by Traj 134
Next Cluster 68
Cluster 68 sampled by Traj 139
Next Cluster 1
Cluster 1 sampled by Traj 141
Next Cluster 68
Cluster 68 sampled by Traj 138
Next Cluster 1
Cluster 1 sampled by Traj 136
Next Cluster 1
Cluster 1 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 34
Cluster 34 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 691
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 62
Cluster 62 sampled by Traj 223
Next Cluster 62
Cluster 62 sampled by Traj 222
Next Cluster 24
Cluster 24 sampled by Traj 226
Next Cluster 55
Cluster 55 sampled by Traj 231
Next Cluster 24
Cluster 24 sampled by Traj 221
Next Cluster 62
Cluster 62 sampled by Traj 220
Next Cluster 24
Cluster 24 sampled by Traj 230
Next Cluster 24
Cluster 24 sampled by Traj 240
Next Cluster 55
Cluster 55 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 489
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=50
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [846]: path_new                                                                                                             
Out[846]: 
array([[  57, 1007],
       [  22,  994],
       [  54,  367],
       [  71, 1171],
       [  70,  213],
       [  62,  222],
       [  24,  240],
       [  55,  175],
       [  69,  171],
       [   5,  159],
       [  70,  489]])

In [847]: path_start_end_new                                                                                                   
Out[847]: 
array([[57, 22],
       [22, 54],
       [54, 71],
       [71, 70],
       [70, 62],
       [62, 24],
       [24, 55],
       [55, 69],
       [69,  5],
       [ 5, 70],
       [70, 46]])

In [848]: path_Cluster_new                                                                                                     
Out[848]: [57, 22, 54, 71, 70, 62, 24, 55, 69, 5, 70, 46]

In [849]: path_table_new                                                                                                       
Out[849]: 
      Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp_2  gn_219_xpr2          836             57   TPS_2500_cp_2  gn_219_xpr1        159           22
1    TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
2     TPS_20000_cp  gn_073_xpr1          888             54    TPS_20000_cp  gn_073_xpr2         62           71
3   TPS_20000_cp_2  gn_060_xpr1          524             71  TPS_20000_cp_2  gn_060_xpr2         24           70
4        TPS_12500  gn_088_xpr1          204             70       TPS_12500  gn_088_xpr2        796           62
5        TPS_12500  gn_165_xpr2          894             62       TPS_12500  gn_165_xpr1         11           24
6        TPS_12500  gn_594_xpr2          834             24       TPS_12500  gn_594_xpr1        139           55
7        TPS_10000  gn_308_xpr2          730             55       TPS_10000  gn_308_xpr1        111           69
8        TPS_10000  gn_283_xpr1          530             69       TPS_10000  gn_283_xpr2        458            5
9        TPS_10000  gn_176_xpr1          501              5       TPS_10000  gn_176_xpr2          2           70
10    TPS_22500_cp  gn_029_xpr2          208             70    TPS_22500_cp  gn_029_xpr1        619           46

In [850]: path_data_new                                                                                                        
Out[850]: 
    Traj  Start  End  Order
0   1007      5  999      1
1    994     48  999      1
2    367     50  999      1
3   1171     35  582      1
4    213      0  999      1
5    222     40  944      1
6    240     27  999      1
7    175    840    0     -1
8    171    999   12     -1
9    159      0  502      1
10   489    999  173     -1




######################### PATH_1015 k=51 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 16
Next Cluster 18
Cluster 18 sampled by Traj 18
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 1063
Next Cluster 39
Cluster 39 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 43
Cluster 43 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 659
Next Cluster 10
Cluster 10 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 867
Next Cluster 10
Cluster 10 sampled by Traj 873
Next Cluster 59
Cluster 59 sampled by Traj 866
Next Cluster 59
Cluster 59 sampled by Traj 871
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=51
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [859]: path_new                                                                                                             
Out[859]: 
array([[  17,    0],
       [  54,   76],
       [   3, 1063],
       [  39, 1060],
       [  70,  808],
       [  43,  812],
       [  10,  941]])

In [860]: path_start_end_new                                                                                                   
Out[860]: 
array([[17, 54],
       [54,  3],
       [ 3, 39],
       [39, 70],
       [70, 43],
       [43, 10],
       [10, 48]])

In [861]: path_Cluster_new                                                                                                     
Out[861]: [17, 54, 3, 39, 70, 43, 10, 48]

In [862]: path_table_new                                                                                                       
Out[862]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1     TPS_5000_cp  gn_028_xpr2          258             54     TPS_5000_cp  gn_028_xpr1        742            3
2  TPS_10000_cp_2  gn_207_xpr2          808              3  TPS_10000_cp_2  gn_207_xpr1        189           39
3  TPS_10000_cp_2  gn_164_xpr2          678             39  TPS_10000_cp_2  gn_164_xpr1        295           70
4    TPS_35000_cp  gn_049_xpr2          301             70    TPS_35000_cp  gn_049_xpr1        699           43
5    TPS_35000_cp  gn_072_xpr1          394             43    TPS_35000_cp  gn_072_xpr2        606           10
6    TPS_37500_cp  gn_207_xpr1           29             10    TPS_37500_cp  gn_207_xpr1        651           48

In [863]: path_data_new                                                                                                        
Out[863]: 
   Traj  Start  End  Order
0     0      0  945      1
1    76    999    0     -1
2  1063      3  999      1
3  1060     27  999      1
4   808    999    0     -1
5   812    999    0     -1
6   941    622    0     -1




######################### PATH_1015 k=52 #####################################


Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 17
Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 18
Next Cluster 18
Cluster 18 sampled by Traj 20
Next Cluster 18
Cluster 18 sampled by Traj 29
Next Cluster 18
Cluster 18 sampled by Traj 25
Next Cluster 40
Cluster 40 sampled by Traj 33
Next Cluster 40
Cluster 40 sampled by Traj 36
Next Cluster 40
Cluster 40 sampled by Traj 34
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 941
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=52
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [866]: path_new                                                                                                             
Out[866]: 
array([[  57, 1011],
       [  22,  994],
       [  54, 1040],
       [  70,  651],
       [  72,  660],
       [  10,  941]])

In [867]: path_start_end_new                                                                                                   
Out[867]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [868]: path_Cluster_new                                                                                                     
Out[868]: [57, 22, 54, 70, 72, 10, 48]

In [869]: path_table_new                                                                                                       
Out[869]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_226_xpr2          934             57  TPS_2500_cp_2  gn_226_xpr2         45           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_7500_cp_2  gn_117_xpr2          900             54  TPS_7500_cp_2  gn_117_xpr1         93           70
3   TPS_27500_cp  gn_076_xpr1          635             70   TPS_27500_cp  gn_076_xpr2        354           72
4   TPS_27500_cp  gn_103_xpr1          141             72   TPS_27500_cp  gn_103_xpr2        295           10
5   TPS_37500_cp  gn_207_xpr1           29             10   TPS_37500_cp  gn_207_xpr1        651           48

In [870]: path_data_new                                                                                                        
Out[870]: 
   Traj  Start  End  Order
0  1011      0  889      1
1   994     48  999      1
2  1040      0  992      1
3   651     11  999      1
4   660    392  827      1
5   941    622    0     -1




######################### PATH_1015 k=53 #####################################


Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 714
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 192
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 160
Next Cluster 69
Cluster 69 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 69
Cluster 69 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=53
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [875]: path_new                                                                                                             
Out[875]: 
array([[  57, 1007],
       [  22,  994],
       [  54, 1044],
       [  70,  654],
       [  72,  660],
       [  10,  940]])

In [876]: path_start_end_new                                                                                                   
Out[876]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [877]: path_Cluster_new                                                                                                     
Out[877]: [57, 22, 54, 70, 72, 10, 48]

In [878]: path_table_new                                                                                                       
Out[878]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_219_xpr2          836             57  TPS_2500_cp_2  gn_219_xpr1        159           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_7500_cp_2  gn_156_xpr1          744             54  TPS_7500_cp_2  gn_156_xpr2        230           70
3   TPS_27500_cp  gn_082_xpr2          295             70   TPS_27500_cp  gn_082_xpr1        705           72
4   TPS_27500_cp  gn_103_xpr1          141             72   TPS_27500_cp  gn_103_xpr2        295           10
5   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [879]: path_data_new                                                                                                        
Out[879]: 
   Traj  Start  End  Order
0  1007      5  999      1
1   994     48  999      1
2  1044    999   26     -1
3   654      0  999      1
4   660    392  827      1
5   940    999    0     -1




######################### PATH_1015 k=54 #####################################


Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 27
Cluster 27 sampled by Traj 1179
Next Cluster 27
Cluster 27 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=54
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [890]: path_new                                                                                                             
Out[890]: 
array([[  57, 1012],
       [  22,  995],
       [  54, 1033],
       [  70,  489]])

In [891]: path_start_end_new                                                                                                   
Out[891]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [892]: path_Cluster_new                                                                                                     
Out[892]: [57, 22, 54, 70, 46]

In [893]: path_table_new                                                                                                       
Out[893]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_234_xpr2          244             57  TPS_2500_cp_2  gn_234_xpr1        742           22
1  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
2  TPS_5000_cp_2  gn_105_xpr1          549             54  TPS_5000_cp_2  gn_105_xpr2        141           70
3   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46

In [894]: path_data_new                                                                                                        
Out[894]: 
   Traj  Start  End  Order
0  1012    999   14     -1
1   995      0  965      1
2  1033    999  310     -1
3   489    999  173     -1



######################### PATH_1015 k=55 #####################################


Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 43
Cluster 43 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 940
Final





path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=55
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [911]: path_new                                                                                                             
Out[911]: 
array([[  57, 1011],
       [  22,  994],
       [  54,  175],
       [  69,  160],
       [   5,  483],
       [  70,  808],
       [  43,  812],
       [  10,  940]])

In [912]: path_start_end_new                                                                                                   
Out[912]: 
array([[57, 22],
       [22, 54],
       [54, 69],
       [69,  5],
       [ 5, 70],
       [70, 43],
       [43, 10],
       [10, 48]])

In [913]: path_Cluster_new                                                                                                     
Out[913]: [57, 22, 54, 69, 5, 70, 43, 10, 48]

In [914]: path_table_new                                                                                                       
Out[914]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_226_xpr2          934             57  TPS_2500_cp_2  gn_226_xpr2         45           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2      TPS_10000  gn_308_xpr2          730             54      TPS_10000  gn_308_xpr1        111           69
3      TPS_10000  gn_178_xpr1          410             69      TPS_10000  gn_178_xpr2        249            5
4   TPS_22500_cp  gn_013_xpr2          487              5   TPS_22500_cp  gn_013_xpr1        499           70
5   TPS_35000_cp  gn_049_xpr2          301             70   TPS_35000_cp  gn_049_xpr1        699           43
6   TPS_35000_cp  gn_072_xpr1          394             43   TPS_35000_cp  gn_072_xpr2        606           10
7   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [915]: path_data_new                                                                                                        
Out[915]: 
   Traj  Start  End  Order
0  1011      0  889      1
1   994     48  999      1
2   175    840    0     -1
3   160    341  999      1
4   483    985    0     -1
5   808    999    0     -1
6   812    999    0     -1
7   940    999    0     -1




######################### PATH_1015 k=56 #####################################


Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 51
Cluster 51 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 168
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 171
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 192
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=56
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [921]: path_new                                                                                                                                                                            
Out[921]: 
array([[  57, 1010],
       [  22,  995],
       [  54, 1056],
       [  70,  490]])

In [922]: path_start_end_new                                                                                                   
Out[922]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [923]: path_Cluster_new                                                                                                     
Out[923]: [57, 22, 54, 70, 46]

In [924]: path_table_new                                                                                                       
Out[924]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_223_xpr1          405             57   TPS_2500_cp_2  gn_223_xpr2        499           22
1   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
2  TPS_10000_cp_2  gn_058_xpr1          323             54  TPS_10000_cp_2  gn_058_xpr2        327           70
3    TPS_22500_cp  gn_030_xpr1           41             70    TPS_22500_cp  gn_030_xpr1        684           46

In [925]: path_data_new                                                                                                        
Out[925]: 
   Traj  Start  End  Order
0  1010     96  999      1
1   995      0  965      1
2  1056    350  999      1
3   490    356  999      1




######################### PATH_1015 k=57 #####################################

Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 659
Next Cluster 72
Cluster 72 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=57
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [950]: path_new                                                                                                             
Out[950]: 
array([[  57, 1011],
       [  22,  994],
       [  54, 1055],
       [  70,  654],
       [  72,  665],
       [  10,  941]])

In [951]: path_start_end_new                                                                                                   
Out[951]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [952]: path_Cluster_new                                                                                                     
Out[952]: [57, 22, 54, 70, 72, 10, 48]

In [953]: path_table_new                                                                                                       
Out[953]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_226_xpr2          934             57   TPS_2500_cp_2  gn_226_xpr2         45           22
1   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_10000_cp_2  gn_010_xpr1          783             54  TPS_10000_cp_2  gn_010_xpr2        217           70
3    TPS_27500_cp  gn_082_xpr2          295             70    TPS_27500_cp  gn_082_xpr1        705           72
4    TPS_27500_cp  gn_125_xpr2          190             72    TPS_27500_cp  gn_125_xpr1        671           10
5    TPS_37500_cp  gn_207_xpr1           29             10    TPS_37500_cp  gn_207_xpr1        651           48

In [954]: path_data_new                                                                                                        
Out[954]: 
   Traj  Start  End  Order
0  1011      0  889      1
1   994     48  999      1
2  1055      0  999      1
3   654      0  999      1
4   665    139  999      1
5   941    622    0     -1


######################### PATH_1015 k=58 #####################################


Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=58
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [958]: path_new                                                                                                             
Out[958]: 
array([[  57, 1009],
       [  22,  994],
       [  54, 1039],
       [  70,  490]])

In [959]: path_start_end_new                                                                                                   
Out[959]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [960]: path_Cluster_new                                                                                                     
Out[960]: [57, 22, 54, 70, 46]

In [961]: path_table_new                                                                                                       
Out[961]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_222_xpr1          341             57  TPS_2500_cp_2  gn_222_xpr2        426           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
3   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [962]: path_data_new                                                                                                        
Out[962]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   994     48  999      1
2  1039    999    0     -1
3   490    356  999      1




######################### PATH_1015 k=59 #####################################


Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 1171
Next Cluster 27
Cluster 27 sampled by Traj 1179
Next Cluster 42
Cluster 42 sampled by Traj 1170
Next Cluster 27
Cluster 27 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 1178
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 86
Next Cluster 3
Cluster 3 sampled by Traj 1063
Next Cluster 39
Cluster 39 sampled by Traj 1060
Next Cluster 39
Cluster 39 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 192
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 160
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 715
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 70
Cluster 70 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=59
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [967]: path_new                                                                                                             
Out[967]: 
array([[  57, 1009],
       [  22,  995],
       [  54,  367],
       [  71,  363],
       [  70,  489]])

In [968]: path_start_end_new                                                                                                   
Out[968]: 
array([[57, 22],
       [22, 54],
       [54, 71],
       [71, 70],
       [70, 46]])

In [969]: path_Cluster_new                                                                                                     
Out[969]: [57, 22, 54, 71, 70, 46]

In [970]: path_table_new                                                                                                       
Out[970]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_222_xpr1          341             57  TPS_2500_cp_2  gn_222_xpr2        426           22
1  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
2   TPS_20000_cp  gn_073_xpr1          888             54   TPS_20000_cp  gn_073_xpr2         62           71
3   TPS_20000_cp  gn_033_xpr1          808             71   TPS_20000_cp  gn_033_xpr2        182           70
4   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46

In [971]: path_data_new                                                                                                        
Out[971]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   995      0  965      1
2   367     50  999      1
3   363    999   10     -1
4   489    999  173     -1





######################### PATH_1015 k=60 #####################################

Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 1084
Next Cluster 34
Cluster 34 sampled by Traj 1097
Next Cluster 34
Cluster 34 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 490
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=60
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)


k=60
path_new=np.array([[  17,    0],[  54, 1044],[  70,  490]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 46]])
path_Cluster_new=[17, 54, 70, 46]


path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1015.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=1,fillstyle='none', color='pink', marker="o", mew=0.6, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1015.01222024.larger.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.01222024.png".format(nclusters,k),dpi=1200)




fig, ax = plt.subplots(figsize=(7, 3))
ax.scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
ax.plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
ax.set_xlabel('Path',fontsize=16, fontweight='bold')
ax.set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
ax.set_title('BOLAS', fontweight='bold',fontsize=16)
ax.tick_params(axis='both', labelsize=12)
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.01222024.larger.png".format(nclusters,k),dpi=1200)




In [974]: path_new                                                                                                             
Out[974]: 
array([[  17,    0],
       [  54, 1044],
       [  70,  490]])

In [975]: path_start_end_new                                                                                                   
Out[975]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [976]: path_Cluster_new                                                                                                     
Out[976]: [17, 54, 70, 46]

In [977]: path_table_new                                                                                                       
Out[977]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_156_xpr1          744             54  TPS_7500_cp_2  gn_156_xpr2        230           70
2   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [978]: path_data_new                                                                                                        
Out[978]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1044    999   26     -1
2   490    356  999      1




######################### PATH_1015 k=61 #####################################



Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=61
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [981]: path_new                                                                                                             
Out[981]: 
array([[  57, 1012],
       [  22,  995],
       [  54,    0],
       [  70,  930],
       [  10,  940]])

In [982]: path_start_end_new                                                                                                   
Out[982]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [983]: path_Cluster_new                                                                                                     
Out[983]: [57, 22, 54, 70, 10, 48]

In [984]: path_table_new                                                                                                       
Out[984]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_234_xpr2          244             57  TPS_2500_cp_2  gn_234_xpr1        742           22
1  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
2    TPS_2500_cp  gn_017_xpr2          274             54    TPS_2500_cp  gn_017_xpr1        171           70
3   TPS_37500_cp  gn_090_xpr1          185             70   TPS_37500_cp  gn_090_xpr2        815           10
4   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [985]: path_data_new                                                                                                        
Out[985]: 
   Traj  Start  End  Order
0  1012    999   14     -1
1   995      0  965      1
2     0    945  501     -1
3   930    999    0     -1
4   940    999    0     -1




######################### PATH_1015 k=62 #####################################


Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 1063
Next Cluster 39
Cluster 39 sampled by Traj 175
Next Cluster 39
Cluster 39 sampled by Traj 1071
Next Cluster 39
Cluster 39 sampled by Traj 1072
Next Cluster 39
Cluster 39 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=62
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [989]: path_new                                                                                                             
Out[989]: 
array([[  57, 1012],
       [  22,  995],
       [  54, 1039],
       [  70,  489]])

In [990]: path_start_end_new                                                                                                   
Out[990]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [991]: path_Cluster_new                                                                                                     
Out[991]: [57, 22, 54, 70, 46]

In [992]: path_table_new                                                                                                       
Out[992]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_234_xpr2          244             57  TPS_2500_cp_2  gn_234_xpr1        742           22
1  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
2  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
3   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46

In [993]: path_data_new                                                                                                        
Out[993]: 
   Traj  Start  End  Order
0  1012    999   14     -1
1   995      0  965      1
2  1039    999    0     -1
3   489    999  173     -1



######################### PATH_1015 k=63 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=63
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [1000]: path_new                                                                                                            
Out[1000]: 
array([[ 17,   0],
       [ 70, 662],
       [ 10, 941]])

In [1001]: path_start_end_new                                                                                                  
Out[1001]: 
array([[17, 70],
       [70, 10],
       [10, 48]])

In [1002]: path_Cluster_new                                                                                                    
Out[1002]: [17, 70, 10, 48]

In [1003]: path_table_new                                                                                                      
Out[1003]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_27500_cp  gn_108_xpr1           40             70  TPS_27500_cp  gn_108_xpr2        671           10
2  TPS_37500_cp  gn_207_xpr1           29             10  TPS_37500_cp  gn_207_xpr1        651           48

In [1004]: path_data_new                                                                                                       
Out[1004]: 
   Traj  Start  End  Order
0     0      0  501      1
1   662    268  978      1
2   941    622    0     -1





######################### PATH_1015 k=64 #####################################

Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 489
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=64
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [1011]: path_new                                                                                                            
Out[1011]: 
array([[  57, 1011],
       [  22,  995],
       [  54, 1033],
       [  70,  489]])

In [1012]: path_start_end_new                                                                                                  
Out[1012]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [1013]: path_Cluster_new                                                                                                    
Out[1013]: [57, 22, 54, 70, 46]

In [1014]: path_table_new                                                                                                      
Out[1014]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_226_xpr2          934             57  TPS_2500_cp_2  gn_226_xpr2         45           22
1  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
2  TPS_5000_cp_2  gn_105_xpr1          549             54  TPS_5000_cp_2  gn_105_xpr2        141           70
3   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46

In [1015]: path_data_new                                                                                                       
Out[1015]: 
   Traj  Start  End  Order
0  1011      0  889      1
1   995      0  965      1
2  1033    999  310     -1
3   489    999  173     -1




######################### PATH_1015 k=65 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=65
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [1018]: path_new                                                                                                            
Out[1018]: 
array([[ 17,   0],
       [ 70, 490]])

In [1019]: path_start_end_new                                                                                                  
Out[1019]: 
array([[17, 70],
       [70, 46]])

In [1020]: path_Cluster_new                                                                                                    
Out[1020]: [17, 70, 46]

In [1021]: path_table_new                                                                                                      
Out[1021]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_22500_cp  gn_030_xpr1           41             70  TPS_22500_cp  gn_030_xpr1        684           46

In [1022]: path_data_new                                                                                                       
Out[1022]: 
   Traj  Start  End  Order
0     0      0  501      1
1   490    356  999      1




######################### PATH_1015 k=66 #####################################

Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 363
Next Cluster 71
Cluster 71 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 377
Next Cluster 64
Cluster 64 sampled by Traj 383
Next Cluster 64
Cluster 64 sampled by Traj 380
Next Cluster 14
Cluster 14 sampled by Traj 397
Next Cluster 30
Cluster 30 sampled by Traj 441
Next Cluster 30
Cluster 30 sampled by Traj 396
Next Cluster 30
Cluster 30 sampled by Traj 415
Next Cluster 8
Cluster 8 sampled by Traj 427
Next Cluster 8
Cluster 8 sampled by Traj 430
Next Cluster 7
Cluster 7 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 715
Next Cluster 25
Cluster 25 sampled by Traj 714
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=66
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [1030]: path_new                                                                                                            
Out[1030]: 
array([[  57, 1007],
       [  22,  995],
       [  54, 1133],
       [  70,  490]])

In [1031]: path_start_end_new                                                                                                  
Out[1031]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [1032]: path_Cluster_new                                                                                                    
Out[1032]: [57, 22, 54, 70, 46]

In [1033]: path_table_new                                                                                                      
Out[1033]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_219_xpr2          836             57   TPS_2500_cp_2  gn_219_xpr1        159           22
1   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
2  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
3    TPS_22500_cp  gn_030_xpr1           41             70    TPS_22500_cp  gn_030_xpr1        684           46

In [1034]: path_data_new                                                                                                       
Out[1034]: 
   Traj  Start  End  Order
0  1007      5  999      1
1   995      0  965      1
2  1133    607    0     -1
3   490    356  999      1



######################### PATH_1015 k=67 #####################################

Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 140
Next Cluster 1
Cluster 1 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1121
Next Cluster 33
Cluster 33 sampled by Traj 1113
Next Cluster 33
Cluster 33 sampled by Traj 1111
Next Cluster 38
Cluster 38 sampled by Traj 1104
Next Cluster 38
Cluster 38 sampled by Traj 1097
Next Cluster 38
Cluster 38 sampled by Traj 1114
Next Cluster 33
Cluster 33 sampled by Traj 1115
Next Cluster 38
Cluster 38 sampled by Traj 1095
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 34
Cluster 34 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 70
Cluster 70 sampled by Traj 1171
Next Cluster 71
Cluster 71 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 372
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 1033
Next Cluster 70
Cluster 70 sampled by Traj 1170
Next Cluster 27
Cluster 27 sampled by Traj 1172
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 70
Cluster 70 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 39
Cluster 39 sampled by Traj 1063
Next Cluster 39
Cluster 39 sampled by Traj 1061
Next Cluster 39
Cluster 39 sampled by Traj 1072
Next Cluster 39
Cluster 39 sampled by Traj 1071
Next Cluster 39
Cluster 39 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 489
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=67
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [1038]: path_new                                                                                                            
Out[1038]: 
array([[  17,    0],
       [  54,  175],
       [  39, 1060],
       [  70,  489]])

In [1039]: path_start_end_new                                                                                                  
Out[1039]: 
array([[17, 54],
       [54, 39],
       [39, 70],
       [70, 46]])

In [1040]: path_Cluster_new                                                                                                    
Out[1040]: [17, 54, 39, 70, 46]

In [1041]: path_table_new                                                                                                      
Out[1041]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1       TPS_10000  gn_308_xpr2          729             54       TPS_10000  gn_308_xpr2        875           39
2  TPS_10000_cp_2  gn_164_xpr2          678             39  TPS_10000_cp_2  gn_164_xpr1        295           70
3    TPS_22500_cp  gn_029_xpr2          208             70    TPS_22500_cp  gn_029_xpr1        619           46

In [1042]: path_data_new                                                                                                       
Out[1042]: 
   Traj  Start  End  Order
0     0      0  945      1
1   175    839  985      1
2  1060     27  999      1
3   489    999  173     -1




######################### PATH_1015 k=68 #####################################


Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 490
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=68
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [1073]: path_new                                                                                                            
Out[1073]: 
array([[  17,    0],
       [  54, 1029],
       [  70,  490]])

In [1074]: path_start_end_new                                                                                                  
Out[1074]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [1075]: path_Cluster_new                                                                                                    
Out[1075]: [17, 54, 70, 46]

In [1076]: path_table_new                                                                                                      
Out[1076]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_5000_cp_2  gn_011_xpr1          752             54  TPS_5000_cp_2  gn_011_xpr2         19           70
2   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [1077]: path_data_new                                                                                                       
Out[1077]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1029      0  770      1
2   490    356  999      1




######################### PATH_1015 k=69 #####################################


Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 171
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 189
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 186
Next Cluster 20
Cluster 20 sampled by Traj 188
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 187
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 665
Next Cluster 72
Cluster 72 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 70
Cluster 70 sampled by Traj 1170
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 70
^[[ACluster 70 sampled by Traj 489
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=69
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [1113]: path_new                                                                                                            
Out[1113]: 
array([[ 17,   0],
       [ 54, 170],
       [ 69, 181],
       [  5, 159],
       [ 70, 489]])

In [1114]: path_start_end_new                                                                                                  
Out[1114]: 
array([[17, 54],
       [54, 69],
       [69,  5],
       [ 5, 70],
       [70, 46]])

In [1115]: path_Cluster_new                                                                                                    
Out[1115]: [17, 54, 69, 5, 70, 46]

In [1116]: path_table_new                                                                                                      
Out[1116]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1     TPS_10000  gn_273_xpr2          265             54     TPS_10000  gn_273_xpr2        201           69
2     TPS_10000  gn_363_xpr2          355             69     TPS_10000  gn_363_xpr1        369            5
3     TPS_10000  gn_176_xpr1          501              5     TPS_10000  gn_176_xpr2          2           70
4  TPS_22500_cp  gn_029_xpr2          208             70  TPS_22500_cp  gn_029_xpr1        619           46

In [1117]: path_data_new                                                                                                       
Out[1117]: 
   Traj  Start  End  Order
0     0      0  945      1
1   170      0   64      1
2   181    999  276     -1
3   159      0  502      1
4   489    999  173     -1





######################### PATH_1015 k=70 #####################################

Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 489
Next Cluster 46
Cluster 46 sampled by Traj 501
Next Cluster 46
Cluster 46 sampled by Traj 490
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 3
Cluster 3 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=70
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [1130]: path_new                                                                                                            
Out[1130]: 
array([[ 17,   0],
       [ 70, 651],
       [ 72, 661],
       [ 10, 940]])

In [1131]: path_start_end_new                                                                                                  
Out[1131]: 
array([[17, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [1132]: path_Cluster_new                                                                                                    
Out[1132]: [17, 70, 72, 10, 48]

In [1133]: path_table_new                                                                                                      
Out[1133]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_27500_cp  gn_076_xpr1          635             70  TPS_27500_cp  gn_076_xpr2        354           72
2  TPS_27500_cp  gn_105_xpr1           96             72  TPS_27500_cp  gn_105_xpr2        757           10
3  TPS_37500_cp  gn_204_xpr1           96             10  TPS_37500_cp  gn_204_xpr2        904           48

In [1134]: path_data_new                                                                                                       
Out[1134]: 
   Traj  Start  End  Order
0     0      0  501      1
1   651     11  999      1
2   661    852    0     -1
3   940    999    0     -1



######################### PATH_1015 k=71 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 74
Cluster 74 sampled by Traj 18
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=71
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)


In [1145]: path_new                                                                                                            
Out[1145]: 
array([[ 17,   6],
       [ 74,  18],
       [ 18,  28],
       [ 54, 117],
       [ 70, 662],
       [ 10, 941]])

In [1146]: path_start_end_new                                                                                                  
Out[1146]: 
array([[17, 74],
       [74, 18],
       [18, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [1147]: path_Cluster_new                                                                                                    
Out[1147]: [17, 74, 18, 54, 70, 10, 48]

In [1148]: path_table_new                                                                                                      
Out[1148]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_037_xpr2          251             17   TPS_2500_cp  gn_037_xpr1        478           74
1   TPS_2500_cp  gn_165_xpr1          487             74   TPS_2500_cp  gn_165_xpr2        499           18
2   TPS_2500_cp  gn_199_xpr2          165             18   TPS_2500_cp  gn_199_xpr1        766           54
3      TPS_7500  gn_067_xpr1          379             54      TPS_7500  gn_067_xpr1          4           70
4  TPS_27500_cp  gn_108_xpr1           40             70  TPS_27500_cp  gn_108_xpr2        671           10
5  TPS_37500_cp  gn_207_xpr1           29             10  TPS_37500_cp  gn_207_xpr1        651           48

In [1149]: path_data_new                                                                                                       
Out[1149]: 
   Traj  Start  End  Order
0     6    271  999      1
1    18    985    0     -1
2    28    999   69     -1
3   117    302  677      1
4   662    268  978      1
5   941    622    0     -1




######################### PATH_1015 k=72 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 74
Cluster 74 sampled by Traj 16
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 137
Next Cluster 1
Cluster 1 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 168
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 5
Cluster 5 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 70
Cluster 70 sampled by Traj 490
Next Cluster 46
Cluster 46 sampled by Traj 489
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 27
Cluster 27 sampled by Traj 1171
Next Cluster 71
Cluster 71 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 372
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 1063
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 86
Next Cluster 3
Cluster 3 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 43
Cluster 43 sampled by Traj 812
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 685
Next Cluster 10
Cluster 10 sampled by Traj 661
Next Cluster 10
Cluster 10 sampled by Traj 867
Next Cluster 10
Cluster 10 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 941
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=72
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [1171]: path_new                                                                                                            
Out[1171]: 
array([[ 17,   6],
       [ 74,  16],
       [ 18,  28],
       [ 54, 362],
       [ 70, 808],
       [ 43, 812],
       [ 10, 941]])

In [1172]: path_start_end_new                                                                                                  
Out[1172]: 
array([[17, 74],
       [74, 18],
       [18, 54],
       [54, 70],
       [70, 43],
       [43, 10],
       [10, 48]])

In [1173]: path_Cluster_new                                                                                                    
Out[1173]: [17, 74, 18, 54, 70, 43, 10, 48]

In [1174]: path_table_new                                                                                                      
Out[1174]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_037_xpr2          251             17   TPS_2500_cp  gn_037_xpr1        478           74
1   TPS_2500_cp  gn_119_xpr2          100             74   TPS_2500_cp  gn_119_xpr1        900           18
2   TPS_2500_cp  gn_199_xpr2          165             18   TPS_2500_cp  gn_199_xpr1        766           54
3  TPS_20000_cp  gn_030_xpr1          842             54  TPS_20000_cp  gn_030_xpr1        807           70
4  TPS_35000_cp  gn_049_xpr2          301             70  TPS_35000_cp  gn_049_xpr1        699           43
5  TPS_35000_cp  gn_072_xpr1          394             43  TPS_35000_cp  gn_072_xpr2        606           10
6  TPS_37500_cp  gn_207_xpr1           29             10  TPS_37500_cp  gn_207_xpr1        651           48

In [1175]: path_data_new                                                                                                       
Out[1175]: 
   Traj  Start  End  Order
0     6    271  999      1
1    16    999    0     -1
2    28    999   69     -1
3   362      0   35      1
4   808    999    0     -1
5   812    999    0     -1
6   941    622    0     -1



######################### PATH_1015 k=73 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 70
Cluster 70 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 870
Next Cluster 59
Cluster 59 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 822
Next Cluster 10
Cluster 10 sampled by Traj 867
Next Cluster 59
Cluster 59 sampled by Traj 868
Next Cluster 59
Cluster 59 sampled by Traj 871
Next Cluster 59
Cluster 59 sampled by Traj 866
Next Cluster 10
Cluster 10 sampled by Traj 661
Next Cluster 10
Cluster 10 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 691
Next Cluster 10
Cluster 10 sampled by Traj 660
Next Cluster 72
Cluster 72 sampled by Traj 659
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 941
Final


path=np.array([[17 ,0],[54 ,1055],[54 ,175],[70 ,808],[70 ,362],[71 ,272],[71 ,1171],[70 ,930],[10 ,870],[59 ,869],[10 ,822],[10 ,867],[59 ,868],[59 ,871],[59 ,866],[10 ,661],[10 ,662],[72 ,665],[10 ,691],[10 ,660],[72 ,659],[72 ,664],[10 ,687],[10 ,941]])
path_start_end=np.array([[17,54],[54,54],[54,70],[70,70],[70,71],[71,71],[71,70],[70,10],[10,59],[59,10],[10,10],[10,59],[59,59],[59,59],[59,10],[10,10],[10,72],[72,10],[10,10],[10,72],[72,72],[72,10],[10,10],[10,48]])
path_Cluster=[17,54,54,70,70,71,71,70,10,59,10,10,59,59,59,10,10,72,10,10,72,72,10,10,48]




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=73
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [1232]: path_new                                                                                                            
Out[1232]: 
array([[ 17,   0],
       [ 54, 175],
       [ 70, 930],
       [ 10, 941]])

In [1233]: path_start_end_new                                                                                                  
Out[1233]: 
array([[17, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [1234]: path_Cluster_new                                                                                                    
Out[1234]: [17, 54, 70, 10, 48]

In [1235]: path_table_new                                                                                                      
Out[1235]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1     TPS_10000  gn_308_xpr2          729             54     TPS_10000  gn_308_xpr2        738           70
2  TPS_37500_cp  gn_090_xpr1          185             70  TPS_37500_cp  gn_090_xpr2        815           10
3  TPS_37500_cp  gn_207_xpr1           29             10  TPS_37500_cp  gn_207_xpr1        651           48

In [1236]: path_data_new                                                                                                       
Out[1236]: 
   Traj  Start  End  Order
0     0      0  945      1
1   175    839  848      1
2   930    999    0     -1
3   941    622    0     -1



######################### PATH_1015 k=74 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 1170
Next Cluster 27
Cluster 27 sampled by Traj 1178
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 489
Next Cluster 10
Cluster 10 sampled by Traj 684
Next Cluster 32
Cluster 32 sampled by Traj 695
Next Cluster 67
Cluster 67 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path=np.array([[17,0],[54,1056],[70,1172],[27,1170],[27,1178],[27,482],[70,1029],[54,1133],[70,651],[72,665],[10,489],[10,684],[32,695],[67,687],[10,664],[10,940]])
path_start_end=np.array([[17, 54],[54, 70],[70, 27],[27, 27],[27, 27],[27, 70],[70, 54],[54, 70],[70, 72],[72, 10],[10, 10],[10, 32],[32, 67],[67, 10],[10, 10],[10, 48]])
path_Cluster=[17,54,70,27,27,27,70,54,70,72,10,10,32,67,10,10,48]



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=74
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)




fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1  /nm',fontsize=16, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=16, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
ax.tick_params(labelsize=16)
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.01222024.png".format(nclusters,k),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1015.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.01222024.png".format(nclusters,k),dpi=1200)


################# Load BOLAS files DIST for bolas

data_index=list(range(len(dist_data_concatenated)))
data_sele=[i for i in data_index if i not in [2989755,2989756]]

fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated[data_sele,:].T, ax=ax, legacy=False)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, facecolors='none', edgecolors='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1  /nm',fontsize=16, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=16, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
ax.tick_params(labelsize=16)
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.onBOLAS.plot1113.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path',fontsize=16, fontweight='bold')
axes[0].set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path',fontsize=16, fontweight='bold')
axes[1].set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path',fontsize=16, fontweight='bold')
axes[2].set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
axes[0].tick_params(labelsize=16)
axes[1].tick_params(labelsize=16)
axes[2].tick_params(labelsize=16)
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.plot1113.png".format(nclusters,k),dpi=1200)



In [1240]: path_new                                                                                                            
Out[1240]: 
array([[  17,    0],
       [  54, 1056],
       [  70,  651],
       [  72,  665],
       [  10,  940]])

In [1241]: path_start_end_new                                                                                                  
Out[1241]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [1242]: path_Cluster_new                                                                                                    
Out[1242]: [17, 54, 70, 72, 10, 48]

In [1243]: path_table_new                                                                                                      
Out[1243]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_10000_cp_2  gn_058_xpr1          323             54  TPS_10000_cp_2  gn_058_xpr2        327           70
2    TPS_27500_cp  gn_076_xpr1          635             70    TPS_27500_cp  gn_076_xpr2        354           72
3    TPS_27500_cp  gn_125_xpr2          190             72    TPS_27500_cp  gn_125_xpr1        671           10
4    TPS_37500_cp  gn_204_xpr1           96             10    TPS_37500_cp  gn_204_xpr2        904           48

In [1244]: path_data_new                                                                                                       
Out[1244]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1056    350  999      1
2   651     11  999      1
3   665    139  999      1
4   940    999    0     -1


path_new=np.array([[17,0],[54, 1056],[70,651],[72,665],[10,940]])
path_start_end_new=np.array([[17, 54],[54, 70],[70, 72],[72, 10],[10, 48]])
path_Cluster_new=[17, 54, 70, 72, 10, 48]

######################### PATH_1015 k=75 #####################################

Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 685
Next Cluster 10
Cluster 10 sampled by Traj 659
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 72
Cluster 72 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 691
Next Cluster 67
Cluster 67 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 868
Next Cluster 59
Cluster 59 sampled by Traj 870
Next Cluster 10
Cluster 10 sampled by Traj 822
Next Cluster 10
Cluster 10 sampled by Traj 940
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=75
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [1276]: path_new                                                                                                            
Out[1276]: 
array([[ 17,   0],
       [ 54, 117],
       [ 70, 930],
       [ 10, 940]])

In [1277]: path_start_end_new                                                                                                  
Out[1277]: 
array([[17, 54],
       [54, 70],
       [70, 10],
       [10, 48]])

In [1278]: path_Cluster_new                                                                                                    
Out[1278]: [17, 54, 70, 10, 48]

In [1279]: path_table_new                                                                                                      
Out[1279]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1      TPS_7500  gn_067_xpr1          379             54      TPS_7500  gn_067_xpr1          4           70
2  TPS_37500_cp  gn_090_xpr1          185             70  TPS_37500_cp  gn_090_xpr2        815           10
3  TPS_37500_cp  gn_204_xpr1           96             10  TPS_37500_cp  gn_204_xpr2        904           48

In [1280]: path_data_new                                                                                                       
Out[1280]: 
   Traj  Start  End  Order
0     0      0  945      1
1   117    302  677      1
2   930    999    0     -1
3   940    999    0     -1





######################### PATH_1015 k=76 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 16
Cluster 16 sampled by Traj 1142
Next Cluster 36
Cluster 36 sampled by Traj 1150
Next Cluster 16
Cluster 16 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 1179
Next Cluster 27
Cluster 27 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 51
Cluster 51 sampled by Traj 251
Next Cluster 51
Cluster 51 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 175
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 659
Next Cluster 10
Cluster 10 sampled by Traj 868
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 59
Cluster 59 sampled by Traj 873
Next Cluster 59
Cluster 59 sampled by Traj 866
Next Cluster 59
Cluster 59 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 691
Next Cluster 67
Cluster 67 sampled by Traj 687
Next Cluster 67
Cluster 67 sampled by Traj 695
Next Cluster 32
Cluster 32 sampled by Traj 709
Next Cluster 11
Cluster 11 sampled by Traj 705
Next Cluster 32
Cluster 32 sampled by Traj 685
Next Cluster 32
Cluster 32 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=76
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)




In [1297]: path_new                                                                                                            
Out[1297]: 
array([[  17,    0],
       [  54, 1039],
       [  70,  662],
       [  72,  659],
       [  10,  940]])

In [1298]: path_start_end_new                                                                                                  
Out[1298]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [1299]: path_Cluster_new                                                                                                    
Out[1299]: [17, 54, 70, 72, 10, 48]

In [1300]: path_table_new                                                                                                      
Out[1300]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
2   TPS_27500_cp  gn_108_xpr1           40             70   TPS_27500_cp  gn_108_xpr1         25           72
3   TPS_27500_cp  gn_102_xpr1          227             72   TPS_27500_cp  gn_102_xpr2        773           10
4   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [1301]: path_data_new                                                                                                       
Out[1301]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1039    999    0     -1
2   662    268  283      1
3   659    999    0     -1
4   940    999    0     -1





######################### PATH_1015 k=77 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 868
Next Cluster 10
Cluster 10 sampled by Traj 665
Next Cluster 10
Cluster 10 sampled by Traj 866
Next Cluster 59
Cluster 59 sampled by Traj 883
Next Cluster 49
Cluster 49 sampled by Traj 882
Next Cluster 59
Cluster 59 sampled by Traj 867
Next Cluster 10
Cluster 10 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 10
Cluster 10 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 941
Final




path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=77
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)




In [1315]: path_new                                                                                                            
Out[1315]: 
array([[ 17,   0],
       [ 70, 654],
       [ 72, 660],
       [ 10, 941]])

In [1316]: path_start_end_new                                                                                                  
Out[1316]: 
array([[17, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [1317]: path_Cluster_new                                                                                                    
Out[1317]: [17, 70, 72, 10, 48]

In [1318]: path_table_new                                                                                                      
Out[1318]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_27500_cp  gn_082_xpr2          295             70  TPS_27500_cp  gn_082_xpr1        705           72
2  TPS_27500_cp  gn_103_xpr1          141             72  TPS_27500_cp  gn_103_xpr2        295           10
3  TPS_37500_cp  gn_207_xpr1           29             10  TPS_37500_cp  gn_207_xpr1        651           48

In [1319]: path_data_new                                                                                                       
Out[1319]: 
   Traj  Start  End  Order
0     0      0  501      1
1   654      0  999      1
2   660    392  827      1
3   941    622    0     -1



######################### PATH_1015 k=78 #####################################


Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 39
Cluster 39 sampled by Traj 1071
Next Cluster 52
Cluster 52 sampled by Traj 1072
Next Cluster 39
Cluster 39 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 930
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 58
Cluster 58 sampled by Traj 866
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path=np.array([[17,0],[54,1039],[70,1060],[39,1071],[52,1072],[39,175],[70,595],[70,271],[54,1043],[54,1040],[70,213],[70,654],[70,1061],[70,930],[10,865],[58,866],[10,940]])
path_start_end=np.array([[17,54],[54,70],[70,39],[39,52],[52,39],[39,70],[70,70],[70,54],[54,54],[54,70],[70,70],[70,70],[70,70],[70,10],[10,58],[58,10],[10,940]])
path_Cluster=[17,54,70,39,52,39,70,70,54,54,70,70,70,70,10,58,10,48]



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=78
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [1383]: path_new                                                                                                            
Out[1383]: 
array([[  17,    0],
       [  54, 1039],
       [  70,  930],
       [  10,  940]])

In [1384]: path_start_end_new                                                                                                  
Out[1384]: 
array([[ 17,  54],
       [ 54,  70],
       [ 70,  10],
       [ 10, 940]])

In [1385]: path_Cluster_new                                                                                                    
Out[1385]: [17, 54, 70, 10, 48]

In [1386]: path_table_new                                                                                                      
Out[1386]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
2   TPS_37500_cp  gn_090_xpr1          185             70   TPS_37500_cp  gn_090_xpr2        815           10
3   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48

In [1387]: path_data_new                                                                                                       
Out[1387]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1039    999    0     -1
2   930    999    0     -1
3   940    999    0     -1




######################### PATH_1015 k=79 #####################################


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 661
Next Cluster 10
Cluster 10 sampled by Traj 940
Final



path,path_start_end,path_Cluster=get_cluster_series(cluster_series,cluster_33,cluster_36)

k=79
path_new, path_start_end_new, path_Cluster_new = path_simplify(path,path_start_end,path_Cluster)
path_table_new, path_data_new =summarize_path(path_new,path_Cluster_new)
path_extract_dist=extract_path_data(path_data_new, dist_data_update)
path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
path_extract_dist_concatenated = np.concatenate(path_extract_dist)
path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path{}.1015.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path{}.all.1015.png".format(nclusters,k),dpi=1200)



In [1403]: path_new                                                                                                            
Out[1403]: 
array([[ 17,   0],
       [ 54, 362],
       [ 70, 662],
       [ 72, 664],
       [ 10, 940]])

In [1404]: path_start_end_new                                                                                                  
Out[1404]: 
array([[17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [1405]: path_Cluster_new                                                                                                    
Out[1405]: [17, 54, 70, 72, 10, 48]

In [1406]: path_table_new                                                                                                      
Out[1406]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_20000_cp  gn_030_xpr1          842             54  TPS_20000_cp  gn_030_xpr1        807           70
2  TPS_27500_cp  gn_108_xpr1           40             70  TPS_27500_cp  gn_108_xpr1         25           72
3  TPS_27500_cp  gn_121_xpr1          408             72  TPS_27500_cp  gn_121_xpr2        284           10
4  TPS_37500_cp  gn_204_xpr1           96             10  TPS_37500_cp  gn_204_xpr2        904           48

In [1407]: path_data_new                                                                                                       
Out[1407]: 
   Traj  Start  End  Order
0     0      0  945      1
1   362      0   35      1
2   662    268  283      1
3   664    308  999      1
4   940    999    0     -1



#%%%%%%%%%%%%%%%%% Plotting Path 1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In [13]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                          
Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 251
Next Cluster 51
Cluster 51 sampled by Traj 250
Next Cluster 51
Cluster 51 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final
Out[13]: [1007, 1011, 1012, 994, 1029, 117, 271, 251, 250, 252, 1083]

Cluster Index: 22 --> 57 --> 22 --> 54 --> 70 --> 51 --> 70 --> 34 --> 38
Cluster ID:    23 --> 58 --> 23 --> 55 --> 71 --> 52 --> 71 --> 35 --> 39
 

path1=np.array([[22,1007],[57,1011],[22,1012],[22,994],[54,1029],[70,117],[70,271],[70,251],[51,250],[51,252],[70,1083],[34,1097]])
path1_start_end=np.array([[22,57],[57,22],[22,22],[22,54],[54,70],[70,70],[70,70],[70,51],[51,51],[51,70],[70,34],[34,38]])
path1_Cluster =[22,57,22,22,54,70,70,70,51,51,70,34,38]


path1_new, path1_start_end_new, path1_Cluster_new = path_simplify(path1,path1_start_end,path1_Cluster)
path1_table_new, path1_data_new =summarize_path(path1_new,path1_Cluster_new)
path1_extract_dist=extract_path_data(path1_data_new, dist_data_update)
path1_extract_tica=extract_path_data(path1_data_new, tica_coord_output)
path1_extract_dist_concatenated = np.concatenate(path1_extract_dist)
path1_path_binnumber_dist, path1_path_energy_dist, path1_path_cluster_dist =extract_path_energy(path1_data_new,binnumber_dist,f_dist)
path1_path_binnumber_weight, path1_path_energy_weight, path1_path_cluster_weight =extract_path_energy(path1_data_new,binnumber_weight,f_weight)
path1_path_energy_bolas=extract_bolas_energy(path1_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path1_extract_dist_concatenated[:,0],path1_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path1.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path1_path_energy_dist))),path1_path_energy_dist, s=2, c=path1_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path1_path_energy_dist))),path1_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path1_path_energy_weight))),path1_path_energy_weight, s=2, c=path1_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path1_path_energy_weight))),path1_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path1_path_energy_bolas))),path1_path_energy_bolas, s=2, c=path1_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path1_path_energy_bolas))),path1_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path1.all.1003.png".format(nclusters),dpi=1200)


In [164]: path1_new                                                                                                               
Out[164]: 
array([[  22,  994],
       [  54, 1029],
       [  70, 1083],
       [  34, 1097]])

In [165]: path1_start_end_new                                                                                                     
Out[165]: 
array([[22, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [166]: path1_Cluster_new                                                                                                       
Out[166]: [22, 54, 70, 34, 38]

In [232]: path1_table_new                                                                                                         
Out[232]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_5000_cp_2  gn_011_xpr1          752             54   TPS_5000_cp_2  gn_011_xpr2         19           70
2  TPS_12500_cp_2  gn_046_xpr2          221             70  TPS_12500_cp_2  gn_046_xpr1        779           34
3  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [233]: path1_data_new                                                                                                          
Out[233]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1029      0  770      1
2  1083      0  999      1
3  1097      0  999      1




Out[10]: 
      Start_window   Start_traj  Start_frame  ...     End_traj End_frame End_cluster
0    TPS_2500_cp_2  gn_219_xpr1          159  ...  gn_219_xpr2       836          57
1    TPS_2500_cp_2  gn_226_xpr2          934  ...  gn_226_xpr2        85          22
2    TPS_2500_cp_2  gn_234_xpr1          674  ...  gn_234_xpr1       742          22
3    TPS_2500_cp_2  gn_151_xpr1          527  ...  gn_151_xpr1       526          54
4    TPS_5000_cp_2  gn_011_xpr1          752  ...  gn_011_xpr2        18          70
5         TPS_7500  gn_067_xpr1            4  ...  gn_067_xpr1        19          70
6     TPS_17500_cp  gn_064_xpr2          204  ...  gn_064_xpr1       351          70
7     TPS_15000_cp  gn_528_xpr1           52  ...  gn_528_xpr1       649          51
8     TPS_15000_cp  gn_525_xpr1          153  ...  gn_525_xpr1       303          51
9     TPS_15000_cp  gn_530_xpr2          256  ...  gn_530_xpr1       348          70
10  TPS_12500_cp_2  gn_046_xpr2          221  ...  gn_046_xpr1       144          34
11  TPS_12500_cp_2  gn_202_xpr1          555  ...  gn_202_xpr1       554          38



#%%%%%%%%%%%%%%%%% Plotting Path 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



In [25]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                          
Cluster 18 sampled by Traj 34
Next Cluster 40
Cluster 40 sampled by Traj 25
Next Cluster 40
Cluster 40 sampled by Traj 44
Next Cluster 40
Cluster 40 sampled by Traj 30
Next Cluster 18
Cluster 18 sampled by Traj 29
Next Cluster 18
Cluster 18 sampled by Traj 16
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 10
Cluster 10 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 10
Cluster 10 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 941
Final
Out[25]: [34, 25, 44, 30, 29, 16, 6, 0, 1039, 654, 661, 664, 687, 871, 660]

Cluster Index: 18 --> 40 --> 18 --> 74 --> 17 --> 54 --> 70 --> 72 --> 10 --> 48/47
Cluster ID:    19 --> 41 --> 19 --> 75 --> 18 --> 55 --> 71 --> 73 --> 11 --> 49/48



path2=np.array([[18,34],[40,25],[40,44],[40,30],[18,29],[18,16],[74,6],[17,0],[54,1039],[70,654],[72,661],[10,664],[10,687],[10,871],[10,660],[10,941]])
path2_start_end=np.array([[18,40],[40,40],[40,40],[40,18],[18,18],[18,74],[74,17],[17,54],[54,70],[70,72],[72,10],[10,10],[10,10],[10,10],[10,10],[10,48]])
path2_Cluster=[18,40,40,40,18,18,74,17,54,70,72,10,10,10,10,10,48]

path2_new, path2_start_end_new, path2_Cluster_new = path_simplify(path2,path2_start_end,path2_Cluster)
path2_table_new, path2_data_new =summarize_path(path2_new,path2_Cluster_new)
path2_extract_dist=extract_path_data(path2_data_new, dist_data_update)
path2_extract_tica=extract_path_data(path2_data_new, tica_coord_output)
path2_extract_dist_concatenated = np.concatenate(path2_extract_dist)
path2_path_binnumber_dist, path2_path_energy_dist, path2_path_cluster_dist =extract_path_energy(path2_data_new,binnumber_dist,f_dist)
path2_path_binnumber_weight, path2_path_energy_weight, path2_path_cluster_weight =extract_path_energy(path2_data_new,binnumber_weight,f_weight)
path2_path_energy_bolas=extract_bolas_energy(path2_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path2_extract_dist_concatenated[:,0],path2_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path2.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path2_path_energy_dist))),path2_path_energy_dist, s=2, c=path2_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path2_path_energy_dist))),path2_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path2_path_energy_weight))),path2_path_energy_weight, s=2, c=path2_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path2_path_energy_weight))),path2_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path2_path_energy_bolas))),path2_path_energy_bolas, s=2, c=path2_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path2_path_energy_bolas))),path2_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path2.all.1003.png".format(nclusters),dpi=1200)




In [159]: path2_new                                                                                                               
Out[159]: 
array([[  18,   16],
       [  74,    6],
       [  17,    0],
       [  54, 1039],
       [  70,  654],
       [  72,  661],
       [  10,  941]])

In [160]: path2_start_end_new                                                                                                     
Out[160]: 
array([[18, 74],
       [74, 17],
       [17, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 48]])

In [161]: path2_Cluster_new                                                                                                       
Out[161]: [18, 74, 17, 54, 70, 72, 10, 48]


In [236]: path2_table_new                                                                                                         
Out[236]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_119_xpr1          900             18    TPS_2500_cp  gn_119_xpr2        100           74
1    TPS_2500_cp  gn_037_xpr1          478             74    TPS_2500_cp  gn_037_xpr2        251           17
2    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
3  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
4   TPS_27500_cp  gn_082_xpr2          295             70   TPS_27500_cp  gn_082_xpr1        705           72
5   TPS_27500_cp  gn_105_xpr1           96             72   TPS_27500_cp  gn_105_xpr2        757           10
6   TPS_37500_cp  gn_207_xpr1           29             10   TPS_37500_cp  gn_207_xpr1        651           48

In [237]: path2_data_new                                                                                                          
Out[237]: 
   Traj  Start  End  Order
0    16      0  999      1
1     6    999  271     -1
2     0      0  945      1
3  1039    999    0     -1
4   654      0  999      1
5   661    852    0     -1
6   941    622    0     -1



#%%%%%%%%%%%%%%%%% Plotting Path 3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



In [31]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                          
Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 175
Next Cluster 39
Cluster 39 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 714
Final
Out[31]: [1007, 1011, 995, 1012, 1010, 1009, 994, 117, 1043, 170, 175, 1061]

Cluster Index: 57 --> 22 --> 57 --> 22 --> 54 --> 5 --> 39 --> 70 --> 25
Cluster ID:    58 --> 23 --> 58 --> 23 --> 55 --> 6 --> 40 --> 71 --> 26



k=3
path3=np.array([[57,1007],[57,1011],[22,995],[22,1012],[57,1010],[22,1009],[22,994],[54,117],[54,1043],[54,170],[5,175],[39,1061],[70,714]])
path3_start_end=np.array([[57,57],[57,22],[22,22],[22,57],[57,22],[22,22],[22,54],[54,54],[54,54],[54,5],[5,39],[39,70],[70,25]])
path3_Cluster=[57,57,22,22,57,22,22,54,54,54,5,39,70,25]

path3_new, path3_start_end_new, path3_Cluster_new = path_simplify(path3,path3_start_end,path3_Cluster)
path3_table_new, path3_data_new =summarize_path(path3_new,path3_Cluster_new)
path3_extract_dist=extract_path_data(path3_data_new, dist_data_update)
path3_extract_tica=extract_path_data(path3_data_new, tica_coord_output)
path3_extract_dist_concatenated = np.concatenate(path3_extract_dist)
path3_path_binnumber_dist, path3_path_energy_dist, path3_path_cluster_dist =extract_path_energy(path3_data_new,binnumber_dist,f_dist)
path3_path_binnumber_weight, path3_path_energy_weight, path3_path_cluster_weight =extract_path_energy(path3_data_new,binnumber_weight,f_weight)
path3_path_energy_bolas=extract_bolas_energy(path3_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path3_extract_dist_concatenated[:,0],path3_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path3.1003.01222024.png".format(nclusters),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1003.01222024.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path3_path_energy_dist))),path3_path_energy_dist, s=2, c=path3_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path3_path_energy_dist))),path3_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path3_path_energy_weight))),path3_path_energy_weight, s=2, c=path3_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path3_path_energy_weight))),path3_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path3_path_energy_bolas))),path3_path_energy_bolas, s=2, c=path3_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path3_path_energy_bolas))),path3_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path3.all.1003.01222024.png".format(nclusters),dpi=1200)





In [152]: path3_new                                                                                                               
Out[152]: 
array([[  57, 1010],
       [  22,  994],
       [  54,  170],
       [   5,  175],
       [  39, 1061],
       [  70,  714]])

In [153]: path3_start_end_new                                                                                                     
Out[153]: 
array([[57, 22],
       [22, 54],
       [54,  5],
       [ 5, 39],
       [39, 70],
       [70, 25]])
       
In [241]: path3_Cluster_new                                                                                                       
Out[241]: [57, 22, 54, 5, 39, 70, 25]



In [239]: path3_table_new                                                                                                         
Out[239]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_223_xpr1          405             57   TPS_2500_cp_2  gn_223_xpr2        499           22
1   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
2       TPS_10000  gn_273_xpr2          265             54       TPS_10000  gn_273_xpr1        735            5
3       TPS_10000  gn_308_xpr2          727              5       TPS_10000  gn_308_xpr2        875           39
4  TPS_10000_cp_2  gn_176_xpr1          949             39  TPS_10000_cp_2  gn_176_xpr1        171           70
5       TPS_30000  gn_129_xpr2          499             70       TPS_30000  gn_129_xpr1        241           25

In [240]: path3_data_new                                                                                                          
Out[240]: 
   Traj  Start  End  Order
0  1010     96  999      1
1   994     48  999      1
2   170      0  999      1
3   175    837  985      1
4  1061      0  778      1
5   714      0  739      1



#%%%%%%%%%%%%%%%%% Plotting Path 4 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



In [52]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 1171
Next Cluster 27
Cluster 27 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 489
Final
Out[52]: [5, 0, 1040, 1171, 482, 1038]


Cluster Index: 17 --> 54 --> 70 --> 27 --> 70 --> 46/10
Cluster ID:    18 --> 55 --> 71 --> 28 --> 71 --> 47/11


path4=np.array([[17,5],[17,0],[54,1040],[70,1171],[27,482],[70,1038],[70,489]])
path4_start_end=np.array([[17,17],[17,54],[54,70],[70,27],[27,70],[70,70],[70,46]])
path4_Cluster=[17,17,54,70,27,70,70,46]

path4_new, path4_start_end_new, path4_Cluster_new = path_simplify(path4,path4_start_end,path4_Cluster)
path4_table_new, path4_data_new =summarize_path(path4_new,path4_Cluster_new)
path4_extract_dist=extract_path_data(path4_data_new, dist_data_update)
path4_extract_tica=extract_path_data(path4_data_new, tica_coord_output)
path4_extract_dist_concatenated = np.concatenate(path4_extract_dist)
path4_path_binnumber_dist, path4_path_energy_dist, path4_path_cluster_dist =extract_path_energy(path4_data_new,binnumber_dist,f_dist)
path4_path_binnumber_weight, path4_path_energy_weight, path4_path_cluster_weight =extract_path_energy(path4_data_new,binnumber_weight,f_weight)
path4_path_energy_bolas=extract_bolas_energy(path4_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path4_extract_dist_concatenated[:,0],path4_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path4.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path4_path_energy_dist))),path4_path_energy_dist, s=2, c=path4_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path4_path_energy_dist))),path4_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path4_path_energy_weight))),path4_path_energy_weight, s=2, c=path4_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path4_path_energy_weight))),path4_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path4_path_energy_bolas))),path4_path_energy_bolas, s=2, c=path4_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path4_path_energy_bolas))),path4_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path4.all.1003.png".format(nclusters),dpi=1200)






In [173]: path4_new                                                                                                               
Out[173]: 
array([[  17,    0],
       [  54, 1040],
       [  70,  489]])

In [174]: path4_start_end_new                                                                                                     
Out[174]: 
array([[17, 54],
       [54, 70],
       [70, 46]])


In [175]: path4_Cluster_new                                                                                                       
Out[175]: [17, 54, 70, 46]


In [243]: path4_table_new                                                                                                         
Out[243]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_117_xpr2          900             54  TPS_7500_cp_2  gn_117_xpr1         93           70
2   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46


In [244]: path4_data_new                                                                                                          
Out[244]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1040      0  992      1
2   489    999  173     -1



#%%%%%%%%%%%%%%%%% Plotting Path 5 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


In [22]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 22 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 70
Cluster 70 sampled by Traj 489
Next Cluster 10
Cluster 10 sampled by Traj 868
Next Cluster 59
Cluster 59 sampled by Traj 873
Next Cluster 59
Cluster 59 sampled by Traj 882
Next Cluster 59
Cluster 59 sampled by Traj 869
Next Cluster 10
Cluster 10 sampled by Traj 871
Next Cluster 10
Cluster 10 sampled by Traj 822
Next Cluster 10
Cluster 10 sampled by Traj 685
Next Cluster 32
Cluster 32 sampled by Traj 709
Next Cluster 11
Cluster 11 sampled by Traj 705
Next Cluster 32
Cluster 32 sampled by Traj 684
Next Cluster 10
Cluster 10 sampled by Traj 660
Next Cluster 72
Cluster 72 sampled by Traj 661
Next Cluster 72
Cluster 72 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 662
Next Cluster 10
Cluster 10 sampled by Traj 687
Next Cluster 10
Cluster 10 sampled by Traj 865
Next Cluster 10
Cluster 10 sampled by Traj 940
Next Cluster 48
Cluster 48 sampled by Traj 962
Final
Out[22]: 
[1010,
 1009,
 995,
 1031,
 1055,
 1039,
 1061,
 489,
 868,
 873,
 882,
 869,
 871,
 822,
 685,
 709,
 705,
 684,
 660,
 661,
 654,
 662,
 687,
 865,
 940]

Cluster Index: 22 --> 57 --> 22 --> 54 --> 70 --> 10 --> 59 --> 10 --> 32 --> 11 --> 32 --> 10 --> 72 --> 10 --> 48 --> 23 
Cluster ID:    23 --> 58 --> 23 --> 55 --> 71 --> 11 --> 60 --> 11 --> 33 --> 12 --> 33 --> 11 --> 73 --> 11 --> 49 --> 24



path5=np.array([[22,1010],[57,1009],[22,995],[54,1031],[54,1055],[54,1039],[70,1061],[70,489],[10,868],[59,873],[59,882],[59,869],[10,871],[10,822],[10,685],[32,709],[11,705],[32,684],[10,660],[72,661],[72,654],[72,662],[10,687],[10,865],[10,940],[48,962]])
path5_start_end=np.array([[22,57],[57,22],[22,54],[54,54],[54,54],[54,70],[70,70],[70,10],[10,59],[59,59],[59,59],[59,10],[10,10],[10,10],[10,32],[32,11],[11,32],[32,10],[10,72],[72,72],[72,72],[72,10],[10,10],[10,10],[10,48],[48,23]])
path5_Cluster=[22,57,22,54,54,54,70,70,10,59,59,59,10,10,10,32,11,32,10,72,72,72,10,10,10,48,23]

path5_new, path5_start_end_new, path5_Cluster_new = path_simplify(path5,path5_start_end,path5_Cluster)
path5_table_new, path5_data_new =summarize_path(path5_new,path5_Cluster_new)
path5_extract_dist=extract_path_data(path5_data_new, dist_data_update)
path5_extract_tica=extract_path_data(path5_data_new, tica_coord_output)
path5_extract_dist_concatenated = np.concatenate(path5_extract_dist)
path5_path_binnumber_dist, path5_path_energy_dist, path5_path_cluster_dist =extract_path_energy(path5_data_new,binnumber_dist,f_dist)
path5_path_binnumber_weight, path5_path_energy_weight, path5_path_cluster_weight =extract_path_energy(path5_data_new,binnumber_weight,f_weight)
path5_path_energy_bolas=extract_bolas_energy(path5_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path5_extract_dist_concatenated[:,0],path5_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path5.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path5_path_energy_dist))),path5_path_energy_dist, s=2, c=path5_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path5_path_energy_dist))),path5_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path5_path_energy_weight))),path5_path_energy_weight, s=2, c=path5_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path5_path_energy_weight))),path5_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path5_path_energy_bolas))),path5_path_energy_bolas, s=2, c=path5_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path5_path_energy_bolas))),path5_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path5.all.1003.png".format(nclusters),dpi=1200)


In [180]: path5_new                                                                                                               
Out[180]: 
array([[  22,  995],
       [  54, 1039],
       [  70,  489],
       [  10,  940],
       [  48,  962]])

In [197]: path5_start_end_new                                                                                                     
Out[197]: 
array([[22, 54],
       [54, 70],
       [70, 10],
       [10, 48],
       [48, 23]])

In [199]: path5_Cluster_new                                                                                                       
Out[199]: [22, 54, 70, 10, 48, 23]

In [248]: path5_table_new                                                                                                         
Out[248]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
2   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        792           10
3   TPS_37500_cp  gn_204_xpr1           96             10   TPS_37500_cp  gn_204_xpr2        904           48
4   TPS_37500_cp  gn_260_xpr2          254             48   TPS_37500_cp  gn_260_xpr1        478           23

In [249]: path5_data_new                                                                                                          
Out[249]: 
   Traj  Start  End  Order
0   995      0  965      1
1  1039    999    0     -1
2   489    999    0     -1
3   940    999    0     -1
4   962    999  268     -1




#%%%%%%%%%%%%%%%%% Plotting Path 6 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 70
Cluster 70 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 138
Next Cluster 68
Cluster 68 sampled by Traj 132
Next Cluster 1
Cluster 1 sampled by Traj 134
Next Cluster 1
Cluster 1 sampled by Traj 117
Next Cluster 70
Cluster 70 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 168
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 5
Cluster 5 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 173
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 55
Cluster 55 sampled by Traj 223
Next Cluster 24
Cluster 24 sampled by Traj 226
Next Cluster 24
Cluster 24 sampled by Traj 221
Next Cluster 62
Cluster 62 sampled by Traj 222
Next Cluster 55
Cluster 55 sampled by Traj 231
Next Cluster 55
Cluster 55 sampled by Traj 213
Next Cluster 70
Cluster 70 sampled by Traj 250
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 43
Cluster 43 sampled by Traj 812
Final

[1011,
 994, 367, 363, 361, 1136, 118, 138, 132, 134, 117, 159, 168, 160, 204, 186, 198, 190, 192, 183, 184, 173, 187, 181, 171, 174, 158, 1043, 175, 223, 226, 221, 222, 231, 213, 250, 808]


path6=np.array([[22,1011],[22,994],[54,367],[71,363],[71,361],[70,1136],[70,118],[1,138],[68,132],[1,134],[1,117],[70,159],[5,168],[69,160],[69,204],[20,186],[20,198],[20,190],[5,192],[20,183],[20,184],[69,173],[69,187],[5,181],[69,171],[5,174],[5,158],[34,1043],[54,175],[55,223],[24,226],[24,221],[62,222],[55,231],[55,213],[70,250],[70,808],[43,812]])
path6_start_end=np.array([[22,22],[22,54],[54,71],[71,71],[71,70],[70,70],[70,1],[1,68],[68,1],[1,1],[1,70],[70,5],[5,69],[69,69],[69,20],[20,20],[20,20],[20,5],[5,20],[20,20],[20,69],[69,69],[69,5],[5,69],[69,5],[5,5],[5,34],[34,54],[54,55],[55,24],[24,24],[24,62],[62,55],[55,55],[55,70],[70,70],[70,43],[43,10]])
path6_Cluster =[22,22,54,71,71,70,70,1,68,1,1,70,5,69,69,20,20,20,5,20,20,69,69,5,69,5,5,34,54,55,24,24,62,55,55,70,70,43,10]


path6_new, path6_start_end_new, path6_Cluster_new = path_simplify(path6,path6_start_end,path6_Cluster)
path6_table_new, path6_data_new =summarize_path(path6_new,path6_Cluster_new)
path6_extract_dist=extract_path_data(path6_data_new, dist_data_update)
path6_extract_tica=extract_path_data(path6_data_new, tica_coord_output)
path6_extract_dist_concatenated = np.concatenate(path6_extract_dist)
path6_path_binnumber_dist, path6_path_energy_dist, path6_path_cluster_dist =extract_path_energy(path6_data_new,binnumber_dist,f_dist)
path6_path_binnumber_weight, path6_path_energy_weight, path6_path_cluster_weight =extract_path_energy(path6_data_new,binnumber_weight,f_weight)
path6_path_energy_bolas=extract_bolas_energy(path6_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path6_extract_dist_concatenated[:,0],path6_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path6.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path6_path_energy_dist))),path6_path_energy_dist, s=2, c=path6_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path6_path_energy_dist))),path6_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path6_path_energy_weight))),path6_path_energy_weight, s=2, c=path6_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path6_path_energy_weight))),path6_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path6_path_energy_bolas))),path6_path_energy_bolas, s=2, c=path6_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path6_path_energy_bolas))),path6_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path6.all.1003.png".format(nclusters),dpi=1200)


In [201]: path6_new                                                                                                               
Out[201]: 
array([[ 22, 994],
       [ 54, 367],
       [ 71, 361],
       [ 70, 808],
       [ 43, 812]])

In [202]: path6_start_end_new                                                                                                     
Out[202]: 
array([[22, 54],
       [54, 71],
       [71, 70],
       [70, 43],
       [43, 10]])

In [203]: path6_Cluster_new                                                                                                       
Out[203]: [22, 54, 71, 70, 43, 10]

In [204]: path6_table_new                                                                                                         
Out[204]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_20000_cp  gn_073_xpr1          888             54   TPS_20000_cp  gn_073_xpr2         62           71
2   TPS_20000_cp  gn_024_xpr2          395             71   TPS_20000_cp  gn_024_xpr1        605           70
3   TPS_35000_cp  gn_049_xpr2          301             70   TPS_35000_cp  gn_049_xpr1        699           43
4   TPS_35000_cp  gn_072_xpr1          394             43   TPS_35000_cp  gn_072_xpr2        606           10

In [205]: path6_data_new                                                                                                          
Out[205]: 
   Traj  Start  End  Order
0   994     48  999      1
1   367     50  999      1
2   361    999    0     -1
3   808    999    0     -1
4   812    999    0     -1



#%%%%%%%%%%%%%%%%% Plotting Path 7 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 664
Final
[5, 6, 0, 654]

#cluster_NUMBER

[18,71,73]


path7=np.array([[17,5],[17,6],[17,0],[70,654],[72,664]])
path7_start_end=np.array([[17,17],[17,17],[17,70],[70,72],[72,10]])
path7_Cluster =[17,17,17,70,72,10]


path7_new, path7_start_end_new, path7_Cluster_new = path_simplify(path7,path7_start_end,path7_Cluster)
path7_table_new, path7_data_new =summarize_path(path7_new,path7_Cluster_new)
path7_extract_dist=extract_path_data(path7_data_new, dist_data_update)
path7_extract_tica=extract_path_data(path7_data_new, tica_coord_output)
path7_extract_dist_concatenated = np.concatenate(path7_extract_dist)
path7_path_binnumber_dist, path7_path_energy_dist, path7_path_cluster_dist =extract_path_energy(path7_data_new,binnumber_dist,f_dist)
path7_path_binnumber_weight, path7_path_energy_weight, path7_path_cluster_weight =extract_path_energy(path7_data_new,binnumber_weight,f_weight)
path7_path_energy_bolas=extract_bolas_energy(path7_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path7_extract_dist_concatenated[:,0],path7_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path7.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path7_path_energy_dist))),path7_path_energy_dist, s=2, c=path7_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path7_path_energy_dist))),path7_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path7_path_energy_weight))),path7_path_energy_weight, s=2, c=path7_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path7_path_energy_weight))),path7_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path7_path_energy_bolas))),path7_path_energy_bolas, s=2, c=path7_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path7_path_energy_bolas))),path7_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path7.all.1003.png".format(nclusters),dpi=1200)



In [209]: path7_new                                                                                                               
Out[209]: 
array([[ 17,   0],
       [ 70, 654],
       [ 72, 664]])

In [210]: path7_start_end_new                                                                                                     
Out[210]: 
array([[17, 70],
       [70, 72],
       [72, 10]])

In [211]: path7_Cluster_new                                                                                                       
Out[211]: [17, 70, 72, 10]

In [212]: path7_table_new                                                                                                         
Out[212]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_27500_cp  gn_082_xpr2          295             70  TPS_27500_cp  gn_082_xpr1        705           72
2  TPS_27500_cp  gn_121_xpr1          408             72  TPS_27500_cp  gn_121_xpr2        284           10

In [213]: path7_data_new                                                                                                          
Out[213]: 
   Traj  Start  End  Order
0     0      0  501      1
1   654      0  999      1
2   664    308  999      1




#%%%%%%%%%%%%%%%%% Plotting Path 8 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


Cluster 22 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 70
Cluster 70 sampled by Traj 1172
Next Cluster 27
Cluster 27 sampled by Traj 1178
Next Cluster 27
Cluster 27 sampled by Traj 1179
Next Cluster 27
Cluster 27 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 43
Cluster 43 sampled by Traj 812
Final

[1011, 1012, 995, 1038, 208, 1133, 1172, 1178, 1179, 1170, 808]


path8=np.array([[22,1011],[57,1012],[22,995],[54,1038],[54,208],[54,1133],[70,1172],[27,1178],[27,1179],[27,1170],[70,808],[43,812]])
path8_start_end=np.array([[22,57],[57,22],[22,54],[54,54],[54,54],[54,70],[70,27],[27,27],[27,27],[27,70],[70,43],[43,10]])
path8_Cluster =[22,57,22,54,54,54,70,27,27,27,70,43,10]


path8_new, path8_start_end_new, path8_Cluster_new = path_simplify(path8,path8_start_end,path8_Cluster)
path8_table_new, path8_data_new =summarize_path(path8_new,path8_Cluster_new)
path8_extract_dist=extract_path_data(path8_data_new, dist_data_update)
path8_extract_tica=extract_path_data(path8_data_new, tica_coord_output)
path8_extract_dist_concatenated = np.concatenate(path8_extract_dist)
path8_path_binnumber_dist, path8_path_energy_dist, path8_path_cluster_dist =extract_path_energy(path8_data_new,binnumber_dist,f_dist)
path8_path_binnumber_weight, path8_path_energy_weight, path8_path_cluster_weight =extract_path_energy(path8_data_new,binnumber_weight,f_weight)
path8_path_energy_bolas=extract_bolas_energy(path8_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path8_extract_dist_concatenated[:,0],path8_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path8.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path8_path_energy_dist))),path8_path_energy_dist, s=2, c=path8_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path8_path_energy_dist))),path8_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path8_path_energy_weight))),path8_path_energy_weight, s=2, c=path8_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path8_path_energy_weight))),path8_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path8_path_energy_bolas))),path8_path_energy_bolas, s=2, c=path8_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path8_path_energy_bolas))),path8_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path8.all.1003.png".format(nclusters),dpi=1200)



In [217]: path8_new                                                                                                               
Out[217]: 
array([[  22,  995],
       [  54, 1133],
       [  70,  808],
       [  43,  812]])

In [218]: path8_start_end_new                                                                                                     
Out[218]: 
array([[22, 54],
       [54, 70],
       [70, 43],
       [43, 10]])

In [219]: path8_Cluster_new                                                                                                       
Out[219]: [22, 54, 70, 43, 10]

In [220]: path8_table_new                                                                                                         
Out[220]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
1  TPS_15000_cp_2  gn_256_xpr1          333             54  TPS_15000_cp_2  gn_256_xpr1        940           70
2    TPS_35000_cp  gn_049_xpr2          301             70    TPS_35000_cp  gn_049_xpr1        699           43
3    TPS_35000_cp  gn_072_xpr1          394             43    TPS_35000_cp  gn_072_xpr2        606           10

In [221]: path8_data_new                                                                                                          
Out[221]: 
   Traj  Start  End  Order
0   995      0  965      1
1  1133    607    0     -1
2   808    999    0     -1
3   812    999    0     -1




#%%%%%%%%%%%%%%%%% Plotting Path 9 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




Cluster 18 sampled by Traj 16
Next Cluster 74
Cluster 74 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 930
Final


[16, 5, 0, 1038]


#Cluster_NUMBER
[19,75,18,55,71,11]



path9=np.array([[18,16],[74,5],[17,0],[54,1038],[70,930]])
path9_start_end=np.array([[18,74],[74,17],[17,54],[54,70],[70,10]])
path9_Cluster =[18,74,17,54,70,10]



path9_new, path9_start_end_new, path9_Cluster_new = path_simplify(path9,path9_start_end,path9_Cluster)
path9_table_new, path9_data_new =summarize_path(path9_new,path9_Cluster_new)
path9_extract_dist=extract_path_data(path9_data_new, dist_data_update)
path9_extract_tica=extract_path_data(path9_data_new, tica_coord_output)
path9_extract_dist_concatenated = np.concatenate(path9_extract_dist)
path9_path_binnumber_dist, path9_path_energy_dist, path9_path_cluster_dist =extract_path_energy(path9_data_new,binnumber_dist,f_dist)
path9_path_binnumber_weight, path9_path_energy_weight, path9_path_cluster_weight =extract_path_energy(path9_data_new,binnumber_weight,f_weight)
path9_path_energy_bolas=extract_bolas_energy(path9_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path9_extract_dist_concatenated[:,0],path9_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path9.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path9_path_energy_dist))),path9_path_energy_dist, s=2, c=path9_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path9_path_energy_dist))),path9_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path9_path_energy_weight))),path9_path_energy_weight, s=2, c=path9_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path9_path_energy_weight))),path9_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path9_path_energy_bolas))),path9_path_energy_bolas, s=2, c=path9_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path9_path_energy_bolas))),path9_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path9.all.1003.png".format(nclusters),dpi=1200)



In [224]: path9_new                                                                                                               
Out[224]: 
array([[  18,   16],
       [  74,    5],
       [  17,    0],
       [  54, 1038],
       [  70,  930]])

In [225]: path9_start_end_new                                                                                                     
Out[225]: 
array([[18, 74],
       [74, 17],
       [17, 54],
       [54, 70],
       [70, 10]])

In [226]: path9_Cluster_new                                                                                                       
Out[226]: [18, 74, 17, 54, 70, 10]

In [227]: path9_table_new                                                                                                         
Out[227]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_119_xpr1          900             18    TPS_2500_cp  gn_119_xpr2        100           74
1    TPS_2500_cp  gn_029_xpr1          736             74    TPS_2500_cp  gn_029_xpr2        264           17
2    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
3  TPS_7500_cp_2  gn_014_xpr1          849             54  TPS_7500_cp_2  gn_014_xpr2         33           70
4   TPS_37500_cp  gn_090_xpr1          185             70   TPS_37500_cp  gn_090_xpr2        815           10

In [228]: path9_data_new                                                                                                          
Out[228]: 
   Traj  Start  End  Order
0    16      0  999      1
1     5      0  999      1
2     0      0  945      1
3  1038      0  881      1
4   930    999    0     -1




#%%%%%%%%%%%%%%%%% Plotting Path 10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



Cluster 18 sampled by Traj 30
Next Cluster 40
Cluster 40 sampled by Traj 35
Next Cluster 56
Cluster 56 sampled by Traj 45
Next Cluster 56
Cluster 56 sampled by Traj 49
Next Cluster 56
Cluster 56 sampled by Traj 46
Next Cluster 56
Cluster 56 sampled by Traj 44
Next Cluster 40
Cluster 40 sampled by Traj 38
Next Cluster 40
Cluster 40 sampled by Traj 36
Next Cluster 40
Cluster 40 sampled by Traj 34
Next Cluster 40
Cluster 40 sampled by Traj 39
Next Cluster 56
Cluster 56 sampled by Traj 75
Next Cluster 56
Cluster 56 sampled by Traj 47
Next Cluster 56
Cluster 56 sampled by Traj 32
Next Cluster 40
Cluster 40 sampled by Traj 20
Next Cluster 40
Cluster 40 sampled by Traj 33
Next Cluster 40
Cluster 40 sampled by Traj 25
Next Cluster 40
Cluster 40 sampled by Traj 29
Next Cluster 18
Cluster 18 sampled by Traj 18
Next Cluster 74
Cluster 74 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 372
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 489
Final
Out[128]: 
[30, 35, 45, 49, 46, 44, 38, 36, 34, 39, 75, 47, 32, 20, 33, 25, 29, 18, 5, 0, 118, 367, 272, 372, 363, 362, 361]

#Cluster_NUMBER
[19,41,57,41,57,41,19,75,18,55,72,71]



path10=np.array([[18,30],[40,35],[56,45],[56,49],[56,46],[56,44],[40,38],[40,36],[40,34],[40,39],[56,75],[56,47],[56,32],[40,20],[40,33],[40,25],[40,29],[18,18],[74,5],[17,0],[54,118],[54,367],[71,272],[71,372],[71,363],[71,362],[71,361],[70,489]])
path10_start_end=np.array([[18,40],[40,56],[56,56],[56,56],[56,56],[56,40],[40,40],[40,40],[40,40],[40,56],[56,56],[56,56],[56,40],[40,40],[40,40],[40,40],[40,18],[18,74],[74,17],[17,54],[54,54],[54,71],[71,71],[71,71],[71,71],[71,71],[71,70],[70,46]])
path10_Cluster =[18,40,56,56,56,56,40,40,40,40,56,56,56,40,40,40,40,18,74,17,54,54,71,71,71,71,71,70,46]


path10_new, path10_start_end_new, path10_Cluster_new = path_simplify(path10,path10_start_end,path10_Cluster)
path10_table_new, path10_data_new =summarize_path(path10_new,path10_Cluster_new)
path10_extract_dist=extract_path_data(path10_data_new, dist_data_update)
path10_extract_tica=extract_path_data(path10_data_new, tica_coord_output)
path10_extract_dist_concatenated = np.concatenate(path10_extract_dist)
path10_path_binnumber_dist, path10_path_energy_dist, path10_path_cluster_dist =extract_path_energy(path10_data_new,binnumber_dist,f_dist)
path10_path_binnumber_weight, path10_path_energy_weight, path10_path_cluster_weight =extract_path_energy(path10_data_new,binnumber_weight,f_weight)
path10_path_energy_bolas=extract_bolas_energy(path10_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path10_extract_dist_concatenated[:,0],path10_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path10.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path10_path_energy_dist))),path10_path_energy_dist, s=2, c=path10_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path10_path_energy_dist))),path10_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path10_path_energy_weight))),path10_path_energy_weight, s=2, c=path10_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path10_path_energy_weight))),path10_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path10_path_energy_bolas))),path10_path_energy_bolas, s=2, c=path10_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path10_path_energy_bolas))),path10_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path10.all.1003.png".format(nclusters),dpi=1200)



In [242]: path10_new                                                                                                              
Out[242]: 
array([[ 18,  18],
       [ 74,   5],
       [ 17,   0],
       [ 54, 367],
       [ 71, 361],
       [ 70, 489]])

In [243]: path10_start_end_new                                                                                                    
Out[243]: 
array([[18, 74],
       [74, 17],
       [17, 54],
       [54, 71],
       [71, 70],
       [70, 46]])

In [244]: path10_Cluster_new                                                                                                      
Out[244]: [18, 74, 17, 54, 71, 70, 46]

In [245]: path10_data_new                                                                                                         
Out[245]: 
   Traj  Start  End  Order
0    18      0  985      1
1     5      0  999      1
2     0      0  945      1
3   367     50  999      1
4   361    999    0     -1
5   489    999  173     -1

In [246]: path10_table_new                                                                                                        
Out[246]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_165_xpr2          499             18   TPS_2500_cp  gn_165_xpr1        487           74
1   TPS_2500_cp  gn_029_xpr1          736             74   TPS_2500_cp  gn_029_xpr2        264           17
2   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
3  TPS_20000_cp  gn_073_xpr1          888             54  TPS_20000_cp  gn_073_xpr2         62           71
4  TPS_20000_cp  gn_024_xpr2          395             71  TPS_20000_cp  gn_024_xpr1        605           70
5  TPS_22500_cp  gn_029_xpr2          208             70  TPS_22500_cp  gn_029_xpr1        619           46




#%%%%%%%%%%%%%%%%% Plotting Path 11 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


#Cluster_NUMBER
[23,55,19,41,57,22,57,22,57,41,19,75,18,55,72,2,72,71,35,6,21,70,6,70,6,21,70,21,6,71,40,71,44]


Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 28
Next Cluster 18
Cluster 18 sampled by Traj 34
Next Cluster 40
Cluster 40 sampled by Traj 33
Next Cluster 40
Cluster 40 sampled by Traj 35
Next Cluster 56
Cluster 56 sampled by Traj 36
Next Cluster 56
Cluster 56 sampled by Traj 62
Next Cluster 56
Cluster 56 sampled by Traj 45
Next Cluster 21
Cluster 21 sampled by Traj 48
Next Cluster 56
Cluster 56 sampled by Traj 49
Next Cluster 21
Cluster 21 sampled by Traj 75
Next Cluster 56
Cluster 56 sampled by Traj 50
Next Cluster 21
Cluster 21 sampled by Traj 61
Next Cluster 56
Cluster 56 sampled by Traj 38
Next Cluster 40
Cluster 40 sampled by Traj 32
Next Cluster 56
Cluster 56 sampled by Traj 64
Next Cluster 56
Cluster 56 sampled by Traj 44
Next Cluster 40
Cluster 40 sampled by Traj 30
Next Cluster 18
Cluster 18 sampled by Traj 25
Next Cluster 18
Cluster 18 sampled by Traj 16
Next Cluster 74
Cluster 74 sampled by Traj 18
Next Cluster 74
Cluster 74 sampled by Traj 5
Next Cluster 74
Cluster 74 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 136
Next Cluster 1
Cluster 1 sampled by Traj 377
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 158
Next Cluster 5
Cluster 5 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 69
Cluster 69 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 189
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 69
Cluster 69 sampled by Traj 160
Next Cluster 69
Cluster 69 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 191
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 20
Cluster 20 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 171
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 252
Next Cluster 70
Cluster 70 sampled by Traj 1061
Next Cluster 39
Cluster 39 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 43
Cluster 43 sampled by Traj 812
Final
Out[131]: 
[1012, 1011, 1007, 995, 1010, 994, 979, 28, 34, 33, 35, 36, 62, 45, 48, 49, 75, 50, 61, 38, 32, 64, 44, 30, 25, 16, 18, 5, 6, 0, 367, 118, 136, 377, 362, 1041, 158, 192, 186, 188, 175, 183, 168, 181, 189, 176, 160, 170, 191, 190, 204, 198, 185, 184, 187, 171, 173, 483, 174, 159, 1055, 252, 1061, 1060, 808]


path11=np.array([[22,1012],[22,1011],[22,1007],[22,995],[22,1010],[22,994],[54,979],[54,28],[18,34],[40,33],[40,35],[56,36],[56,62],[56,45],[21,48],[56,49],[21,75],[56,50],[21,61],[56,38],[40,32],[56,64],[56,44],[40,30],[18,25],[18,16],[74,18],[74,5],[74,6],[17,0],[54,367],[71,118],[1,136],[1,377],[71,362],[70,1041],[34,158],[5,192],[20,186],[69,188],[69,175],[69,183],[69,168],[5,181],[5,189],[5,176],[69,160],[69,170],[5,191],[20,190],[20,204],[20,198],[20,185],[20,184],[69,187],[20,171],[5,173],[5,483],[5,174],[5,159],[70,1055],[70,252],[70,1061],[39,1060],[70,808],[43,812]])
path11_start_end=np.array([[22 , 22],[22 , 22],[22 , 22],[22 , 22],[22 , 22],[22 , 54],[54 , 54],[54 , 18],[18 , 40],[40 , 40],[40 , 56],[56 , 56],[56 , 56],[56 , 21],[21 , 56],[56 , 21],[21 , 56],[56 , 21],[21 , 56],[56 , 40],[40 , 56],[56 , 56],[56 , 40],[40 , 18],[18 , 18],[18 , 74],[74 , 74],[74 , 74],[74 , 17],[17 , 54],[54 , 71],[71 , 1],[1 , 1],[1 , 71],[71 , 70],[70 , 34],[34 , 5],[5 , 20],[20 , 69],[69 , 69],[69 , 69],[69 , 69],[69 , 5],[5 , 5],[5 , 5],[5 , 69],[69 , 69],[69 , 5],[5 , 20],[20 , 20],[20 , 20],[20 , 20],[20 , 20],[20 , 69],[69 , 20],[20 , 5],[5 , 5],[5 , 5],[5 , 5],[5 , 70],[70 , 70],[70 , 70],[70 , 39],[39 , 70],[70 , 43],[43, 10]])
path11_Cluster =[22,22,22,22,22,22,54,54,18,40,40,56,56,56,21,56,21,56,21,56,40,56,56,40,18,18,74,74,74,17,54,71,1,1,71,70,34,5,20,69,69,69,69,5,5,5,69,69,5,20,20,20,20,20,69,20,5,5,5,5,70,70,70,39,70,43,10]



path11_new, path11_start_end_new, path11_Cluster_new = path_simplify(path11,path11_start_end,path11_Cluster)
path11_table_new, path11_data_new =summarize_path(path11_new,path11_Cluster_new)
path11_extract_dist=extract_path_data(path11_data_new, dist_data_update)
path11_extract_tica=extract_path_data(path11_data_new, tica_coord_output)
path11_extract_dist_concatenated = np.concatenate(path11_extract_dist)
path11_path_binnumber_dist, path11_path_energy_dist, path11_path_cluster_dist =extract_path_energy(path11_data_new,binnumber_dist,f_dist)
path11_path_binnumber_weight, path11_path_energy_weight, path11_path_cluster_weight =extract_path_energy(path11_data_new,binnumber_weight,f_weight)
path11_path_energy_bolas=extract_bolas_energy(path11_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path11_extract_dist_concatenated[:,0],path11_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path11.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path11_path_energy_dist))),path11_path_energy_dist, s=2, c=path11_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path11_path_energy_dist))),path11_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path11_path_energy_weight))),path11_path_energy_weight, s=2, c=path11_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path11_path_energy_weight))),path11_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path11_path_energy_bolas))),path11_path_energy_bolas, s=2, c=path11_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path11_path_energy_bolas))),path11_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path11.all.1003.png".format(nclusters),dpi=1200)




In [250]: path11_new                                                                                                              
Out[250]: 
array([[ 22, 994],
       [ 54, 367],
       [ 71, 362],
       [ 70, 808],
       [ 43, 812]])

In [251]: path11_start_end_new                                                                                                    
Out[251]: 
array([[22, 54],
       [54, 71],
       [71, 70],
       [70, 43],
       [43, 10]])

In [252]: path11_Cluster_new                                                                                                      
Out[252]: [22, 54, 71, 70, 43, 10]

In [253]: path11_data_new                                                                                                         
Out[253]: 
   Traj  Start  End  Order
0   994     48  999      1
1   367     50  999      1
2   362    985    1     -1
3   808    999    0     -1
4   812    999    0     -1

In [254]: path11_table_new                                                                                                        
Out[254]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_20000_cp  gn_073_xpr1          888             54   TPS_20000_cp  gn_073_xpr2         62           71
2   TPS_20000_cp  gn_030_xpr2          144             71   TPS_20000_cp  gn_030_xpr1        841           70
3   TPS_35000_cp  gn_049_xpr2          301             70   TPS_35000_cp  gn_049_xpr1        699           43
4   TPS_35000_cp  gn_072_xpr1          394             43   TPS_35000_cp  gn_072_xpr2        606           10






#%%%%%%%%%%%%%%%%% Plotting Path 12 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



In [62]: cluster_path=get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 27
Cluster 27 sampled by Traj 1182
Next Cluster 42
Cluster 42 sampled by Traj 1179
Next Cluster 42
Cluster 42 sampled by Traj 1194
Next Cluster 29
Cluster 29 sampled by Traj 1201
Final

In [63]: cluster_path                                                                                                                                                                         
Out[63]: [994, 1133, 362, 1171, 1182, 1179, 1194]


path12=np.array([[22,994],[54,1133],[54,362],[71,1171],[27,1182],[42,1179],[42,1194],[29,1201]])
path12_start_end=np.array([[22 ,54],[54 ,54],[54 ,71],[71 ,27],[27 ,42],[42 ,42],[42 ,29],[29,60]])
path12_Cluster = [22,54,54,71,27,42,42,29,60]


path12_new, path12_start_end_new, path12_Cluster_new = path_simplify(path12,path12_start_end,path12_Cluster)
path12_table_new, path12_data_new =summarize_path(path12_new,path12_Cluster_new)
path12_extract_dist=extract_path_data(path12_data_new, dist_data_update)
path12_extract_tica=extract_path_data(path12_data_new, tica_coord_output)
path12_extract_dist_concatenated = np.concatenate(path12_extract_dist)
path12_path_binnumber_dist, path12_path_energy_dist, path12_path_cluster_dist =extract_path_energy(path12_data_new,binnumber_dist,f_dist)
path12_path_binnumber_weight, path12_path_energy_weight, path12_path_cluster_weight =extract_path_energy(path12_data_new,binnumber_weight,f_weight)
path12_path_energy_bolas=extract_bolas_energy(path12_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path12_extract_dist_concatenated[:,0],path12_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path12.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path12_path_energy_dist))),path12_path_energy_dist, s=2, c=path12_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path12_path_energy_dist))),path12_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path12_path_energy_weight))),path12_path_energy_weight, s=2, c=path12_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path12_path_energy_weight))),path12_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path12_path_energy_bolas))),path12_path_energy_bolas, s=2, c=path12_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path12_path_energy_bolas))),path12_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path12.all.1003.png".format(nclusters),dpi=1200)


In [228]: path12_new                                                                                                              
Out[228]: 
array([[  22,  994],
       [  54,  362],
       [  71, 1171],
       [  27, 1182],
       [  42, 1194],
       [  29, 1201]])

In [229]: path12_start_end_new                                                                                                    
Out[229]: 
array([[22, 54],
       [54, 71],
       [71, 27],
       [27, 42],
       [42, 29],
       [29, 60]])

In [230]: path12_Cluster_new                                                                                                      
Out[230]: [22, 54, 71, 27, 42, 29, 60]

In [231]: path12_table_new                                                                                                        
Out[231]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1    TPS_20000_cp  gn_030_xpr1          842             54    TPS_20000_cp  gn_030_xpr2        144           71
2  TPS_20000_cp_2  gn_060_xpr1          524             71  TPS_20000_cp_2  gn_060_xpr1        386           27
3  TPS_20000_cp_2  gn_144_xpr2          277             27  TPS_20000_cp_2  gn_144_xpr1        622           42
4  TPS_20000_cp_2  gn_239_xpr1          501             42  TPS_20000_cp_2  gn_239_xpr2        499           29
5  TPS_20000_cp_2  gn_258_xpr2          174             29  TPS_20000_cp_2  gn_258_xpr1        786           60

In [232]: path12_data_new                                                                                                         
Out[232]: 
   Traj  Start  End  Order
0   994     48  999      1
1   362      0  985      1
2  1171     35  173      1
3  1182    898    0     -1
4  1194    999    0     -1
5  1201    959    0     -1



#%%%%%%%%%%%%%%%%% Plotting Path 13 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



In [46]: cluster_path=get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 1133
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 1056
Next Cluster 70
Cluster 70 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 3
Cluster 3 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 372
Next Cluster 64
Cluster 64 sampled by Traj 380
Next Cluster 14
Cluster 14 sampled by Traj 396
Next Cluster 30
Cluster 30 sampled by Traj 412
Next Cluster 7
Cluster 7 sampled by Traj 429
Next Cluster 8
Cluster 8 sampled by Traj 415
Next Cluster 30
Cluster 30 sampled by Traj 397
Next Cluster 14
Cluster 14 sampled by Traj 383
Next Cluster 64
Cluster 64 sampled by Traj 377
Next Cluster 1
Cluster 1 sampled by Traj 136
Next Cluster 1
Cluster 1 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 70
Cluster 70 sampled by Traj 1170
Next Cluster 70
Cluster 70 sampled by Traj 808
Next Cluster 70
Cluster 70 sampled by Traj 483
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 20
Cluster 20 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 20
Cluster 20 sampled by Traj 190
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 188
Next Cluster 20
Cluster 20 sampled by Traj 171
Next Cluster 69
Cluster 69 sampled by Traj 170
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 174
Next Cluster 69
Cluster 69 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 69
Cluster 69 sampled by Traj 168
Next Cluster 5
Cluster 5 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 272
Next Cluster 70
Cluster 70 sampled by Traj 930
Final

In [48]: cluster_path                                                                                                                                                                         
Out[48]: 
[6,
 0,
 1133,
 1055,
 1056,
 117,
 76,
 77,
 989,
 367,
 362,
 372,
 380,
 396,
 412,
 429,
 415,
 397,
 383,
 377,
 136,
 118,
 1029,
 595,
 1170,
 808,
 483,
 187,
 183,
 185,
 190,
 184,
 188,
 171,
 170,
 176,
 174,
 186,
 192,
 198,
 204,
 168,
 175,
 272]
 
 
path13=np.array([[17,6],[17,0],[70,1133],[54,1055],[54,1056],[70,117],[54,76],[3,77],[54,989],[54,367],[71,362],[71,372],[64,380],[14,396],[30,412],[7,429],[8,415],[30,397],[14,383],[64,377],[1,136],[1,118],[54,1029],[70,595],[70,1170],[70,808],[70,483],[5,187],[20,183],[69,185],[20,190],[20,184],[69,188],[20,171],[69,170],[69,176],[5,174],[69,186],[69,192],[20,198],[69,204],[69,168],[5,175],[70,272],[70,930]])
path13_start_end=np.array([[17 ,17],[17 ,70],[70 ,54],[54 ,54],[54 ,70],[70 ,54],[54 ,3],[3 ,54],[54 ,54],[54 ,71],[71 ,71],[71 ,64],[64 ,14],[14 ,30],[30 ,7],[7 ,8],[8 ,30],[30 ,14],[14 ,64],[64 ,1],[1 ,1],[1 ,54],[54 ,70],[70 ,70],[70 ,70],[70 ,70],[70 ,5],[5 ,20],[20 ,69],[69 ,20],[20 ,20],[20 ,69],[69 ,20],[20 ,69],[69 ,69],[69 ,5],[5 ,69],[69 ,69],[69 ,20],[20 ,69],[69 ,69],[69 ,5],[5 ,70],[70 ,70],[70,10 ]])
path13_Cluster = [17,17,70,54,54,70,54,3,54,54,71,71,64,14,30,7,8,30,14,64,1,1,54,70,70,70,70,5,20,69,20,20,69,20,69,69,5,69,69,20,69,69,5,70,70,10]
 
 
path13_new, path13_start_end_new, path13_Cluster_new = path_simplify(path13,path13_start_end,path13_Cluster)
path13_table_new, path13_data_new =summarize_path(path13_new,path13_Cluster_new)
path13_extract_dist=extract_path_data(path13_data_new, dist_data_update)
path13_extract_tica=extract_path_data(path13_data_new, tica_coord_output)
path13_extract_dist_concatenated = np.concatenate(path13_extract_dist)
path13_path_binnumber_dist, path13_path_energy_dist, path13_path_cluster_dist =extract_path_energy(path13_data_new,binnumber_dist,f_dist)
path13_path_binnumber_weight, path13_path_energy_weight, path13_path_cluster_weight =extract_path_energy(path13_data_new,binnumber_weight,f_weight)
path13_path_energy_bolas=extract_bolas_energy(path13_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path13_extract_dist_concatenated[:,0],path13_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path13.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path13_path_energy_dist))),path13_path_energy_dist, s=2, c=path13_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path13_path_energy_dist))),path13_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path13_path_energy_weight))),path13_path_energy_weight, s=2, c=path13_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path13_path_energy_weight))),path13_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path13_path_energy_bolas))),path13_path_energy_bolas, s=2, c=path13_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path13_path_energy_bolas))),path13_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path13.all.1003.png".format(nclusters),dpi=1200)


In [236]: path13_new                                                                                                              
Out[236]: 
array([[ 17,   0],
       [ 70, 930]])

In [237]: path13_start_end_new                                                                                                    
Out[237]: 
array([[17, 70],
       [70, 10]])

In [238]: path13_Cluster_new                                                                                                      
Out[238]: [17, 70, 10]

In [239]: path13_table_new                                                                                                        
Out[239]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_37500_cp  gn_090_xpr1          185             70  TPS_37500_cp  gn_090_xpr2        815           10

In [240]: path13_data_new                                                                                                         
Out[240]: 
   Traj  Start  End  Order
0     0      0  501      1
1   930    999    0     -1




#%%%%%%%%%%%%%%%%% Plotting Path 14 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

 
 
 

In [49]: cluster_path=get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 35
Cluster 35 sampled by Traj 603
Final

In [50]: cluster_path                                                                                                                                                                         
Out[50]: [1012, 1011, 1007, 1009, 995, 28, 1029, 1040, 1039, 595]


path14=np.array([[22,1012],[22,1011],[57,1007],[22,1009],[22,995],[54,28],[54,1029],[70,1040],[54,1039],[70,595],[35,603]])
path14_start_end=np.array([[22 ,22],[22 ,57],[57 ,22],[22 ,22],[22 ,54],[54 ,54],[54 ,70],[70 ,54],[54 ,70],[70 ,35],[35,15 ]])
path14_Cluster = [22,22,57,22,22,54,54,70,54,70,35,15]

path14_new, path14_start_end_new, path14_Cluster_new = path_simplify(path14,path14_start_end,path14_Cluster)
path14_table_new, path14_data_new =summarize_path(path14_new,path14_Cluster_new)
path14_extract_dist=extract_path_data(path14_data_new, dist_data_update)
path14_extract_tica=extract_path_data(path14_data_new, tica_coord_output)
path14_extract_dist_concatenated = np.concatenate(path14_extract_dist)
path14_path_binnumber_dist, path14_path_energy_dist, path14_path_cluster_dist =extract_path_energy(path14_data_new,binnumber_dist,f_dist)
path14_path_binnumber_weight, path14_path_energy_weight, path14_path_cluster_weight =extract_path_energy(path14_data_new,binnumber_weight,f_weight)
path14_path_energy_bolas=extract_bolas_energy(path14_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path14_extract_dist_concatenated[:,0],path14_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path14.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path14_path_energy_dist))),path14_path_energy_dist, s=2, c=path14_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path14_path_energy_dist))),path14_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path14_path_energy_weight))),path14_path_energy_weight, s=2, c=path14_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path14_path_energy_weight))),path14_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path14_path_energy_bolas))),path14_path_energy_bolas, s=2, c=path14_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path14_path_energy_bolas))),path14_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path14.all.1003.png".format(nclusters),dpi=1200)




In [281]: path14_new                                                                                                              
Out[281]: 
array([[  22,  995],
       [  54, 1039],
       [  70,  595],
       [  35,  603]])

In [282]: path14_start_end_new                                                                                                    
Out[282]: 
array([[22, 54],
       [54, 70],
       [70, 35],
       [35, 15]])

In [283]: path14_Cluster_new                                                                                                      
Out[283]: [22, 54, 70, 35, 15]

In [284]: path14_table_new                                                                                                        
Out[284]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_152_xpr2          934             22  TPS_2500_cp_2  gn_152_xpr1         32           54
1  TPS_7500_cp_2  gn_112_xpr1          715             54  TPS_7500_cp_2  gn_112_xpr2        285           70
2      TPS_25000  gn_170_xpr2          110             70      TPS_25000  gn_170_xpr1        890           35
3      TPS_25000  gn_189_xpr1          244             35      TPS_25000  gn_189_xpr2        756           15

In [285]: path14_data_new                                                                                                         
Out[285]: 
   Traj  Start  End  Order
0   995      0  965      1
1  1039    999    0     -1
2   595    999    0     -1
3   603    999    0     -1





#%%%%%%%%%%%%%%%%% Plotting Path 15 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 



In [41]: cluster_path=get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                
Cluster 18 sampled by Traj 20
Next Cluster 18
Cluster 18 sampled by Traj 18
Next Cluster 18
Cluster 18 sampled by Traj 30
Next Cluster 40
Cluster 40 sampled by Traj 25
Next Cluster 40
Cluster 40 sampled by Traj 44
Next Cluster 40
Cluster 40 sampled by Traj 39
Next Cluster 40
Cluster 40 sampled by Traj 33
Next Cluster 40
Cluster 40 sampled by Traj 35
Next Cluster 56
Cluster 56 sampled by Traj 75
Next Cluster 21
Cluster 21 sampled by Traj 45
Next Cluster 21
Cluster 21 sampled by Traj 47
Next Cluster 56
Cluster 56 sampled by Traj 48
Next Cluster 21
Cluster 21 sampled by Traj 62
Next Cluster 56
Cluster 56 sampled by Traj 61
Next Cluster 56
Cluster 56 sampled by Traj 49
Next Cluster 21
Cluster 21 sampled by Traj 46
Next Cluster 56
Cluster 56 sampled by Traj 64
Next Cluster 56
Cluster 56 sampled by Traj 32
Next Cluster 40
Cluster 40 sampled by Traj 34
Next Cluster 18
Cluster 18 sampled by Traj 16
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 595
Next Cluster 35
Cluster 35 sampled by Traj 604
Final


path15=np.array([[18,20],[18,18],[18,30],[40,25],[40,44],[40,39],[40,33],[40,35],[56,75],[21,45],[21,47],[56,48],[21,62],[56,61],[56,49],[21,46],[56,64],[56,32],[40,34],[18,16],[18,28],[54,1040],[54,367],[54,1039],[54,271],[70,361],[70,595],[35,604]])
path15_start_end=np.array([[18,18],[18,18],[18,40],[40,40],[40,40],[40,40],[40,40],[40,56],[56,21],[21,21],[21,56],[56,21],[21,56],[56,56],[56,21],[21,56],[56,56],[56,40],[40,18],[18,18],[18,54],[54,54],[54,54],[54,54],[54,70],[70,70],[70,35],[35,15 ]])
path15_Cluster = [18,18,18,40,40,40,40,40,56,21,21,56,21,56,56,21,56,56,40,18,18,54,54,54,54,70,70,35,15]

path15_new, path15_start_end_new, path15_Cluster_new = path_simplify(path15,path15_start_end,path15_Cluster)
path15_table_new, path15_data_new =summarize_path(path15_new,path15_Cluster_new)
path15_extract_dist=extract_path_data(path15_data_new, dist_data_update)
path15_extract_tica=extract_path_data(path15_data_new, tica_coord_output)
path15_extract_dist_concatenated = np.concatenate(path15_extract_dist)
path15_path_binnumber_dist, path15_path_energy_dist, path15_path_cluster_dist =extract_path_energy(path15_data_new,binnumber_dist,f_dist)
path15_path_binnumber_weight, path15_path_energy_weight, path15_path_cluster_weight =extract_path_energy(path15_data_new,binnumber_weight,f_weight)
path15_path_energy_bolas=extract_bolas_energy(path15_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path15_extract_dist_concatenated[:,0],path15_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path15.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path15_path_energy_dist))),path15_path_energy_dist, s=2, c=path15_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path15_path_energy_dist))),path15_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path15_path_energy_weight))),path15_path_energy_weight, s=2, c=path15_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path15_path_energy_weight))),path15_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path15_path_energy_bolas))),path15_path_energy_bolas, s=2, c=path15_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path15_path_energy_bolas))),path15_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path15.all.1003.png".format(nclusters),dpi=1200)



In [276]: path15_new                                                                                                              
Out[276]: 
array([[ 18,  28],
       [ 54, 271],
       [ 70, 595],
       [ 35, 604]])

In [277]: path15_start_end_new                                                                                                    
Out[277]: 
array([[18, 54],
       [54, 70],
       [70, 35],
       [35, 15]])

In [278]: path15_Cluster_new                                                                                                      
Out[278]: [18, 54, 70, 35, 15]

In [279]: path15_table_new                                                                                                        
Out[279]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_199_xpr2          165             18   TPS_2500_cp  gn_199_xpr1        766           54
1  TPS_17500_cp  gn_064_xpr1          363             54  TPS_17500_cp  gn_064_xpr2        204           70
2     TPS_25000  gn_170_xpr2          110             70     TPS_25000  gn_170_xpr1        890           35
3     TPS_25000  gn_192_xpr1          384             35     TPS_25000  gn_192_xpr2        616           15

In [280]: path15_data_new                                                                                                         
Out[280]: 
   Traj  Start  End  Order
0    28    999   69     -1
1   271    433  999      1
2   595    999    0     -1
3   604      0  999      1




#%%%%%%%%%%%%%%%%% Plotting Path 16 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 


In [29]: cluster_path=get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 86
Next Cluster 3
Cluster 3 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 70
Cluster 70 sampled by Traj 490
Final


path16=np.array([[17,0],[54,77],[3,86],[3,989],[54,1031],[54,1038],[70,651],[70,490]])
path16_start_end=np.array([[17,54],[54,3],[3,3],[3,54],[54,54],[54,70],[70,70],[70,46]])
path16_Cluster = [17,54,3,3,54,54,70,70,46]

path16_new, path16_start_end_new, path16_Cluster_new = path_simplify(path16,path16_start_end,path16_Cluster)
path16_table_new, path16_data_new =summarize_path(path16_new,path16_Cluster_new)
path16_extract_dist=extract_path_data(path16_data_new, dist_data_update)
path16_extract_tica=extract_path_data(path16_data_new, tica_coord_output)
path16_extract_dist_concatenated = np.concatenate(path16_extract_dist)
path16_path_binnumber_dist, path16_path_energy_dist, path16_path_cluster_dist =extract_path_energy(path16_data_new,binnumber_dist,f_dist)
path16_path_binnumber_weight, path16_path_energy_weight, path16_path_cluster_weight =extract_path_energy(path16_data_new,binnumber_weight,f_weight)
path16_path_energy_bolas=extract_bolas_energy(path16_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path16_extract_dist_concatenated[:,0],path16_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path16.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path16_path_energy_dist))),path16_path_energy_dist, s=2, c=path16_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path16_path_energy_dist))),path16_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path16_path_energy_weight))),path16_path_energy_weight, s=2, c=path16_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path16_path_energy_weight))),path16_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path16_path_energy_bolas))),path16_path_energy_bolas, s=2, c=path16_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path16_path_energy_bolas))),path16_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path16.all.1003.png".format(nclusters),dpi=1200)


In [271]: path16_new                                                                                                              
Out[271]: 
array([[  17,    0],
       [  54, 1038],
       [  70,  490]])

In [272]: path16_start_end_new                                                                                                    
Out[272]: 
array([[17, 54],
       [54, 70],
       [70, 46]])

In [273]: path16_Cluster_new                                                                                                      
Out[273]: [17, 54, 70, 46]

In [274]: path16_table_new                                                                                                        
Out[274]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_7500_cp_2  gn_014_xpr1          849             54  TPS_7500_cp_2  gn_014_xpr2         33           70
2   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [275]: path16_data_new                                                                                                         
Out[275]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1038      0  881      1
2   490    356  999      1





#%%%%%%%%%%%%%%%%% Plotting Path 17 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 


In [14]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                          
Cluster 18 sampled by Traj 20
Next Cluster 40
Cluster 40 sampled by Traj 34
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final
Out[14]: [20, 34, 28, 170, 1041]

Cluster Index: 18 --> 40 --> 18 --> 54 --> 34 --> 38
Cluster ID:    19 --> 41 --> 19 --> 55 --> 35 --> 39


path17=np.array([[18,20],[40,34],[18,28],[54,170],[54,1041],[34,1095]])
path17_start_end=np.array([[18,40],[40,18],[18,54],[54,54],[54,34],[34,38 ]])
path17_Cluster = [18,40,18,54,54,34,38]


path17_new, path17_start_end_new, path17_Cluster_new = path_simplify(path17,path17_start_end,path17_Cluster)
path17_table_new, path17_data_new =summarize_path(path17_new,path17_Cluster_new)
path17_extract_dist=extract_path_data(path17_data_new, dist_data_update)
path17_extract_tica=extract_path_data(path17_data_new, tica_coord_output)
path17_extract_dist_concatenated = np.concatenate(path17_extract_dist)
path17_path_binnumber_dist, path17_path_energy_dist, path17_path_cluster_dist =extract_path_energy(path17_data_new,binnumber_dist,f_dist)
path17_path_binnumber_weight, path17_path_energy_weight, path17_path_cluster_weight =extract_path_energy(path17_data_new,binnumber_weight,f_weight)
path17_path_energy_bolas=extract_bolas_energy(path17_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path17_extract_dist_concatenated[:,0],path17_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path17.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path17_path_energy_dist))),path17_path_energy_dist, s=2, c=path17_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path17_path_energy_dist))),path17_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path17_path_energy_weight))),path17_path_energy_weight, s=2, c=path17_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path17_path_energy_weight))),path17_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path17_path_energy_bolas))),path17_path_energy_bolas, s=2, c=path17_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path17_path_energy_bolas))),path17_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path17.all.1003.png".format(nclusters),dpi=1200)



In [266]: path17_new                                                                                                              
Out[266]: 
array([[  18,   28],
       [  54, 1041],
       [  34, 1095]])

In [267]: path17_start_end_new                                                                                                    
Out[267]: 
array([[18, 54],
       [54, 34],
       [34, 38]])

In [268]: path17_Cluster_new                                                                                                      
Out[268]: [18, 54, 34, 38]

In [269]: path17_table_new                                                                                                        
Out[269]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_199_xpr2          165             18     TPS_2500_cp  gn_199_xpr1        766           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [270]: path17_data_new                                                                                                         
Out[270]: 
   Traj  Start  End  Order
0    28    999   69     -1
1  1041      0  973      1
2  1095    999    0     -1




#%%%%%%%%%%%%%%%%% Plotting Path 18 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 





In [21]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                          
Cluster 57 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final
Out[21]: [1011, 1012, 1010, 1009, 1007, 995, 1041]

Cluster Index: 57 --> 22 --> 57 --> 22 --> 57 --> 22 --> 54 --> 34 --> 38
Cluster ID:    58 --> 23 --> 58 --> 23 --> 58 --> 23 --> 55 --> 35 --> 39


path18=np.array([[57,1011],[22,1012],[57,1010],[22,1009],[57,1007],[22,995],[54,1041],[34,1097]])
path18_start_end=np.array([[57,22],[22,57],[57,22],[22,57],[57,22],[22,54],[54,34],[34,38]])
path18_Cluster = [57,22,57,22,57,22,54,34,38]


path18_new, path18_start_end_new, path18_Cluster_new = path_simplify(path18,path18_start_end,path18_Cluster)





path18_new=np.array([[  57, 1007],[  22,  995],[  54, 1041],[  34, 1097]])
path18_start_end_new=np.array([[57, 22],[22, 54],[54, 34],[34, 38]])
path18_Cluster_new=[57, 22, 54, 34, 38]


k=18
path18_table_new, path18_data_new =summarize_path(path18_new,path18_Cluster_new)
path18_extract_dist=extract_path_data(path18_data_new, dist_data_update)
path18_extract_tica=extract_path_data(path18_data_new, tica_coord_output)
path18_extract_dist_concatenated = np.concatenate(path18_extract_dist)
path18_path_binnumber_dist, path18_path_energy_dist, path18_path_cluster_dist =extract_path_energy(path18_data_new,binnumber_dist,f_dist)
path18_path_binnumber_weight, path18_path_energy_weight, path18_path_cluster_weight =extract_path_energy(path18_data_new,binnumber_weight,f_weight)
path18_path_energy_bolas=extract_bolas_energy(path18_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path18_extract_dist_concatenated[:,0],path18_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path18.1003.01222024.png".format(nclusters),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1003.01222024.png".format(nclusters,k),dpi=1200)



fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path18_path_energy_dist))),path18_path_energy_dist, s=2, c=path18_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path18_path_energy_dist))),path18_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path18_path_energy_weight))),path18_path_energy_weight, s=2, c=path18_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path18_path_energy_weight))),path18_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path18_path_energy_bolas))),path18_path_energy_bolas, s=2, c=path18_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path18_path_energy_bolas))),path18_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path18.all.1003.01222024.png".format(nclusters),dpi=1200)



In [261]: path18_new                                                                                                              
Out[261]: 
array([[  57, 1007],
       [  22,  995],
       [  54, 1041],
       [  34, 1097]])

In [262]: path18_start_end_new                                                                                                    
Out[262]: 
array([[57, 22],
       [22, 54],
       [54, 34],
       [34, 38]])

In [263]: path18_Cluster_new                                                                                                      
Out[263]: [57, 22, 54, 34, 38]

In [264]: path18_table_new                                                                                                        
Out[264]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_219_xpr2          836             57   TPS_2500_cp_2  gn_219_xpr1        159           22
1   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
2   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
3  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [265]: path18_data_new                                                                                                         
Out[265]: 
   Traj  Start  End  Order
0  1007      5  999      1
1   995      0  965      1
2  1041      0  973      1
3  1097      0  999      1





#%%%%%%%%%%%%%%%%% Plotting Path 19 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 



In [24]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                          
Cluster 17 sampled by Traj 6
Next Cluster 17
Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1121
Final
Out[24]: [6, 5, 0, 1039, 1041]

Cluster Index: 17 --> 54 --> 34 --> 38/33
Cluster ID:    18 --> 55 --> 35 --> 39/34


path19=np.array([[17,6],[17,5],[17,0],[54,1039],[54,1041],[34,1121]])
path19_start_end=np.array([[17,17],[17,17],[17,54],[54,54],[54,34],[34,38]])
path19_Cluster = [17,17,17,54,54,34,38]

path19_new, path19_start_end_new, path19_Cluster_new = path_simplify(path19,path19_start_end,path19_Cluster)
path19_table_new, path19_data_new =summarize_path(path19_new,path19_Cluster_new)
path19_extract_dist=extract_path_data(path19_data_new, dist_data_update)
path19_extract_tica=extract_path_data(path19_data_new, tica_coord_output)
path19_extract_dist_concatenated = np.concatenate(path19_extract_dist)
path19_path_binnumber_dist, path19_path_energy_dist, path19_path_cluster_dist =extract_path_energy(path19_data_new,binnumber_dist,f_dist)
path19_path_binnumber_weight, path19_path_energy_weight, path19_path_cluster_weight =extract_path_energy(path19_data_new,binnumber_weight,f_weight)
path19_path_energy_bolas=extract_bolas_energy(path19_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path19_extract_dist_concatenated[:,0],path19_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path19.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path19_path_energy_dist))),path19_path_energy_dist, s=2, c=path19_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path19_path_energy_dist))),path19_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path19_path_energy_weight))),path19_path_energy_weight, s=2, c=path19_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path19_path_energy_weight))),path19_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path19_path_energy_bolas))),path19_path_energy_bolas, s=2, c=path19_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path19_path_energy_bolas))),path19_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path19.all.1003.png".format(nclusters),dpi=1200)



In [22]: path19_new                                                                                                               
Out[22]: 
array([[  17,    0],
       [  54, 1041],
       [  34, 1121]])

In [23]: path19_start_end_new                                                                                                     
Out[23]: 
array([[17, 54],
       [54, 34],
       [34, 38]])

In [24]: path19_Cluster_new                                                                                                       
Out[24]: [17, 54, 34, 38]

In [25]: path19_table_new                                                                                                         
Out[25]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_284_xpr1          547             34  TPS_12500_cp_2  gn_284_xpr1        467           38

In [26]: path19_data_new                                                                                                          
Out[26]: 
   Traj  Start  End  Order
0     0      0  945      1
1  1041      0  973      1
2  1121     14   94      1



#%%%%%%%%%%%%%%%%% Plotting Path 20 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 


In [42]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                          
Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 715
Final
Out[42]: [1007, 1009, 994, 208]


Cluster Index: 57 --> 22 --> 54 --> 70 --> 25
Cluster ID:    58 --> 23 --> 55 --> 71 --> 26


path20=np.array([[57,1007],[57,1009],[22,994],[54,208],[70,715]])
path20_start_end=np.array([[57,57],[57,22],[22,54],[54,70],[70, 25]])
path20_Cluster = [57,57,22,54,70,25]



path20_new, path20_start_end_new, path20_Cluster_new = path_simplify(path20,path20_start_end,path20_Cluster)
path20_table_new, path20_data_new =summarize_path(path20_new,path20_Cluster_new)
path20_extract_dist=extract_path_data(path20_data_new, dist_data_update)
path20_extract_tica=extract_path_data(path20_data_new, tica_coord_output)
path20_extract_dist_concatenated = np.concatenate(path20_extract_dist)
path20_path_binnumber_dist, path20_path_energy_dist, path20_path_cluster_dist =extract_path_energy(path20_data_new,binnumber_dist,f_dist)
path20_path_binnumber_weight, path20_path_energy_weight, path20_path_cluster_weight =extract_path_energy(path20_data_new,binnumber_weight,f_weight)
path20_path_energy_bolas=extract_bolas_energy(path20_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path20_extract_dist_concatenated[:,0],path20_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path20.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path20_path_energy_dist))),path20_path_energy_dist, s=2, c=path20_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path20_path_energy_dist))),path20_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path20_path_energy_weight))),path20_path_energy_weight, s=2, c=path20_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path20_path_energy_weight))),path20_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path20_path_energy_bolas))),path20_path_energy_bolas, s=2, c=path20_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path20_path_energy_bolas))),path20_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path20.all.1003.png".format(nclusters),dpi=1200)



In [30]: path20_new                                                                                                               
Out[30]: 
array([[  57, 1009],
       [  22,  994],
       [  54,  208],
       [  70,  715]])

In [31]: path20_start_end_new                                                                                                     
Out[31]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 25]])

In [32]: path20_Cluster_new                                                                                                       
Out[32]: [57, 22, 54, 70, 25]

In [33]: path20_data_new                                                                                                          
Out[33]: 
   Traj  Start  End  Order
0  1009    233  999      1
1   994     48  999      1
2   208     57  999      1
3   715    999    0     -1

In [34]: path20_table_new                                                                                                         
Out[34]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_222_xpr1          341             57  TPS_2500_cp_2  gn_222_xpr2        426           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2      TPS_12500  gn_011_xpr1          726             54      TPS_12500  gn_011_xpr2        217           70
3      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25





#%%%%%%%%%%%%%%%%% Plotting Path 21 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In [29]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1044
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 662
Next Cluster 72
Cluster 72 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 930
Next Cluster 70
Cluster 70 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 3
Cluster 3 sampled by Traj 989
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 118
Next Cluster 1
Cluster 1 sampled by Traj 137
Next Cluster 1
Cluster 1 sampled by Traj 140
Next Cluster 68
Cluster 68 sampled by Traj 117
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 70
Cluster 70 sampled by Traj 490
Final
Out[29]: 
[1012,
 1010,
 1011,
 994,
 1044,
 1056,
 1038,
 1134,
 662,
 664,
 930,
 0,
 362,
 367,
 1031,
 77,
 989,
 76,
 118,
 137,
 140,
 117,
 175]


Cluster Index: 22 --> 54 --> 70 --> 54 --> 70 --> 72 --> 10 --> 70 --> 54 --> 3 --> 54 --> 1 --> 68 --> 54 --> 70 --> 46
Cluster ID:    23 --> 55 --> 71 --> 55 --> 71 --> 73 --> 11 --> 71 --> 55 --> 4 --> 55 --> 2 --> 69 --> 55 --> 71 --> 47



path21=np.array([[22,1012],[22,1010],[22,1011],[22,994],[54,1044],[70,1056],[54,1038],[70,1134],[70,662],[72,664],[10,930],[70,0],[54,362],[54,367],[54,1031],[54,77],[3,989],[54,76],[54,118],[1,137],[1,140],[68,117],[54,175],[70,490]])
path21_start_end=np.array([[22,22],[22,22],[22,22],[22,54],[54,70],[70,54],[54,70],[70,70],[70,72],[72,10],[10,70],[70,54],[54,54],[54,54],[54,54],[54,3],[3,54],[54,54],[54,1],[1,1],[1,68],[68,54],[54,70],[70, 46]])
path21_Cluster = [22,22,22,22,54,70,54,70,70,72,10,70,54,54,54,54,3,54,54,1,1,68,54,70,46]


path21_new, path21_start_end_new, path21_Cluster_new = path_simplify(path21,path21_start_end,path21_Cluster)
path21_table_new, path21_data_new =summarize_path(path21_new,path21_Cluster_new)
path21_extract_dist=extract_path_data(path21_data_new, dist_data_update)
path21_extract_tica=extract_path_data(path21_data_new, tica_coord_output)
path21_extract_dist_concatenated = np.concatenate(path21_extract_dist)
path21_path_binnumber_dist, path21_path_energy_dist, path21_path_cluster_dist =extract_path_energy(path21_data_new,binnumber_dist,f_dist)
path21_path_binnumber_weight, path21_path_energy_weight, path21_path_cluster_weight =extract_path_energy(path21_data_new,binnumber_weight,f_weight)
path21_path_energy_bolas=extract_bolas_energy(path21_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path21_extract_dist_concatenated[:,0],path21_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path21.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path21_path_energy_dist))),path21_path_energy_dist, s=2, c=path21_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path21_path_energy_dist))),path21_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path21_path_energy_weight))),path21_path_energy_weight, s=2, c=path21_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path21_path_energy_weight))),path21_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path21_path_energy_bolas))),path21_path_energy_bolas, s=2, c=path21_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path21_path_energy_bolas))),path21_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path21.all.1003.png".format(nclusters),dpi=1200)



In [87]: path21_new                                                                                                               
Out[87]: 
array([[ 22, 994],
       [ 54, 175],
       [ 70, 490]])

In [88]: path21_start_end_new                                                                                                     
Out[88]: 
array([[22, 54],
       [54, 70],
       [70, 46]])

In [89]: path21_Cluster_new                                                                                                       
Out[89]: [22, 54, 70, 46]

In [90]: path21_table_new                                                                                                         
Out[90]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
1      TPS_10000  gn_308_xpr2          729             54      TPS_10000  gn_308_xpr2        738           70
2   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [91]: path21_data_new                                                                                                          
Out[91]: 
   Traj  Start  End  Order
0   994     48  999      1
1   175    839  848      1
2   490    356  999      1





#%%%%%%%%%%%%%%%%% Plotting Path 22 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In [43]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 18 sampled by Traj 20
Next Cluster 18
Cluster 18 sampled by Traj 30
Next Cluster 40
Cluster 40 sampled by Traj 33
Next Cluster 40
Cluster 40 sampled by Traj 29
Next Cluster 40
Cluster 40 sampled by Traj 35
Next Cluster 56
Cluster 56 sampled by Traj 47
Next Cluster 56
Cluster 56 sampled by Traj 50
Next Cluster 21
Cluster 21 sampled by Traj 62
Next Cluster 56
Cluster 56 sampled by Traj 44
Next Cluster 56
Cluster 56 sampled by Traj 75
Next Cluster 56
Cluster 56 sampled by Traj 38
Next Cluster 56
Cluster 56 sampled by Traj 63
Next Cluster 56
Cluster 56 sampled by Traj 32
Next Cluster 56
Cluster 56 sampled by Traj 36
Next Cluster 40
Cluster 40 sampled by Traj 25
Next Cluster 40
Cluster 40 sampled by Traj 34
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 715
Final
Out[43]: [20, 30, 33, 29, 35, 47, 50, 62, 44, 75, 38, 63, 32, 36, 25, 34, 28, 1038]


Cluster Index: 18 --> 40 --> 56 --> 21 --> 56 --> 40 --> 18 --> 54 --> 70 --> 25
Cluster ID:    19 --> 41 --> 57 --> 22 --> 57 --> 41 --> 19 --> 55 --> 71 --> 26


path22=np.array([[18,20],[18,30],[40,33],[40,29],[40,35],[56,47],[56,50],[21,62],[56,44],[56,75],[56,38],[56,63],[56,32],[56,36],[40,25],[40,34],[18,28],[54,1038],[70,715]])
path22_start_end=np.array([[18,18],[18,40],[40,40],[40,40],[40,56],[56,56],[56,21],[21,56],[56,56],[56,56],[56,56],[56,56],[56,56],[56,40],[40,40],[40,18],[18,54],[54,70],[70,25 ]])
path22_Cluster = [18,18,40,40,40,56,56,21,56,56,56,56,56,56,40,40,18,54,70,25]


path22_new, path22_start_end_new, path22_Cluster_new = path_simplify(path22,path22_start_end,path22_Cluster)
path22_table_new, path22_data_new =summarize_path(path22_new,path22_Cluster_new)
path22_extract_dist=extract_path_data(path22_data_new, dist_data_update)
path22_extract_tica=extract_path_data(path22_data_new, tica_coord_output)
path22_extract_dist_concatenated = np.concatenate(path22_extract_dist)
path22_path_binnumber_dist, path22_path_energy_dist, path22_path_cluster_dist =extract_path_energy(path22_data_new,binnumber_dist,f_dist)
path22_path_binnumber_weight, path22_path_energy_weight, path22_path_cluster_weight =extract_path_energy(path22_data_new,binnumber_weight,f_weight)
path22_path_energy_bolas=extract_bolas_energy(path22_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path22_extract_dist_concatenated[:,0],path22_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path22.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path22_path_energy_dist))),path22_path_energy_dist, s=2, c=path22_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path22_path_energy_dist))),path22_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path22_path_energy_weight))),path22_path_energy_weight, s=2, c=path22_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path22_path_energy_weight))),path22_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path22_path_energy_bolas))),path22_path_energy_bolas, s=2, c=path22_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path22_path_energy_bolas))),path22_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path22.all.1003.png".format(nclusters),dpi=1200)


In [101]: path22_new                                                                                                              
Out[101]: 
array([[  18,   28],
       [  54, 1038],
       [  70,  715]])

In [102]: path22_start_end_new                                                                                                    
Out[102]: 
array([[18, 54],
       [54, 70],
       [70, 25]])

In [103]: path22_Cluster_new                                                                                                      
Out[103]: [18, 54, 70, 25]

In [104]: path22_table_new                                                                                                        
Out[104]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_199_xpr2          165             18    TPS_2500_cp  gn_199_xpr1        766           54
1  TPS_7500_cp_2  gn_014_xpr1          849             54  TPS_7500_cp_2  gn_014_xpr2         33           70
2      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [105]: path22_data_new                                                                                                         
Out[105]: 
   Traj  Start  End  Order
0    28    999   69     -1
1  1038      0  881      1
2   715    999    0     -1




#%%%%%%%%%%%%%%%%% Plotting Path 23 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



In [44]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 271
Next Cluster 70
Cluster 70 sampled by Traj 1056
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1121
Final
Out[44]: [995, 271, 1056, 1029, 367, 208, 1041, 158]


Cluster Index: 22 --> 54 --> 70 --> 54 --> 34 --> 38/33
Cluster ID:    23 --> 55 --> 71 --> 55 --> 35 --> 39/34


path23=np.array([[22,995],[54,271],[70,1056],[54,1029],[54,367],[54,208],[54,1041],[34,158],[34,1121]])
path23_start_end=np.array([[22,54],[54,70],[70,54],[54,54],[54,54],[54,54],[54,34],[34,34],[34,38 ]])
path23_Cluster = [22,54,70,54,54,54,54,34,34,38]


path23_new, path23_start_end_new, path23_Cluster_new = path_simplify(path23,path23_start_end,path23_Cluster)
path23_table_new, path23_data_new =summarize_path(path23_new,path23_Cluster_new)
path23_extract_dist=extract_path_data(path23_data_new, dist_data_update)
path23_extract_tica=extract_path_data(path23_data_new, tica_coord_output)
path23_extract_dist_concatenated = np.concatenate(path23_extract_dist)
path23_path_binnumber_dist, path23_path_energy_dist, path23_path_cluster_dist =extract_path_energy(path23_data_new,binnumber_dist,f_dist)
path23_path_binnumber_weight, path23_path_energy_weight, path23_path_cluster_weight =extract_path_energy(path23_data_new,binnumber_weight,f_weight)
path23_path_energy_bolas=extract_bolas_energy(path23_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path23_extract_dist_concatenated[:,0],path23_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path23.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path23_path_energy_dist))),path23_path_energy_dist, s=2, c=path23_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path23_path_energy_dist))),path23_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path23_path_energy_weight))),path23_path_energy_weight, s=2, c=path23_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path23_path_energy_weight))),path23_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path23_path_energy_bolas))),path23_path_energy_bolas, s=2, c=path23_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path23_path_energy_bolas))),path23_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path23.all.1003.png".format(nclusters),dpi=1200)


In [109]: path23_new                                                                                                              
Out[109]: 
array([[  22,  995],
       [  54, 1041],
       [  34, 1121]])

In [110]: path23_start_end_new                                                                                                    
Out[110]: 
array([[22, 54],
       [54, 34],
       [34, 38]])

In [111]: path23_Cluster_new                                                                                                      
Out[111]: [22, 54, 34, 38]

In [112]: path23_table_new                                                                                                        
Out[112]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_284_xpr1          547             34  TPS_12500_cp_2  gn_284_xpr1        467           38

In [113]: path23_data_new                                                                                                         
Out[113]: 
   Traj  Start  End  Order
0   995      0  965      1
1  1041      0  973      1
2  1121     14   94      1



#%%%%%%%%%%%%%%%%% Plotting Path 24 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


In [54]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1084
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final
Out[54]: [994, 362, 1041, 1084]

Cluster Index: 22 --> 54 --> 34 --> 38
Cluster ID:    23 --> 55 --> 35 --> 39


k=24
path24=np.array([[22,994],[54,362],[54,1041],[34,1084],[34,1095]])
path24_start_end=np.array([[22,54],[54,54],[54,34],[34,34],[34,38]])
path24_Cluster = [22,54,54,34,34,38]


path24_new, path24_start_end_new, path24_Cluster_new = path_simplify(path24,path24_start_end,path24_Cluster)
path24_table_new, path24_data_new =summarize_path(path24_new,path24_Cluster_new)
path24_extract_dist=extract_path_data(path24_data_new, dist_data_update)
path24_extract_tica=extract_path_data(path24_data_new, tica_coord_output)
path24_extract_dist_concatenated = np.concatenate(path24_extract_dist)
path24_path_binnumber_dist, path24_path_energy_dist, path24_path_cluster_dist =extract_path_energy(path24_data_new,binnumber_dist,f_dist)
path24_path_binnumber_weight, path24_path_energy_weight, path24_path_cluster_weight =extract_path_energy(path24_data_new,binnumber_weight,f_weight)
path24_path_energy_bolas=extract_bolas_energy(path24_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path24_extract_dist_concatenated[:,0],path24_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path24.1003.01222024.png".format(nclusters),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1003.01222024.png".format(nclusters,k),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path24_extract_dist_concatenated[:,0],path24_extract_dist_concatenated[:,1], markersize=1,fillstyle='none', color='pink', marker="o", mew=0.6, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1003.02222024.larger.png".format(nclusters,k),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path24_path_energy_dist))),path24_path_energy_dist, s=2, c=path24_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path24_path_energy_dist))),path24_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path24_path_energy_weight))),path24_path_energy_weight, s=2, c=path24_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path24_path_energy_weight))),path24_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path24_path_energy_bolas))),path24_path_energy_bolas, s=2, c=path24_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path24_path_energy_bolas))),path24_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path24.all.1003.01222024.png".format(nclusters),dpi=1200)




fig, ax = plt.subplots(figsize=(7, 3))
ax.scatter(list(range(len(path24_path_energy_bolas))),path24_path_energy_bolas, s=2, c=path24_path_cluster_dist, marker="o",zorder=2)
ax.plot(list(range(len(path24_path_energy_bolas))),path24_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
ax.set_xlabel('Path',fontsize=16, fontweight='bold')
ax.set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
ax.set_title('BOLAS', fontweight='bold',fontsize=16)
ax.tick_params(axis='both', labelsize=12)
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path24.all.1003.01222024.larger.png".format(nclusters),dpi=1200)


fig, ax = plt.subplots(figsize=(7, 3))
ax.scatter(list(range(len(path24_path_energy_bolas))),path24_path_energy_bolas, s=2, c='#ec2b7c', marker="o",zorder=2)
ax.plot(list(range(len(path24_path_energy_bolas))),path24_path_energy_bolas, c='#ec2b7c', linewidth=0.3,zorder=1)
ax.set_xlabel('Path',fontsize=16, fontweight='bold')
ax.set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
ax.set_title('BOLAS', fontweight='bold',fontsize=16)
ax.tick_params(axis='both', labelsize=12)
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path24.all.1003.020824.larger.png".format(nclusters),dpi=1200)


path_cluster_d=pd.DataFrame(path24_path_cluster_dist)
path_cluster_d.to_csv("Path_list.lag=100.cluster={}.coord.region3.path24.all.1003.022224.csv".format(nclusters))


In [117]: path24_new                                                                                                              
Out[117]: 
array([[  22,  994],
       [  54, 1041],
       [  34, 1095]])

In [118]: path24_start_end_new                                                                                                    
Out[118]: 
array([[22, 54],
       [54, 34],
       [34, 38]])

In [119]: path24_Cluster_new                                                                                                      
Out[119]: [22, 54, 34, 38]

In [120]: path24_table_new                                                                                                        
Out[120]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [121]: path24_data_new                                                                                                         
Out[121]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1041      0  973      1
2  1095    999    0     -1






#%%%%%%%%%%%%%%%%% Plotting Path 25 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



In [56]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 34
Cluster 34 sampled by Traj 1095
Final
Out[56]: [0, 979, 158]

Cluster Index: 17 --> 54 --> 5 --> 34 --> 38
Cluster ID:    18 --> 55 --> 6 --> 35 --> 39


path25=np.array([[17,0],[54,979],[5,158],[34,1095]])
path25_start_end=np.array([[17,54],[54,5],[5,34],[34,38]])
path25_Cluster = [17,54,5,34,38]


path25_new, path25_start_end_new, path25_Cluster_new = path_simplify(path25,path25_start_end,path25_Cluster)
path25_table_new, path25_data_new =summarize_path(path25_new,path25_Cluster_new)
path25_extract_dist=extract_path_data(path25_data_new, dist_data_update)
path25_extract_tica=extract_path_data(path25_data_new, tica_coord_output)
path25_extract_dist_concatenated = np.concatenate(path25_extract_dist)
path25_path_binnumber_dist, path25_path_energy_dist, path25_path_cluster_dist =extract_path_energy(path25_data_new,binnumber_dist,f_dist)
path25_path_binnumber_weight, path25_path_energy_weight, path25_path_cluster_weight =extract_path_energy(path25_data_new,binnumber_weight,f_weight)
path25_path_energy_bolas=extract_bolas_energy(path25_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path25_extract_dist_concatenated[:,0],path25_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path25.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path25_path_energy_dist))),path25_path_energy_dist, s=2, c=path25_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path25_path_energy_dist))),path25_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path25_path_energy_weight))),path25_path_energy_weight, s=2, c=path25_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path25_path_energy_weight))),path25_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path25_path_energy_bolas))),path25_path_energy_bolas, s=2, c=path25_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path25_path_energy_bolas))),path25_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path25.all.1003.png".format(nclusters),dpi=1200)


In [125]: path25_new                                                                                                              
Out[125]: 
array([[  17,    0],
       [  54,  979],
       [   5,  158],
       [  34, 1095]])

In [126]: path25_start_end_new                                                                                                    
Out[126]: 
array([[17, 54],
       [54,  5],
       [ 5, 34],
       [34, 38]])

In [127]: path25_Cluster_new                                                                                                      
Out[127]: [17, 54, 5, 34, 38]

In [128]: path25_table_new                                                                                                        
Out[128]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0     TPS_2500_cp  gn_017_xpr1          672             17     TPS_2500_cp  gn_017_xpr2        274           54
1   TPS_2500_cp_2  gn_004_xpr2           69             54   TPS_2500_cp_2  gn_004_xpr1        410            5
2       TPS_10000  gn_158_xpr2           85              5       TPS_10000  gn_158_xpr1        754           34
3  TPS_12500_cp_2  gn_192_xpr2           75             34  TPS_12500_cp_2  gn_192_xpr1        925           38

In [129]: path25_data_new                                                                                                         
Out[129]: 
   Traj  Start  End  Order
0     0      0  945      1
1   979      0  478      1
2   158    999  161     -1
3  1095    999    0     -1




#%%%%%%%%%%%%%%%%% Plotting Path 26 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



In [70]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 57 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1084
Next Cluster 34
Cluster 34 sampled by Traj 1121
Final
Out[70]: [1009, 1007, 1010, 1011, 1012, 994, 979, 208, 1084]

Cluster Index: 57 --> 22 --> 57 --> 22 --> 54 --> 70 --> 34 --> 38/33
Cluster ID:    58 --> 23 --> 58 --> 23 --> 55 --> 71 --> 35 --> 39/34


path26=np.array([[57,1009],[22,1007],[57,1010],[22,1011],[22,1012],[22,994],[54,979],[54,208],[70,1084],[34,1121]])
path26_start_end=np.array([[57,22],[22,57],[57,22],[22,22],[22,22],[22,54],[54,54],[54,70],[70,34],[34,38]])
path26_Cluster = [57,22,57,22,22,22,54,54,70,34,38]

path26_new, path26_start_end_new, path26_Cluster_new = path_simplify(path26,path26_start_end,path26_Cluster)
path26_table_new, path26_data_new =summarize_path(path26_new,path26_Cluster_new)
path26_extract_dist=extract_path_data(path26_data_new, dist_data_update)
path26_extract_tica=extract_path_data(path26_data_new, tica_coord_output)
path26_extract_dist_concatenated = np.concatenate(path26_extract_dist)
path26_path_binnumber_dist, path26_path_energy_dist, path26_path_cluster_dist =extract_path_energy(path26_data_new,binnumber_dist,f_dist)
path26_path_binnumber_weight, path26_path_energy_weight, path26_path_cluster_weight =extract_path_energy(path26_data_new,binnumber_weight,f_weight)
path26_path_energy_bolas=extract_bolas_energy(path26_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path26_extract_dist_concatenated[:,0],path26_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path26.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path26_path_energy_dist))),path26_path_energy_dist, s=2, c=path26_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path26_path_energy_dist))),path26_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path26_path_energy_weight))),path26_path_energy_weight, s=2, c=path26_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path26_path_energy_weight))),path26_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path26_path_energy_bolas))),path26_path_energy_bolas, s=2, c=path26_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path26_path_energy_bolas))),path26_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path26.all.1003.png".format(nclusters),dpi=1200)


In [132]: path26_new                                                                                                              
Out[132]: 
array([[  57, 1010],
       [  22,  994],
       [  54,  208],
       [  70, 1084],
       [  34, 1121]])

In [133]: path26_start_end_new                                                                                                    
Out[133]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [134]: path26_Cluster_new                                                                                                      
Out[134]: [57, 22, 54, 70, 34, 38]

In [135]: path26_table_new                                                                                                        
Out[135]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_223_xpr1          405             57   TPS_2500_cp_2  gn_223_xpr2        499           22
1   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
2       TPS_12500  gn_011_xpr1          726             54       TPS_12500  gn_011_xpr2        217           70
3  TPS_12500_cp_2  gn_087_xpr1          357             70  TPS_12500_cp_2  gn_087_xpr2        506           34
4  TPS_12500_cp_2  gn_284_xpr1          547             34  TPS_12500_cp_2  gn_284_xpr1        467           38

In [136]: path26_data_new                                                                                                         
Out[136]: 
   Traj  Start  End  Order
0  1010     96  999      1
1   994     48  999      1
2   208     57  999      1
3  1084    862    0     -1
4  1121     14   94      1




#%%%%%%%%%%%%%%%%% Plotting Path 27 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


In [71]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 1136
Next Cluster 16
Cluster 16 sampled by Traj 1134
Next Cluster 70
Cluster 70 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 489
Final
Out[71]: [1012, 994, 1031, 1136, 1134, 1055]

Cluster Index: 57 --> 22 --> 54 --> 70 --> 16 --> 70 --> 10/46
Cluster ID:    58 --> 23 --> 55 --> 71 --> 17 --> 71 --> 11/47


path27=np.array([[57,1012],[22,994],[54,1031],[70,1136],[16,1134],[70,1055],[70,489]])
path27_start_end=np.array([[57,22],[22,54],[54,70],[70,16],[16,70],[70,70],[70,46 ]])
path27_Cluster = [57,22,54,70,16,70,70,46]


path27_new, path27_start_end_new, path27_Cluster_new = path_simplify(path27,path27_start_end,path27_Cluster)
path27_table_new, path27_data_new =summarize_path(path27_new,path27_Cluster_new)
path27_extract_dist=extract_path_data(path27_data_new, dist_data_update)
path27_extract_tica=extract_path_data(path27_data_new, tica_coord_output)
path27_extract_dist_concatenated = np.concatenate(path27_extract_dist)
path27_path_binnumber_dist, path27_path_energy_dist, path27_path_cluster_dist =extract_path_energy(path27_data_new,binnumber_dist,f_dist)
path27_path_binnumber_weight, path27_path_energy_weight, path27_path_cluster_weight =extract_path_energy(path27_data_new,binnumber_weight,f_weight)
path27_path_energy_bolas=extract_bolas_energy(path27_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path27_extract_dist_concatenated[:,0],path27_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path27.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path27_path_energy_dist))),path27_path_energy_dist, s=2, c=path27_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path27_path_energy_dist))),path27_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path27_path_energy_weight))),path27_path_energy_weight, s=2, c=path27_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path27_path_energy_weight))),path27_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path27_path_energy_bolas))),path27_path_energy_bolas, s=2, c=path27_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path27_path_energy_bolas))),path27_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path27.all.1003.png".format(nclusters),dpi=1200)



In [140]: path27_new                                                                                                              
Out[140]: 
array([[  57, 1012],
       [  22,  994],
       [  54, 1031],
       [  70,  489]])

In [141]: path27_start_end_new                                                                                                    
Out[141]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [142]: path27_Cluster_new                                                                                                      
Out[142]: [57, 22, 54, 70, 46]

In [143]: path27_table_new                                                                                                        
Out[143]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_234_xpr2          244             57  TPS_2500_cp_2  gn_234_xpr1        742           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2  TPS_5000_cp_2  gn_066_xpr2          349             54  TPS_5000_cp_2  gn_066_xpr1        138           70
3   TPS_22500_cp  gn_029_xpr2          208             70   TPS_22500_cp  gn_029_xpr1        619           46

In [144]: path27_data_new                                                                                                         
Out[144]: 
   Traj  Start  End  Order
0  1012    999   14     -1
1   994     48  999      1
2  1031      0  486      1
3   489    999  173     -1




#%%%%%%%%%%%%%%%%% Plotting Path 28 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In [79]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 979
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 20
Cluster 20 sampled by Traj 198
Next Cluster 69
Cluster 69 sampled by Traj 189
Next Cluster 5
Cluster 5 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 160
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 70
Cluster 70 sampled by Traj 715
Final
Out[79]: [0, 979, 187, 183, 198, 189, 176, 160, 159]

Cluster Index: 17 --> 54 --> 5 --> 69 --> 20 --> 69 --> 5 --> 70 --> 25
Cluster ID:    18 --> 55 --> 6 --> 70 --> 21 --> 70 --> 6 --> 71 --> 26


path28=np.array([[17,0],[54,979],[5,187],[69,183],[20,198],[69,189],[5,176],[5,160],[5,159],[70,715]])
path28_start_end=np.array([[17,54],[54,5],[5,69],[69,20],[20,69],[69,5],[5,5],[5,5],[5,70],[70,25]])
path28_Cluster = [17,54,5,69,20,69,5,5,5,70,25]


path28_new, path28_start_end_new, path28_Cluster_new = path_simplify(path28,path28_start_end,path28_Cluster)
path28_table_new, path28_data_new =summarize_path(path28_new,path28_Cluster_new)
path28_extract_dist=extract_path_data(path28_data_new, dist_data_update)
path28_extract_tica=extract_path_data(path28_data_new, tica_coord_output)
path28_extract_dist_concatenated = np.concatenate(path28_extract_dist)
path28_path_binnumber_dist, path28_path_energy_dist, path28_path_cluster_dist =extract_path_energy(path28_data_new,binnumber_dist,f_dist)
path28_path_binnumber_weight, path28_path_energy_weight, path28_path_cluster_weight =extract_path_energy(path28_data_new,binnumber_weight,f_weight)
path28_path_energy_bolas=extract_bolas_energy(path28_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path28_extract_dist_concatenated[:,0],path28_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path28.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path28_path_energy_dist))),path28_path_energy_dist, s=2, c=path28_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path28_path_energy_dist))),path28_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path28_path_energy_weight))),path28_path_energy_weight, s=2, c=path28_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path28_path_energy_weight))),path28_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path28_path_energy_bolas))),path28_path_energy_bolas, s=2, c=path28_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path28_path_energy_bolas))),path28_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path28.all.1003.png".format(nclusters),dpi=1200)



In [147]: path28_new                                                                                                              
Out[147]: 
array([[ 17,   0],
       [ 54, 979],
       [  5, 159],
       [ 70, 715]])

In [148]: path28_start_end_new                                                                                                    
Out[148]: 
array([[17, 54],
       [54,  5],
       [ 5, 70],
       [70, 25]])

In [149]: path28_Cluster_new                                                                                                      
Out[149]: [17, 54, 5, 70, 25]

In [150]: path28_table_new                                                                                                        
Out[150]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_017_xpr1          672             17    TPS_2500_cp  gn_017_xpr2        274           54
1  TPS_2500_cp_2  gn_004_xpr2           69             54  TPS_2500_cp_2  gn_004_xpr1        410            5
2      TPS_10000  gn_176_xpr1          501              5      TPS_10000  gn_176_xpr2          2           70
3      TPS_30000  gn_130_xpr1          225             70      TPS_30000  gn_130_xpr2        775           25

In [151]: path28_data_new                                                                                                         
Out[151]: 
   Traj  Start  End  Order
0     0      0  945      1
1   979      0  478      1
2   159      0  502      1
3   715    999    0     -1



#%%%%%%%%%%%%%%%%% Plotting Path 29 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



In [87]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 22 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 22
Cluster 22 sampled by Traj 1009
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 1055
Next Cluster 70
Cluster 70 sampled by Traj 651
Next Cluster 72
Cluster 72 sampled by Traj 660
Next Cluster 10
Cluster 10 sampled by Traj 664
Next Cluster 10
Cluster 10 sampled by Traj 691
Next Cluster 10
Cluster 10 sampled by Traj 489
Final
Out[87]: [1012, 1010, 995, 1009, 994, 1055, 651, 660, 664, 691]

Cluster Index: 22 --> 57 --> 22 --> 54 --> 70 --> 72 --> 10 --> 46/70
Cluster ID:    23 --> 58 --> 23 --> 55 --> 71 --> 73 --> 11 --> 47/71


path29=np.array([[22,1012],[57,1010],[22,995],[22,1009],[22,994],[54,1055],[70,651],[72,660],[10,664],[10,691],[10,489]])
path29_start_end=np.array([[22,57],[57,22],[22,22],[22,22],[22,54],[54,70],[70,72],[72,10],[10,10],[10,10],[10,46 ]])
path29_Cluster = [22,57,22,22,22,54,70,72,10,10,10,46]


path29_new, path29_start_end_new, path29_Cluster_new = path_simplify(path29,path29_start_end,path29_Cluster)
path29_table_new, path29_data_new =summarize_path(path29_new,path29_Cluster_new)
path29_extract_dist=extract_path_data(path29_data_new, dist_data_update)
path29_extract_tica=extract_path_data(path29_data_new, tica_coord_output)
path29_extract_dist_concatenated = np.concatenate(path29_extract_dist)
path29_path_binnumber_dist, path29_path_energy_dist, path29_path_cluster_dist =extract_path_energy(path29_data_new,binnumber_dist,f_dist)
path29_path_binnumber_weight, path29_path_energy_weight, path29_path_cluster_weight =extract_path_energy(path29_data_new,binnumber_weight,f_weight)
path29_path_energy_bolas=extract_bolas_energy(path29_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path29_extract_dist_concatenated[:,0],path29_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path29.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path29_path_energy_dist))),path29_path_energy_dist, s=2, c=path29_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path29_path_energy_dist))),path29_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path29_path_energy_weight))),path29_path_energy_weight, s=2, c=path29_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path29_path_energy_weight))),path29_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path29_path_energy_bolas))),path29_path_energy_bolas, s=2, c=path29_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path29_path_energy_bolas))),path29_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path29.all.1003.png".format(nclusters),dpi=1200)



In [154]: path29_new                                                                                                              
Out[154]: 
array([[  22,  994],
       [  54, 1055],
       [  70,  651],
       [  72,  660],
       [  10,  489]])

In [155]: path29_start_end_new                                                                                                    
Out[155]: 
array([[22, 54],
       [54, 70],
       [70, 72],
       [72, 10],
       [10, 46]])

In [156]: path29_Cluster_new                                                                                                      
Out[156]: [22, 54, 70, 72, 10, 46]

In [157]: path29_table_new                                                                                                        
Out[157]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1  TPS_10000_cp_2  gn_010_xpr1          783             54  TPS_10000_cp_2  gn_010_xpr2        217           70
2    TPS_27500_cp  gn_076_xpr1          635             70    TPS_27500_cp  gn_076_xpr2        354           72
3    TPS_27500_cp  gn_103_xpr1          141             72    TPS_27500_cp  gn_103_xpr2        295           10
4    TPS_22500_cp  gn_029_xpr1          792             10    TPS_22500_cp  gn_029_xpr1         85           46

In [158]: path29_data_new                                                                                                         
Out[158]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1055      0  999      1
2   651     11  999      1
3   660    392  827      1
4   489      0  707      1




#%%%%%%%%%%%%%%%%% Plotting Path 30 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In [89]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 1039
Next Cluster 70
Cluster 70 sampled by Traj 490
Final
Out[89]: [0, 1039]

Cluster Index: 17 --> 70 --> 46
Cluster ID:    18 --> 71 --> 47


path30=np.array([[17,0],[70,1039],[70,490]])
path30_start_end=np.array([[17,70],[70,70],[70,46]])
path30_Cluster = [17,70,70,46]


path30_new, path30_start_end_new, path30_Cluster_new = path_simplify(path30,path30_start_end,path30_Cluster)
path30_table_new, path30_data_new =summarize_path(path30_new,path30_Cluster_new)
path30_extract_dist=extract_path_data(path30_data_new, dist_data_update)
path30_extract_tica=extract_path_data(path30_data_new, tica_coord_output)
path30_extract_dist_concatenated = np.concatenate(path30_extract_dist)
path30_path_binnumber_dist, path30_path_energy_dist, path30_path_cluster_dist =extract_path_energy(path30_data_new,binnumber_dist,f_dist)
path30_path_binnumber_weight, path30_path_energy_weight, path30_path_cluster_weight =extract_path_energy(path30_data_new,binnumber_weight,f_weight)
path30_path_energy_bolas=extract_bolas_energy(path30_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path30_extract_dist_concatenated[:,0],path30_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path30.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path30_path_energy_dist))),path30_path_energy_dist, s=2, c=path30_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path30_path_energy_dist))),path30_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path30_path_energy_weight))),path30_path_energy_weight, s=2, c=path30_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path30_path_energy_weight))),path30_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path30_path_energy_bolas))),path30_path_energy_bolas, s=2, c=path30_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path30_path_energy_bolas))),path30_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path30.all.1003.png".format(nclusters),dpi=1200)


In [161]: path30_new                                                                                                              
Out[161]: 
array([[ 17,   0],
       [ 70, 490]])

In [162]: path30_start_end_new                                                                                                    
Out[162]: 
array([[17, 70],
       [70, 46]])

In [163]: path30_Cluster_new                                                                                                      
Out[163]: [17, 70, 46]

In [164]: path30_table_new                                                                                                        
Out[164]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr1        171           70
1  TPS_22500_cp  gn_030_xpr1           41             70  TPS_22500_cp  gn_030_xpr1        684           46

In [165]: path30_data_new                                                                                                         
Out[165]: 
   Traj  Start  End  Order
0     0      0  501      1
1   490    356  999      1



#%%%%%%%%%%%%%%%%% Plotting Path 31 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


In [90]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 57 sampled by Traj 1009
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 57
Cluster 57 sampled by Traj 1010
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 22
Cluster 22 sampled by Traj 1011
Next Cluster 22
Cluster 22 sampled by Traj 995
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 363
Next Cluster 70
Cluster 70 sampled by Traj 1044
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 71
Cluster 71 sampled by Traj 377
Next Cluster 64
Cluster 64 sampled by Traj 372
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 70
Cluster 70 sampled by Traj 490
Final
Out[90]: [1009, 1007, 1010, 1012, 994, 1011, 995, 362, 363, 1044, 367, 377, 372, 1171]


Cluster Index: 57 --> 22 --> 54 --> 71 --> 70 --> 54 --> 71 --> 64 --> 71 --> 70 --> 46
Cluster ID:    58 --> 23 --> 55 --> 72 --> 71 --> 55 --> 72 --> 65 --> 72 --> 71 --> 47


path31=np.array([[57,1009],[57,1007],[57,1010],[57,1012],[22,994],[22,1011],[22,995],[54,362],[71,363],[70,1044],[54,367],[71,377],[64,372],[71,1171],[70,490]])
path31_start_end=np.array([[57,57],[57,57],[57,57],[57,22],[22,22],[22,22],[22,54],[54,71],[71,70],[70,54],[54,71],[71,64],[64,71],[71,70],[70,46]])
path31_Cluster = [57,57,57,57,22,22,22,54,71,70,54,71,64,71,70,46]



path31_new, path31_start_end_new, path31_Cluster_new = path_simplify(path31,path31_start_end,path31_Cluster)
path31_table_new, path31_data_new =summarize_path(path31_new,path31_Cluster_new)
path31_extract_dist=extract_path_data(path31_data_new, dist_data_update)
path31_extract_tica=extract_path_data(path31_data_new, tica_coord_output)
path31_extract_dist_concatenated = np.concatenate(path31_extract_dist)
path31_path_binnumber_dist, path31_path_energy_dist, path31_path_cluster_dist =extract_path_energy(path31_data_new,binnumber_dist,f_dist)
path31_path_binnumber_weight, path31_path_energy_weight, path31_path_cluster_weight =extract_path_energy(path31_data_new,binnumber_weight,f_weight)
path31_path_energy_bolas=extract_bolas_energy(path31_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path31_extract_dist_concatenated[:,0],path31_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path31.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path31_path_energy_dist))),path31_path_energy_dist, s=2, c=path31_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path31_path_energy_dist))),path31_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path31_path_energy_weight))),path31_path_energy_weight, s=2, c=path31_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path31_path_energy_weight))),path31_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path31_path_energy_bolas))),path31_path_energy_bolas, s=2, c=path31_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path31_path_energy_bolas))),path31_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path31.all.1003.png".format(nclusters),dpi=1200)


In [168]: path31_new                                                                                                              
Out[168]: 
array([[  57, 1012],
       [  22,  995],
       [  54,  367],
       [  71,  377],
       [  64,  372],
       [  71, 1171],
       [  70,  490]])

In [169]: path31_start_end_new                                                                                                    
Out[169]: 
array([[57, 22],
       [22, 54],
       [54, 71],
       [71, 64],
       [64, 71],
       [71, 70],
       [70, 46]])

In [170]: path31_Cluster_new                                                                                                      
Out[170]: [57, 22, 54, 71, 64, 71, 70, 46]

In [171]: path31_table_new                                                                                                        
Out[171]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_234_xpr2          244             57   TPS_2500_cp_2  gn_234_xpr1        742           22
1   TPS_2500_cp_2  gn_152_xpr2          934             22   TPS_2500_cp_2  gn_152_xpr1         32           54
2    TPS_20000_cp  gn_073_xpr1          888             54    TPS_20000_cp  gn_073_xpr2         62           71
3    TPS_20000_cp  gn_192_xpr1          336             71    TPS_20000_cp  gn_192_xpr2        664           64
4    TPS_20000_cp  gn_133_xpr1          730             64    TPS_20000_cp  gn_133_xpr2        270           71
5  TPS_20000_cp_2  gn_060_xpr1          524             71  TPS_20000_cp_2  gn_060_xpr2         24           70
6    TPS_22500_cp  gn_030_xpr1           41             70    TPS_22500_cp  gn_030_xpr1        684           46

In [172]: path31_data_new                                                                                                         
Out[172]: 
   Traj  Start  End  Order
0  1012    999   14     -1
1   995      0  965      1
2   367     50  999      1
3   377      0  999      1
4   372    999    0     -1
5  1171     35  582      1
6   490    356  999      1




#%%%%%%%%%%%%%%%%% Plotting Path 32 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



In [94]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 22 sampled by Traj 1010
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 181
Next Cluster 5
Cluster 5 sampled by Traj 173
Next Cluster 5
Cluster 5 sampled by Traj 159
Next Cluster 5
Cluster 5 sampled by Traj 192
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 5
Cluster 5 sampled by Traj 979
Next Cluster 54
Cluster 54 sampled by Traj 76
Next Cluster 54
Cluster 54 sampled by Traj 1041
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final
Out[94]: [1010, 994, 170, 181, 173, 159, 192, 187, 979, 76, 1041]

Cluster Index: 22 --> 54 --> 5 --> 54 --> 34 --> 38
Cluster ID:    23 --> 55 --> 6 --> 55 --> 35 --> 39

k=32
path32=np.array([[22,1010],[22,994],[54,170],[5,181],[5,173],[5,159],[5,192],[5,187],[5,979],[54,76],[54,1041],[34,1097]])
path32_start_end=np.array([[22,22],[22,54],[54,5],[5,5],[5,5],[5,5],[5,5],[5,5],[5,54],[54,54],[54,34],[34,38]])
path32_Cluster = [22,22,54,5,5,5,5,5,5,54,54,34,38]


path32_new, path32_start_end_new, path32_Cluster_new = path_simplify(path32,path32_start_end,path32_Cluster)
path32_table_new, path32_data_new =summarize_path(path32_new,path32_Cluster_new)
path32_extract_dist=extract_path_data(path32_data_new, dist_data_update)
path32_extract_tica=extract_path_data(path32_data_new, tica_coord_output)
path32_extract_dist_concatenated = np.concatenate(path32_extract_dist)
path32_path_binnumber_dist, path32_path_energy_dist, path32_path_cluster_dist =extract_path_energy(path32_data_new,binnumber_dist,f_dist)
path32_path_binnumber_weight, path32_path_energy_weight, path32_path_cluster_weight =extract_path_energy(path32_data_new,binnumber_weight,f_weight)
path32_path_energy_bolas=extract_bolas_energy(path32_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
#ax.scatter(path32_extract_dist_concatenated[:,0],path32_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path32.1003.01222024.png".format(nclusters),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
#ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
ax.set_xlabel('DIST 1  /nm',fontsize=20, fontweight='bold')
ax.set_ylabel('DIST 2  /nm',fontsize=20, fontweight='bold')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('BOLAS', fontweight='bold',fontsize=24)
ax.tick_params(labelsize=20)
ax.set_xticks(np.arange(0,6,1))
ax.set_yticks(np.arange(0,4,1))
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.pnglag=100.cluster={}.coord.region3.path{}.1003.01222024.png".format(nclusters,k),dpi=1200)





fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path32_path_energy_dist))),path32_path_energy_dist, s=2, c=path32_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path32_path_energy_dist))),path32_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path32_path_energy_weight))),path32_path_energy_weight, s=2, c=path32_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path32_path_energy_weight))),path32_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path32_path_energy_bolas))),path32_path_energy_bolas, s=2, c=path32_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path32_path_energy_bolas))),path32_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path32.all.1003.01222024.png".format(nclusters),dpi=1200)


In [175]: path32_new                                                                                                              
Out[175]: 
array([[  22,  994],
       [  54, 1041],
       [  34, 1097]])

In [176]: path32_start_end_new                                                                                                    
Out[176]: 
array([[22, 54],
       [54, 34],
       [34, 38]])

In [177]: path32_Cluster_new                                                                                                      
Out[177]: [22, 54, 34, 38]

In [178]: path32_table_new                                                                                                        
Out[178]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1   TPS_7500_cp_2  gn_125_xpr1          312             54   TPS_7500_cp_2  gn_125_xpr2        662           34
2  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [179]: path32_data_new                                                                                                         
Out[179]: 
   Traj  Start  End  Order
0   994     48  999      1
1  1041      0  973      1
2  1097      0  999      1



#%%%%%%%%%%%%%%%%% Plotting Path 33 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


In [99]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                             
Cluster 18 sampled by Traj 20
Next Cluster 40
Cluster 40 sampled by Traj 44
Next Cluster 40
Cluster 40 sampled by Traj 36
Next Cluster 56
Cluster 56 sampled by Traj 61
Next Cluster 21
Cluster 21 sampled by Traj 49
Next Cluster 56
Cluster 56 sampled by Traj 62
Next Cluster 56
Cluster 56 sampled by Traj 47
Next Cluster 21
Cluster 21 sampled by Traj 46
Next Cluster 21
Cluster 21 sampled by Traj 63
Next Cluster 56
Cluster 56 sampled by Traj 33
Next Cluster 40
Cluster 40 sampled by Traj 34
Next Cluster 40
Cluster 40 sampled by Traj 29
Next Cluster 18
Cluster 18 sampled by Traj 25
Next Cluster 18
Cluster 18 sampled by Traj 30
Next Cluster 18
Cluster 18 sampled by Traj 18
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 70
Cluster 70 sampled by Traj 654
Next Cluster 72
Cluster 72 sampled by Traj 651
Next Cluster 70
Cluster 70 sampled by Traj 714
Final
Out[99]: 
[20,
 44,
 36,
 61,
 49,
 62,
 47,
 46,
 63,
 33,
 34,
 29,
 25,
 30,
 18,
 28,
 1029,
 654,
 651]
 
Cluster Index: 18 --> 40 --> 56 --> 21 --> 56 --> 21 --> 56 --> 40 --> 18 --> 54 --> 70 --> 72 --> 70 --> 25
Cluster ID:    19 --> 41 --> 57 --> 22 --> 57 --> 22 --> 57 --> 41 --> 19 --> 55 --> 71 --> 73 --> 71 --> 26


path33=np.array([[18,20],[40,44],[40,36],[56,61],[21,49],[56,62],[56,47],[21,46],[21,63],[56,33],[40,34],[40,29],[18,25],[18,30],[18,18],[18,28],[54,1029],[70,654],[72,651],[70,714]])
path33_start_end=np.array([[18,40],[40,40],[40,56],[56,21],[21,56],[56,56],[56,21],[21,21],[21,56],[56,40],[40,40],[40,18],[18,18],[18,18],[18,18],[18,54],[54,70],[70,72],[72,70],[70,25]])
path33_Cluster = [18,40,40,56,21,56,56,21,21,56,40,40,18,18,18,18,54,70,72,70,25]


path33_new, path33_start_end_new, path33_Cluster_new = path_simplify(path33,path33_start_end,path33_Cluster)
path33_table_new, path33_data_new =summarize_path(path33_new,path33_Cluster_new)
path33_extract_dist=extract_path_data(path33_data_new, dist_data_update)
path33_extract_tica=extract_path_data(path33_data_new, tica_coord_output)
path33_extract_dist_concatenated = np.concatenate(path33_extract_dist)
path33_path_binnumber_dist, path33_path_energy_dist, path33_path_cluster_dist =extract_path_energy(path33_data_new,binnumber_dist,f_dist)
path33_path_binnumber_weight, path33_path_energy_weight, path33_path_cluster_weight =extract_path_energy(path33_data_new,binnumber_weight,f_weight)
path33_path_energy_bolas=extract_bolas_energy(path33_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path33_extract_dist_concatenated[:,0],path33_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path33.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path33_path_energy_dist))),path33_path_energy_dist, s=2, c=path33_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path33_path_energy_dist))),path33_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path33_path_energy_weight))),path33_path_energy_weight, s=2, c=path33_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path33_path_energy_weight))),path33_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path33_path_energy_bolas))),path33_path_energy_bolas, s=2, c=path33_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path33_path_energy_bolas))),path33_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path33.all.1003.png".format(nclusters),dpi=1200)


In [184]: path33_new                                                                                                              
Out[184]: 
array([[  18,   28],
       [  54, 1029],
       [  70,  714]])

In [185]: path33_start_end_new                                                                                                    
Out[185]: 
array([[18, 54],
       [54, 70],
       [70, 25]])

In [186]: path33_Cluster_new                                                                                                      
Out[186]: [18, 54, 70, 25]

In [187]: path33_table_new                                                                                                        
Out[187]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_199_xpr2          165             18    TPS_2500_cp  gn_199_xpr1        766           54
1  TPS_5000_cp_2  gn_011_xpr1          752             54  TPS_5000_cp_2  gn_011_xpr2         19           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [188]: path33_data_new                                                                                                         
Out[188]: 
   Traj  Start  End  Order
0    28    999   69     -1
1  1029      0  770      1
2   714      0  739      1




#%%%%%%%%%%%%%%%%% Plotting Path 34 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


In [101]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                            
Cluster 17 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 71
Cluster 71 sampled by Traj 1171
Next Cluster 71
Cluster 71 sampled by Traj 118
Next Cluster 54
Cluster 54 sampled by Traj 175
Next Cluster 69
Cluster 69 sampled by Traj 186
Next Cluster 69
Cluster 69 sampled by Traj 185
Next Cluster 69
Cluster 69 sampled by Traj 183
Next Cluster 69
Cluster 69 sampled by Traj 192
Next Cluster 69
Cluster 69 sampled by Traj 204
Next Cluster 20
Cluster 20 sampled by Traj 184
Next Cluster 69
Cluster 69 sampled by Traj 176
Next Cluster 5
Cluster 5 sampled by Traj 187
Next Cluster 69
Cluster 69 sampled by Traj 171
Next Cluster 69
Cluster 69 sampled by Traj 170
Next Cluster 5
Cluster 5 sampled by Traj 158
Next Cluster 70
Cluster 70 sampled by Traj 272
Next Cluster 71
Cluster 71 sampled by Traj 361
Next Cluster 70
Cluster 70 sampled by Traj 489
Final
Out[101]: 
[5,
 0,
 362,
 1171,
 118,
 175,
 186,
 185,
 183,
 192,
 204,
 184,
 176,
 187,
 171,
 170,
 158,
 272,
 361]
 
 
Cluster Index: 17 --> 54 --> 71 --> 54 --> 69 --> 20 --> 69 --> 5 --> 69 --> 5 --> 70 --> 71 --> 70 --> 46/10
Cluster ID:    18 --> 55 --> 72 --> 55 --> 70 --> 21 --> 70 --> 6 --> 70 --> 6 --> 71 --> 72 --> 71 --> 47/11



path34=np.array([[17,5],[17,0],[54,362],[71,1171],[71,118],[54,175],[69,186],[69,185],[69,183],[69,192],[69,204],[20,184],[69,176],[5,187],[69,171],[69,170],[5,158],[70,272],[71,361],[70,489]])
path34_start_end=np.array([[17,17],[17,54],[54,71],[71,71],[71,54],[54,69],[69,69],[69,69],[69,69],[69,69],[69,20],[20,69],[69,5],[5,69],[69,69],[69,5],[5,70],[70,71],[71,70],[70,46 ]])
path34_Cluster = [17,17,54,71,71,54,69,69,69,69,69,20,69,5,69,69,5,70,71,70,46]


path34_new, path34_start_end_new, path34_Cluster_new = path_simplify(path34,path34_start_end,path34_Cluster)
path34_table_new, path34_data_new =summarize_path(path34_new,path34_Cluster_new)
path34_extract_dist=extract_path_data(path34_data_new, dist_data_update)
path34_extract_tica=extract_path_data(path34_data_new, tica_coord_output)
path34_extract_dist_concatenated = np.concatenate(path34_extract_dist)
path34_path_binnumber_dist, path34_path_energy_dist, path34_path_cluster_dist =extract_path_energy(path34_data_new,binnumber_dist,f_dist)
path34_path_binnumber_weight, path34_path_energy_weight, path34_path_cluster_weight =extract_path_energy(path34_data_new,binnumber_weight,f_weight)
path34_path_energy_bolas=extract_bolas_energy(path34_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path34_extract_dist_concatenated[:,0],path34_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path34.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path34_path_energy_dist))),path34_path_energy_dist, s=2, c=path34_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path34_path_energy_dist))),path34_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path34_path_energy_weight))),path34_path_energy_weight, s=2, c=path34_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path34_path_energy_weight))),path34_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path34_path_energy_bolas))),path34_path_energy_bolas, s=2, c=path34_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path34_path_energy_bolas))),path34_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path34.all.1003.png".format(nclusters),dpi=1200)


In [189]: path34_new                                                                                                              
Out[189]: 
array([[ 17,   0],
       [ 54, 175],
       [ 69, 170],
       [  5, 158],
       [ 70, 489]])

In [190]: path34_start_end_new                                                                                                    
Out[190]: 
array([[17, 54],
       [54, 69],
       [69,  5],
       [ 5, 70],
       [70, 46]])

In [191]: path34_Cluster_new                                                                                                      
Out[191]: [17, 54, 69, 5, 70, 46]

In [192]: path34_table_new                                                                                                        
Out[192]: 
   Start_window   Start_traj  Start_frame  Start_cluster    End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp  gn_017_xpr1          672             17   TPS_2500_cp  gn_017_xpr2        274           54
1     TPS_10000  gn_308_xpr2          730             54     TPS_10000  gn_308_xpr1        111           69
2     TPS_10000  gn_273_xpr2          254             69     TPS_10000  gn_273_xpr1        735            5
3     TPS_10000  gn_158_xpr2           85              5     TPS_10000  gn_158_xpr1        743           70
4  TPS_22500_cp  gn_029_xpr2          208             70  TPS_22500_cp  gn_029_xpr1        619           46

In [193]: path34_data_new                                                                                                         
Out[193]: 
   Traj  Start  End  Order
0     0      0  945      1
1   175    840    0     -1
2   170     11  999      1
3   158    999  172     -1
4   489    999  173     -1





#%%%%%%%%%%%%%%%%% Plotting Path 35 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


In [102]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                            
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1083
Next Cluster 34
Cluster 34 sampled by Traj 1097
Final
Out[102]: [994, 362, 1083]

Cluster Index: 22 --> 54 --> 70 --> 34 --> 38
Cluster ID:    23 --> 55 --> 71 --> 35 --> 39


path35=np.array([[22,994],[54,362],[70,1083],[34,1097]])
path35_start_end=np.array([[22,54],[54,70],[70,34],[34,38]])
path35_Cluster = [22,54,70,34,38]



path35_new, path35_start_end_new, path35_Cluster_new = path_simplify(path35,path35_start_end,path35_Cluster)
path35_table_new, path35_data_new =summarize_path(path35_new,path35_Cluster_new)
path35_extract_dist=extract_path_data(path35_data_new, dist_data_update)
path35_extract_tica=extract_path_data(path35_data_new, tica_coord_output)
path35_extract_dist_concatenated = np.concatenate(path35_extract_dist)
path35_path_binnumber_dist, path35_path_energy_dist, path35_path_cluster_dist =extract_path_energy(path35_data_new,binnumber_dist,f_dist)
path35_path_binnumber_weight, path35_path_energy_weight, path35_path_cluster_weight =extract_path_energy(path35_data_new,binnumber_weight,f_weight)
path35_path_energy_bolas=extract_bolas_energy(path35_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path35_extract_dist_concatenated[:,0],path35_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path35.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path35_path_energy_dist))),path35_path_energy_dist, s=2, c=path35_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path35_path_energy_dist))),path35_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path35_path_energy_weight))),path35_path_energy_weight, s=2, c=path35_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path35_path_energy_weight))),path35_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path35_path_energy_bolas))),path35_path_energy_bolas, s=2, c=path35_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path35_path_energy_bolas))),path35_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path35.all.1003.png".format(nclusters),dpi=1200)


In [196]: path35_new                                                                                                              
Out[196]: 
array([[  22,  994],
       [  54,  362],
       [  70, 1083],
       [  34, 1097]])

In [197]: path35_start_end_new                                                                                                    
Out[197]: 
array([[22, 54],
       [54, 70],
       [70, 34],
       [34, 38]])

In [198]: path35_Cluster_new                                                                                                      
Out[198]: [22, 54, 70, 34, 38]

In [199]: path35_table_new                                                                                                        
Out[199]: 
     Start_window   Start_traj  Start_frame  Start_cluster      End_window     End_traj  End_frame  End_cluster
0   TPS_2500_cp_2  gn_151_xpr1          527             22   TPS_2500_cp_2  gn_151_xpr2        425           54
1    TPS_20000_cp  gn_030_xpr1          842             54    TPS_20000_cp  gn_030_xpr1        807           70
2  TPS_12500_cp_2  gn_046_xpr2          221             70  TPS_12500_cp_2  gn_046_xpr1        779           34
3  TPS_12500_cp_2  gn_202_xpr1          555             34  TPS_12500_cp_2  gn_202_xpr2        445           38

In [200]: path35_data_new                                                                                                         
Out[200]: 
   Traj  Start  End  Order
0   994     48  999      1
1   362      0   35      1
2  1083      0  999      1
3  1097      0  999      1




#%%%%%%%%%%%%%%%%% Plotting Path 36 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In [103]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                            
Cluster 18 sampled by Traj 30
Next Cluster 18
Cluster 18 sampled by Traj 18
Next Cluster 18
Cluster 18 sampled by Traj 25
Next Cluster 18
Cluster 18 sampled by Traj 16
Next Cluster 74
Cluster 74 sampled by Traj 5
Next Cluster 17
Cluster 17 sampled by Traj 0
Next Cluster 70
Cluster 70 sampled by Traj 715
Final
Out[103]: [30, 18, 25, 16, 5, 0]

Cluster Index: 18 --> 74 --> 17 --> 70 --> 25
Cluster ID:    19 --> 75 --> 18 --> 71 --> 26


path36=np.array([[18,30],[18,18],[18,25],[18,16],[74,5],[17,0],[70,715]])
path36_start_end=np.array([[18,18],[18,18],[18,18],[18,74],[74,17],[17,70],[70,25]])
path36_Cluster = [18,18,18,18,74,17,70,25]


path36_new, path36_start_end_new, path36_Cluster_new = path_simplify(path36,path36_start_end,path36_Cluster)
path36_table_new, path36_data_new =summarize_path(path36_new,path36_Cluster_new)
path36_extract_dist=extract_path_data(path36_data_new, dist_data_update)
path36_extract_tica=extract_path_data(path36_data_new, tica_coord_output)
path36_extract_dist_concatenated = np.concatenate(path36_extract_dist)
path36_path_binnumber_dist, path36_path_energy_dist, path36_path_cluster_dist =extract_path_energy(path36_data_new,binnumber_dist,f_dist)
path36_path_binnumber_weight, path36_path_energy_weight, path36_path_cluster_weight =extract_path_energy(path36_data_new,binnumber_weight,f_weight)
path36_path_energy_bolas=extract_bolas_energy(path36_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path36_extract_dist_concatenated[:,0],path36_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path36.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path36_path_energy_dist))),path36_path_energy_dist, s=2, c=path36_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path36_path_energy_dist))),path36_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path36_path_energy_weight))),path36_path_energy_weight, s=2, c=path36_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path36_path_energy_weight))),path36_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path36_path_energy_bolas))),path36_path_energy_bolas, s=2, c=path36_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path36_path_energy_bolas))),path36_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path36.all.1003.png".format(nclusters),dpi=1200)


In [204]: path36_new                                                                                                              
Out[204]: 
array([[ 18,  16],
       [ 74,   5],
       [ 17,   0],
       [ 70, 715]])

In [205]: path36_start_end_new                                                                                                    
Out[205]: 
array([[18, 74],
       [74, 17],
       [17, 70],
       [70, 25]])

In [206]: path36_Cluster_new                                                                                                      
Out[206]: [18, 74, 17, 70, 25]

In [207]: path36_table_new                                                                                                        
Out[207]: 
  Start_window   Start_traj  Start_frame  Start_cluster   End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp  gn_119_xpr1          900             18  TPS_2500_cp  gn_119_xpr2        100           74
1  TPS_2500_cp  gn_029_xpr1          736             74  TPS_2500_cp  gn_029_xpr2        264           17
2  TPS_2500_cp  gn_017_xpr1          672             17  TPS_2500_cp  gn_017_xpr1        171           70
3    TPS_30000  gn_130_xpr1          225             70    TPS_30000  gn_130_xpr2        775           25

In [208]: path36_data_new                                                                                                         
Out[208]: 
   Traj  Start  End  Order
0    16      0  999      1
1     5      0  999      1
2     0      0  501      1
3   715    999    0     -1




#%%%%%%%%%%%%%%%%% Plotting Path 37 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In [104]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                            
Cluster 18 sampled by Traj 20
Next Cluster 18
Cluster 18 sampled by Traj 29
Next Cluster 18
Cluster 18 sampled by Traj 25
Next Cluster 18
Cluster 18 sampled by Traj 16
Next Cluster 18
Cluster 18 sampled by Traj 28
Next Cluster 54
Cluster 54 sampled by Traj 1029
Next Cluster 54
Cluster 54 sampled by Traj 367
Next Cluster 54
Cluster 54 sampled by Traj 208
Next Cluster 70
Cluster 70 sampled by Traj 1055
Next Cluster 54
Cluster 54 sampled by Traj 1040
Next Cluster 70
Cluster 70 sampled by Traj 1060
Next Cluster 70
Cluster 70 sampled by Traj 1031
Next Cluster 70
Cluster 70 sampled by Traj 1041
Next Cluster 54
Cluster 54 sampled by Traj 77
Next Cluster 54
Cluster 54 sampled by Traj 1043
Next Cluster 54
Cluster 54 sampled by Traj 1039
Next Cluster 54
Cluster 54 sampled by Traj 1038
Next Cluster 70
Cluster 70 sampled by Traj 714
Final
Out[104]: 
[20,
 29,
 25,
 16,
 28,
 1029,
 367,
 208,
 1055,
 1040,
 1060,
 1031,
 1041,
 77,
 1043,
 1039,
 1038]
 
Cluster Index: 18 --> 54 --> 70 --> 54 --> 70 --> 54 --> 70 --> 25
Cluster ID:    19 --> 55 --> 71 --> 55 --> 71 --> 55 --> 71 --> 26


path37=np.array([[18,20],[18,29],[18,25],[18,16],[18,28],[54,1029],[54,367],[54,208],[70,1055],[54,1040],[70,1060],[70,1031],[70,1041],[54,77],[54,1043],[54,1039],[54,1038],[70,714]])
path37_start_end=np.array([[18,18],[18,18],[18,18],[18,18],[18,54],[54,54],[54,54],[54,70],[70,54],[54,70],[70,70],[70,70],[70,54],[54,54],[54,54],[54,54],[54,70],[70,25]])
path37_Cluster = [18,18,18,18,18,54,54,54,70,54,70,70,70,54,54,54,54,70,25]


path37_new, path37_start_end_new, path37_Cluster_new = path_simplify(path37,path37_start_end,path37_Cluster)
path37_table_new, path37_data_new =summarize_path(path37_new,path37_Cluster_new)
path37_extract_dist=extract_path_data(path37_data_new, dist_data_update)
path37_extract_tica=extract_path_data(path37_data_new, tica_coord_output)
path37_extract_dist_concatenated = np.concatenate(path37_extract_dist)
path37_path_binnumber_dist, path37_path_energy_dist, path37_path_cluster_dist =extract_path_energy(path37_data_new,binnumber_dist,f_dist)
path37_path_binnumber_weight, path37_path_energy_weight, path37_path_cluster_weight =extract_path_energy(path37_data_new,binnumber_weight,f_weight)
path37_path_energy_bolas=extract_bolas_energy(path37_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path37_extract_dist_concatenated[:,0],path37_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path37.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path37_path_energy_dist))),path37_path_energy_dist, s=2, c=path37_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path37_path_energy_dist))),path37_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path37_path_energy_weight))),path37_path_energy_weight, s=2, c=path37_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path37_path_energy_weight))),path37_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path37_path_energy_bolas))),path37_path_energy_bolas, s=2, c=path37_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path37_path_energy_bolas))),path37_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path37.all.1003.png".format(nclusters),dpi=1200)



In [211]: path37_new                                                                                                              
Out[211]: 
array([[  18,   28],
       [  54, 1038],
       [  70,  714]])

In [212]: path37_start_end_new                                                                                                    
Out[212]: 
array([[18, 54],
       [54, 70],
       [70, 25]])

In [213]: path37_Cluster_new                                                                                                      
Out[213]: [18, 54, 70, 25]

In [214]: path37_table_new                                                                                                        
Out[214]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0    TPS_2500_cp  gn_199_xpr2          165             18    TPS_2500_cp  gn_199_xpr1        766           54
1  TPS_7500_cp_2  gn_014_xpr1          849             54  TPS_7500_cp_2  gn_014_xpr2         33           70
2      TPS_30000  gn_129_xpr2          499             70      TPS_30000  gn_129_xpr1        241           25

In [215]: path37_data_new                                                                                                         
Out[215]: 
   Traj  Start  End  Order
0    28    999   69     -1
1  1038      0  881      1
2   714      0  739      1



#%%%%%%%%%%%%%%%%% Plotting Path 38 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


In [106]: get_cluster_series(cluster_series,cluster_33,cluster_36)                                                                                                                            
Cluster 57 sampled by Traj 1011
Next Cluster 57
Cluster 57 sampled by Traj 1012
Next Cluster 57
Cluster 57 sampled by Traj 1007
Next Cluster 22
Cluster 22 sampled by Traj 994
Next Cluster 54
Cluster 54 sampled by Traj 362
Next Cluster 70
Cluster 70 sampled by Traj 1084
Next Cluster 70
Cluster 70 sampled by Traj 1043
Next Cluster 70
Cluster 70 sampled by Traj 482
Next Cluster 70
Cluster 70 sampled by Traj 490
Final
Out[106]: [1011, 1012, 1007, 994, 362, 1084, 1043, 482]

Cluster Index: 57 --> 22 --> 54 --> 70 --> 46
Cluster ID:    58 --> 23 --> 55 --> 71 --> 47


path38=np.array([[57,1011],[57,1012],[57,1007],[22,994],[54,362],[70,1084],[70,1043],[70,482],[70,490]])
path38_start_end=np.array([[57,57],[57,57],[57,22],[22,54],[54,70],[70,70],[70,70],[70,70],[70,46]])
path38_Cluster = [57,57,57,22,54,70,70,70,70,46]


path38_new, path38_start_end_new, path38_Cluster_new = path_simplify(path38,path38_start_end,path38_Cluster)
path38_table_new, path38_data_new =summarize_path(path38_new,path38_Cluster_new)
path38_extract_dist=extract_path_data(path38_data_new, dist_data_update)
path38_extract_tica=extract_path_data(path38_data_new, tica_coord_output)
path38_extract_dist_concatenated = np.concatenate(path38_extract_dist)
path38_path_binnumber_dist, path38_path_energy_dist, path38_path_cluster_dist =extract_path_energy(path38_data_new,binnumber_dist,f_dist)
path38_path_binnumber_weight, path38_path_energy_weight, path38_path_cluster_weight =extract_path_energy(path38_data_new,binnumber_weight,f_weight)
path38_path_energy_bolas=extract_bolas_energy(path38_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,f_bolas)


fig, ax = plt.subplots(figsize=(7, 6))
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
ax.scatter(path38_extract_dist_concatenated[:,0],path38_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.path38.1003.png".format(nclusters),dpi=1200)


fig, axes = plt.subplots(3,1, figsize=(7, 9))
axes[0].scatter(list(range(len(path38_path_energy_dist))),path38_path_energy_dist, s=2, c=path38_path_cluster_dist, marker="o",zorder=2)
axes[0].plot(list(range(len(path38_path_energy_dist))),path38_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
axes[0].set_xlabel('Path')
axes[0].set_ylabel('Free Energy / kT')
axes[1].scatter(list(range(len(path38_path_energy_weight))),path38_path_energy_weight, s=2, c=path38_path_cluster_weight, marker="o",zorder=2)
axes[1].plot(list(range(len(path38_path_energy_weight))),path38_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
axes[1].set_xlabel('Path')
axes[1].set_ylabel('Free Energy / kT')
axes[2].scatter(list(range(len(path38_path_energy_bolas))),path38_path_energy_bolas, s=2, c=path38_path_cluster_dist, marker="o",zorder=2)
axes[2].plot(list(range(len(path38_path_energy_bolas))),path38_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
axes[2].set_xlabel('Path')
axes[2].set_ylabel('Free Energy / kT')
plt.tick_params(labelbottom = False, bottom = False)
axes[0].set_title('PATH 1 -- Sampling', fontweight='bold')
axes[1].set_title('PATH 1 -- Reweighted', fontweight='bold')
axes[2].set_title('PATH 1 -- BOLAS', fontweight='bold')
fig.tight_layout()
fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.path38.all.1003.png".format(nclusters),dpi=1200)


In [218]: path38_new                                                                                                              
Out[218]: 
array([[  57, 1007],
       [  22,  994],
       [  54,  362],
       [  70,  490]])

In [219]: path38_start_end_new                                                                                                    
Out[219]: 
array([[57, 22],
       [22, 54],
       [54, 70],
       [70, 46]])

In [220]: path38_Cluster_new                                                                                                      
Out[220]: [57, 22, 54, 70, 46]

In [221]: path38_table_new                                                                                                        
Out[221]: 
    Start_window   Start_traj  Start_frame  Start_cluster     End_window     End_traj  End_frame  End_cluster
0  TPS_2500_cp_2  gn_219_xpr2          836             57  TPS_2500_cp_2  gn_219_xpr1        159           22
1  TPS_2500_cp_2  gn_151_xpr1          527             22  TPS_2500_cp_2  gn_151_xpr2        425           54
2   TPS_20000_cp  gn_030_xpr1          842             54   TPS_20000_cp  gn_030_xpr1        807           70
3   TPS_22500_cp  gn_030_xpr1           41             70   TPS_22500_cp  gn_030_xpr1        684           46

In [222]: path38_data_new                                                                                                         
Out[222]: 
   Traj  Start  End  Order
0  1007      5  999      1
1   994     48  999      1
2   362      0   35      1
3   490    356  999      1



##########################################





states=list(range(msm_coord.active_set.shape[0]))
states_pair=[]
for state_a in states:
    for state_b in states:
        states_pair.append((state_a,state_b))


G = nx.MultiDiGraph()
labels={}
edge_labels={}


for i, origin_state in enumerate(states):
    for j, destination_state in enumerate(states):
        rate = msm_coord.transition_matrix[i][j]
        if rate > 0:
            G.add_edge(origin_state,
                       destination_state,
                       weight=rate,
                       label="{:.02f}".format(rate))
            edge_labels[(origin_state, destination_state)] = label="{:.02f}".format(rate)

plt.figure(figsize=(20,20))
node_size = 400
#pos = {state:list(state) for state in states_pair}
#nx.draw_networkx_edges(G,pos,width=1.0,alpha=0.5)
#nx.draw_networkx_labels(G, pos, font_weight=2)
#nx.draw_networkx_edge_labels(G, pos, edge_labels)
nx.draw(G, with_labels=True, font_weight='bold', node_color='orange')
plt.axis('off')
plt.savefig("MSM_transition_matrix.networkx.lag=100.cluster={}.coord.region3.tica.png".format(nclusters))




fig, ax = plt.subplots(figsize=(6,6))
pyemma.plots.plot_markov_model(msm_coord,arrow_labels=None,arrow_scale=0.5,state_colors='#75AEDC',state_labels=[cl+1 for cl in active_index])
plt.savefig("MSM_transition_plot.lag=100.cluster={}.coord.region3.tica.png".format(nclusters),dpi=1200)
plt.close()


fig, ax = plt.subplots(figsize=(6,6))
pyemma.plots.plot_markov_model(msm_coord,arrow_labels=None,arrow_scale=0.5,state_colors='#75AEDC',state_labels=[cl+1 for cl in active_index])
plt.savefig("MSM_transition_plot.lag=100.cluster={}.coord.region3.tica.copy.png".format(nclusters))
plt.close()


hmm = pyemma.msm.bayesian_hidden_markov_model(cluster_tica_coord.dtrajs, nstates, lag=100, dt_traj='0.002 ns')
pyemma.plots.plot_cktest(hmm.cktest(mlags=10), dt=0.002, units='ns');


pdb = md.load("./TPS_22500.cp/gn_005_xpr2.noWAT.nc.start.pdb")

files_TPS_2500_cp = glob.glob("./TPS_2500.cp/*.noWAT.align.nc")
files_TPS_5000_cp = glob.glob("./TPS_5000.cp/*.noWAT.align.nc")
files_TPS_7500 = glob.glob("./TPS_7500/*.noWAT.align.nc")
files_TPS_10000 = glob.glob("./TPS_10000/*.noWAT.align.nc")
files_TPS_12500 = glob.glob("./TPS_12500/*.noWAT.align.nc")
files_TPS_15000_cp = glob.glob("./TPS_15000.cp/*.noWAT.align.nc")
files_TPS_17500_cp = glob.glob("./TPS_17500.cp/*.noWAT.align.nc")
files_TPS_20000_cp = glob.glob("./TPS_20000.cp/*.noWAT.align.nc")
files_TPS_22500_cp = glob.glob("./TPS_22500.cp/*.noWAT.align.nc")
files_TPS_25000 = glob.glob("./TPS_25000/*.noWAT.align.nc")
files_TPS_27500_cp = glob.glob("./TPS_27500.cp/*.noWAT.align.nc")
files_TPS_30000 = glob.glob("./TPS_30000/*.noWAT.align.nc")
files_TPS_35000_cp = glob.glob("./TPS_35000.cp/*.noWAT.align.nc")
files_TPS_37500_cp = glob.glob("./TPS_37500.cp/*.noWAT.align.nc")


files_TPS_2500_cp_2 = glob.glob("./TPS_2500.cp-2/*.noWAT.align.nc")
files_TPS_5000_cp_2 = glob.glob("./TPS_5000.cp-2/*.noWAT.align.nc")
files_TPS_7500_cp_2 = glob.glob("./TPS_7500.cp-2/*.noWAT.align.nc")
files_TPS_10000_cp_2 = glob.glob("./TPS_10000.cp-2/*.noWAT.align.nc")
files_TPS_12500_cp_2 = glob.glob("./TPS_12500.cp-2/*.noWAT.align.nc")
files_TPS_15000_cp_2 = glob.glob("./TPS_15000.cp-2/*.noWAT.align.nc")
files_TPS_17500_cp_2 = glob.glob("./TPS_17500.cp-2/*.noWAT.align.nc")
files_TPS_20000_cp_2 = glob.glob("./TPS_20000.cp-2/*.noWAT.align.nc")


files_TPS_2500_cp.sort() 
files_TPS_5000_cp.sort() 
files_TPS_7500.sort()
files_TPS_10000.sort()
files_TPS_12500.sort()
files_TPS_15000_cp.sort() 
files_TPS_17500_cp.sort()
files_TPS_20000_cp.sort()
files_TPS_22500_cp.sort() 
files_TPS_25000.sort()
files_TPS_27500_cp.sort()
files_TPS_30000.sort()
files_TPS_35000_cp.sort()
files_TPS_37500_cp.sort()


files_TPS_2500_cp_2.sort()
files_TPS_5000_cp_2.sort()
files_TPS_7500_cp_2.sort()
files_TPS_10000_cp_2.sort()
files_TPS_12500_cp_2.sort()
files_TPS_15000_cp_2.sort()
files_TPS_17500_cp_2.sort()
files_TPS_20000_cp_2.sort()



files = files_TPS_2500_cp + files_TPS_5000_cp + files_TPS_7500 + files_TPS_10000 + files_TPS_12500 + files_TPS_15000_cp + files_TPS_17500_cp + files_TPS_20000_cp + files_TPS_22500_cp + files_TPS_25000 + files_TPS_27500_cp + files_TPS_30000 + files_TPS_35000_cp + files_TPS_37500_cp + files_TPS_2500_cp_2 + files_TPS_5000_cp_2 + files_TPS_7500_cp_2 + files_TPS_10000_cp_2 + files_TPS_12500_cp_2 + files_TPS_15000_cp_2 + files_TPS_17500_cp_2 + files_TPS_20000_cp_2

#=====================================Featurize===============================================


dist_feat=pyemma.coordinates.featurizer(pdb)                            
dist_feat.add_distances(np.array([[105,2416],[66,1956]]))   # 3P [66] - 62P [1956]; 4O4' [105] - 76N1 [2416]             
dist_data=pyemma.coordinates.load(files, features=dist_feat)

race_files = ["./TPS_2500.cp/race_history.log","./TPS_5000.cp/race_history.log","./TPS_7500/race_history.log","./TPS_10000/race_history.log","./TPS_12500/race_history.log","./TPS_15000.cp/race_history.log","./TPS_17500.cp/race_history.log","./TPS_20000.cp/race_history.log","./TPS_22500.cp/race_history.log","./TPS_25000/race_history.log","./TPS_27500.cp/race_history.log","./TPS_30000/race_history.log","./TPS_35000.cp/race_history.log", "./TPS_37500.cp/race_history.log","./TPS_2500.cp-2/race_history.log", "./TPS_5000.cp-2/race_history.log", "./TPS_7500.cp-2/race_history.log", "./TPS_10000.cp-2/race_history.log", "./TPS_12500.cp-2/race_history.log", "./TPS_15000.cp-2/race_history.log","./TPS_17500.cp-2/race_history.log", "./TPS_20000.cp-2/race_history.log"]



scale = []
accept_traj = []
traj_chstp=[]
dlsh=[]


for race_log in race_files:
    f=open(race_log,"r")
    lines = f.readlines()
    #scale = []
    #accept_traj = []
    for line in lines:
        if "TRAJS ACCEPTED" in line:
            accept_traj.append(line.split()[5])
            traj_chstp.append(int(lines[lines.index(line)-6].split()[1]))
            traj_prev = lines[lines.index(line)-7].split()[1]
            if traj_prev.split("_")[2]=="xpr2":
                scale.append([-1,1])
            else:
                scale.append([1,-1])
            if lines[lines.index(line)-13].split()[0]=="SHIFTING":
                dlsh.append(int(lines[lines.index(line)-12].split()[3]))
            else:
                dlsh.append(0)
    f.close()




traj_order = []
traj_order_byf = []
frame_order = []
dist_data_update=[]
traj_length=[]

#coord_data_update=[]
for i in range(int(len(dist_data)/2)):
    if int(accept_traj[i]) < 10:
        traj_name ="gn_00"+accept_traj[i]+"_xpr"
    elif int(accept_traj[i]) >= 10 and int(accept_traj[i]) < 100:
        traj_name ="gn_0"+accept_traj[i]+"_xpr"
    else:
        traj_name ="gn_"+accept_traj[i]+"_xpr"
    if scale[i]==[1,-1]:
        dist_subset=np.append(dist_data[i*2+1][::-1],dist_data[i*2],axis=0)
        #coord_subset=np.append(coord_data[i*2+1][::-1],coord_data[i*2],axis=0)
        traj = [traj_name+"2",traj_name+"1"]
        traj_order = traj_order + traj
        frame_a = list(range(len(dist_data[i*2+1])))
        frame_a.reverse()
        frame_b = list(range(len(dist_data[i*2])))
        frame_order = frame_order + [fa+1 for fa in frame_a] + [fb+1 for fb in frame_b]
        traj_order_byf = traj_order_byf + [traj_name+"2"]*len(dist_data[i*2+1]) + [traj_name+"1"]*len(dist_data[i*2])
    else:
        dist_subset=np.append(dist_data[i*2][::-1],dist_data[i*2+1],axis=0)
        #coord_subset=np.append(coord_data[i*2][::-1],coord_data[i*2+1],axis=0)
        traj = [traj_name+"1",traj_name+"2"]
        traj_order = traj_order + traj
        frame_a = list(range(len(dist_data[i*2])))
        frame_a.reverse()
        frame_b = list(range(len(dist_data[i*2+1])))
        frame_order = frame_order + [fa+1 for fa in frame_a] + [fb+1 for fb in frame_b]
        traj_order_byf = traj_order_byf + [traj_name+"1"]*len(dist_data[i*2]) + [traj_name+"2"]*len(dist_data[i*2+1])
    dist_data_update.append(dist_subset)
    traj_length.append([len(dist_data[i*2]),len(dist_data[i*2+1])])
    #coord_data_update.append(coord_subset)

dist_data_concatenated = np.concatenate(dist_data_update)




def find_range(index):
    if index == "TPS_2500_cp":
        traj= range(0,76)
    if index == "TPS_5000_cp":
        traj= range(76,117)
    if index =="TPS_7500":
        traj = range(117,158)
    if index == "TPS_10000":
        traj= range(158,208)
    if index == "TPS_12500":
        traj= range(208,241)
    if index == "TPS_15000_cp":
        traj= range(241,271)
    if index == "TPS_17500_cp":
        traj= range(271,361)
    if index == "TPS_20000_cp":
        traj= range(361,482)
    if index == "TPS_22500_cp":
        traj=  range(482,595)
    if index == "TPS_25000":
        traj= range(595,650)
    if index == "TPS_27500_cp":
        traj= range(650,714)
    if index == "TPS_30000":
        traj= range(714,807)
    if index == "TPS_35000_cp":
        traj= range(807,928)
    if index == "TPS_37500_cp":
        traj= range(928,978)
    if index == "TPS_2500_cp_2":
        traj= range(978,1029)
    if index == "TPS_5000_cp_2":
        traj= range(1029,1038)
    if index == "TPS_7500_cp_2":
        traj= range(1038,1055)
    if index == "TPS_10000_cp_2":
        traj= range(1055,1081)
    if index == "TPS_12500_cp_2":
        traj= range(1081,1127)
    if index == "TPS_15000_cp_2":
        traj= range(1127,1134)
    if index == "TPS_17500_cp_2":
        traj= range(1134,1169)
    if index =="TPS_20000_cp_2":
        traj= range(1169,1214)
    return traj
        

#def plot_path(plot_name,window,scale,traj_length,traj_chstp):
#    traj_range=find_range(window)
#    fig, ax = plt.subplots(figsize=(len(list(traj_range))/6,len(list(traj_range))/8),dpi=300)
#    y0=0
#    x0=0
#    ind=0
#    whole_path=[]
#    for i in traj_range:
#        ind+=1
#        traj_order=scale[i]
#        if ind == 1:
#            traj_order_prev=[1,-1]
#        else:
#            traj_order_prev=scale[i-1]
#        traj_len=traj_length[i]
#        traj_ch=traj_chstp[i]
#        x_prev=x0
#        if traj_order==[1,-1]:
#            if traj_order_prev[0]==1:
#                x0=x0+traj_ch
#                ax.hlines(y=y0-0.25, xmin=x_prev, xmax=x0, color='yellow',linewidth=2)
#                if i!=0:
#                    wdname,traj1,start=find_simu(traj_length[i-1][1],i-1)
#                    wdname,traj2,end=find_simu(traj_ch+traj_length[i-1][1]-1,i-1)  
#            else:
#                x0=x0-traj_ch   
#                ax.hlines(y=y0-0.25, xmin=x0, xmax=x_prev, color='yellow',linewidth=2)
#                if i!=0:
#                    wdname,traj1,start=find_simu(traj_length[i-1][0]-traj_ch,i-1)
#                    wdname,traj2,end=find_simu(traj_length[i-1][0]-1,i-1)                  
#            ax.vlines(x=x0, ymin=y0, ymax=y0+1, color='black')
#            ax.hlines(y=y0+1, xmin=x0, xmax=x0+traj_len[0], color='green',linewidth=2)
#            ax.hlines(y=y0+1, xmin=x0-traj_len[1], xmax=x0, color='red',linewidth=2)
#        else:
#            if traj_order_prev[1]==1:
#                x0=x0+traj_ch
#                ax.hlines(y=y0-0.25, xmin=x_prev, xmax=x0, color='yellow',linewidth=2)
#                if i!=0:
#                    wdname,traj1,start=find_simu(traj_length[i-1][1]-traj_ch-1,i-1)
#                    wdname,traj2,end=find_simu(traj_length[i-1][1],i-1)  
#            else:
#                x0=x0-traj_ch
#                ax.hlines(y=y0-0.25, xmin=x0, xmax=x_prev, color='yellow',linewidth=2)
#                if i!=0:
#                    wdname,traj1,start=find_simu(traj_length[i-1][0],i-1)
#                    wdname,traj2,end=find_simu(traj_length[i-1][0]+traj_ch-1,i-1)                   
#            ax.vlines(x=x0, ymin=y0, ymax=y0+1, color='black')
#            ax.hlines(y=y0+1, xmin=x0, xmax=x0+traj_len[1], color='green',linewidth=2)
#            ax.hlines(y=y0+1, xmin=x0-traj_len[0], xmax=x0, color='red',linewidth=2)
#        if ind!=1:
#            whole_path.append([traj1,start,end])
#        y0=y0+1
#    ax.set_ylabel('Harvested Trajectories')
#    fig.savefig(plot_name)
#    file = open(plot_name+'.csv', 'a+', newline ='')
#    with file:    
#        write = csv.writer(file)
#        write.writerows(whole_path)
#    return whole_path



def plot_path(plot_name,window,scale,traj_length,traj_chstp,accept_traj):
    traj_range=find_range(window)
    fig, ax = plt.subplots(figsize=(len(list(traj_range))/6,len(list(traj_range))/8),dpi=300)
    y0=0
    x0=500
    ind=0
    whole_path=[]
    path_data={'Traj':[],'Start':[],'End':[],'Order':[]}
    for i in traj_range:
        ind+=1
        traj_order=scale[i]
        if ind == 1:
            traj_order_prev=[1,1]
        else:
            traj_order_prev=scale[i-1]
        traj_len=traj_length[i]
        traj_ch=traj_chstp[i]
        x_prev=x0
        if traj_order==[1,-1]:
            if traj_order_prev[0]==1:
                x0=x0+traj_ch
                ax.hlines(y=y0-0.25, xmin=x_prev, xmax=x0, color='yellow',linewidth=2)
                ax.text((x_prev+x0)/2,y0+0.25,str(traj_ch),size=4)
                if ind!=1:
                    wdname,traj1,start=find_simu(traj_length[i-1][1],i-1)
                    wdname,traj2,end=find_simu(traj_ch+traj_length[i-1][1]-1,i-1) 
                    path_data['Traj'].append(i-1)
                    path_data['Start'].append(traj_length[i-1][1]) 
                    path_data['End'].append(traj_ch+traj_length[i-1][1]-1)
                    path_data['Order'].append(1)
            else:
                x0=x0-traj_ch   
                ax.hlines(y=y0-0.25, xmin=x0, xmax=x_prev, color='yellow',linewidth=2)
                ax.text((x_prev+x0)/2,y0+0.25,str(traj_ch),size=4)
                if ind!=1:
                    wdname,traj2,end=find_simu(traj_length[i-1][0]-traj_ch,i-1)
                    wdname,traj1,start=find_simu(traj_length[i-1][0]-1,i-1) 
                    path_data['Traj'].append(i-1)
                    path_data['Start'].append(traj_length[i-1][0]-1) 
                    path_data['End'].append(traj_length[i-1][0]-traj_ch)
                    path_data['Order'].append(-1)                 
            ax.vlines(x=x0, ymin=y0, ymax=y0+1, color='black')
            ax.hlines(y=y0+1, xmin=x0, xmax=x0+traj_len[0], color='green',linewidth=2)
            ax.text(traj_len[0]+x0+100,y0+1.25,"gn_"+accept_traj[i]+"_xpr1",size=4)
            ax.hlines(y=y0+1, xmin=x0-traj_len[1], xmax=x0, color='red',linewidth=2)
            ax.text(x0-traj_len[1]-600,y0+1.25,"gn_"+accept_traj[i]+"_xpr2",size=4)
        else:
            if traj_order_prev[0]==1:
                x0=x0-traj_ch
                ax.hlines(y=y0-0.25, xmin=x_prev, xmax=x0, color='yellow',linewidth=2)
                ax.text((x_prev+x0)/2,y0+0.25,str(traj_ch),size=4)
                if ind!=1:
                    wdname,traj2,end=find_simu(traj_length[i-1][1]-traj_ch,i-1)
                    wdname,traj1,start=find_simu(traj_length[i-1][1]-1,i-1)  
                    path_data['Traj'].append(i-1)
                    path_data['Start'].append(traj_length[i-1][1]-1) 
                    path_data['End'].append(traj_length[i-1][1]-traj_ch)
                    path_data['Order'].append(-1)    
            else:
                x0=x0+traj_ch
                ax.hlines(y=y0-0.25, xmin=x0, xmax=x_prev, color='yellow',linewidth=2)
                ax.text((x_prev+x0)/2,y0+0.25,str(traj_ch),size=4)
                if ind!=1:
                    wdname,traj1,start=find_simu(traj_length[i-1][0],i-1)
                    wdname,traj2,end=find_simu(traj_length[i-1][0]+traj_ch-1,i-1) 
                    path_data['Traj'].append(i-1)
                    path_data['Start'].append(traj_length[i-1][0]) 
                    path_data['End'].append(traj_length[i-1][0]+traj_ch-1)
                    path_data['Order'].append(1)                                        
            ax.vlines(x=x0, ymin=y0, ymax=y0+1, color='black')
            ax.hlines(y=y0+1, xmin=x0, xmax=x0+traj_len[1], color='green',linewidth=2)
            ax.text(traj_len[1]+x0+100,y0+1.25,"gn_"+accept_traj[i]+"_xpr2",size=4)
            ax.hlines(y=y0+1, xmin=x0-traj_len[0], xmax=x0, color='red',linewidth=2)
            ax.text(x0-traj_len[0]-600,y0+1.25,"gn_"+accept_traj[i]+"_xpr1",size=4)
        if ind!=1:
            whole_path.append([traj1,start,end])
        y0=y0+1
    ax.set_ylabel('Harvested Trajectories')
    fig.savefig(plot_name)
    path_data_new=pd.DataFrame(data=path_data)
    file = open(plot_name+'.csv', 'a+', newline ='')
    with file:    
        write = csv.writer(file)
        write.writerows(whole_path)
    return whole_path,path_data_new


    
        
                    
window_name=["TPS_2500_cp","TPS_5000_cp","TPS_7500","TPS_10000","TPS_12500","TPS_15000_cp","TPS_17500_cp","TPS_20000_cp","TPS_22500_cp","TPS_25000","TPS_27500_cp","TPS_30000","TPS_35000_cp","TPS_37500_cp","TPS_2500_cp_2","TPS_5000_cp_2","TPS_7500_cp_2","TPS_10000_cp_2","TPS_12500_cp_2","TPS_15000_cp_2","TPS_17500_cp_2","TPS_20000_cp_2"]
for window in window_name:
    whole_path,path_data_new=plot_path("path_tree."+window+".png",window,scale,traj_length,traj_chstp,accept_traj)
#    print(whole_path)
#    f = open('window_path.'+window+'.tcl', 'w+')
#    f1 = open('window_path.'+window+'.sh', 'w+')
#    f2 = open('window_path.write_pdb.'+window+'.tcl', 'w+')
#    i=0
#    for item in whole_path:
#        f.write("mol new stripped.step3_input.parm7; \n")
#        f.write("mol addfile "+item[0]+".noWAT.nc "+str(i)+"; \n")
#        max_i=max(item[1],item[2])
#        f2.write("for {set i 0} {$i<"+str(max_i)+"} {incr i} {[atomselect "+str(i)+" all frame $i] writepdb ./window_movie/"+window+"."+item[0]+".$i.pdb; } \n")
#        f.write("after 3000; \n")
#        f1.write("for i in {"+str(item[1]-1)+".."+str(item[2]-1)+"}; do cat "+window+"."+item[0]+".${i}.pdb >> "+window+"."+item[0]+".part.pdb; done \n")
#        i+=1
#    f1.write("cat ".rstrip('\n'))
#    for item in whole_path:
#        f1.write(window+"."+item[0]+".part.pdb ".rstrip('\n'))
#    f1.write(">> "+window+".whole.pdb \n")
#    f.close()
#    f1.close()
#    f2.close()
    path_extract_dist=extract_path_data(path_data_new, dist_data_update)
    path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
    path_extract_dist_concatenated = np.concatenate(path_extract_dist)
    path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
    path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
    path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)

    fig, ax = plt.subplots(figsize=(7, 6))
    fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
    #pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
    #ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
    ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
    ax.set_xlabel('DIST 1  /nm',fontsize=16, fontweight='bold')
    ax.set_ylabel('DIST 2  /nm',fontsize=16, fontweight='bold')
    ax.set_xlim(0, 6)
    ax.set_ylim(0, 4)
    ax.set_title('TPS sampling', fontweight='bold')
    fig.tight_layout()
    ax.tick_params(labelsize=16)
    fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.lag=100.cluster={}.coord.region3.window-{}.01222014.png".format(nclusters,window),dpi=1200)


    fig, axes = plt.subplots(3,1, figsize=(7, 9))
    axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
    axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
    axes[0].set_xlabel('Path',fontsize=16, fontweight='bold')
    axes[0].set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
    axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=path_path_cluster_weight, marker="o",zorder=2)
    axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
    axes[1].set_xlabel('Path',fontsize=16, fontweight='bold')
    axes[1].set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
    axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=path_path_cluster_dist, marker="o",zorder=2)
    axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
    axes[2].set_xlabel('Path',fontsize=16, fontweight='bold')
    axes[2].set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
    #plt.tick_params(labelbottom = False, bottom = False)
    axes[0].set_title('Sampling', fontweight='bold')
    axes[1].set_title('Reweighted', fontweight='bold')
    axes[2].set_title('BOLAS', fontweight='bold')
    fig.tight_layout()
    fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.window-{}.all.01222014.png".format(nclusters,window),dpi=1200)
    




def plot_path_nolabel(plot_name,window,scale,traj_length,traj_chstp,accept_traj):
    traj_range=find_range(window)
    fig, ax = plt.subplots(figsize=(7,6),dpi=300)
    y0=0
    x0=500
    ind=0
    whole_path=[]
    path_data={'Traj':[],'Start':[],'End':[],'Order':[]}
    for i in traj_range:
        ind+=1
        traj_order=scale[i]
        if ind == 1:
            traj_order_prev=[1,1]
        else:
            traj_order_prev=scale[i-1]
        traj_len=traj_length[i]
        traj_ch=traj_chstp[i]
        x_prev=x0
        if traj_order==[1,-1]:
            if traj_order_prev[0]==1:
                x0=x0+traj_ch
                ax.hlines(y=y0-0.25, xmin=x_prev, xmax=x0, color='yellow',linewidth=2)
                ax.text((x_prev+x0)/2,y0+0.25,str(traj_ch),size=4)
                if ind!=1:
                    wdname,traj1,start=find_simu(traj_length[i-1][1],i-1)
                    wdname,traj2,end=find_simu(traj_ch+traj_length[i-1][1]-1,i-1) 
                    path_data['Traj'].append(i-1)
                    path_data['Start'].append(traj_length[i-1][1]) 
                    path_data['End'].append(traj_ch+traj_length[i-1][1]-1)
                    path_data['Order'].append(1)
            else:
                x0=x0-traj_ch   
                ax.hlines(y=y0-0.25, xmin=x0, xmax=x_prev, color='yellow',linewidth=2)
                ax.text((x_prev+x0)/2,y0+0.25,str(traj_ch),size=4)
                if ind!=1:
                    wdname,traj2,end=find_simu(traj_length[i-1][0]-traj_ch,i-1)
                    wdname,traj1,start=find_simu(traj_length[i-1][0]-1,i-1) 
                    path_data['Traj'].append(i-1)
                    path_data['Start'].append(traj_length[i-1][0]-1) 
                    path_data['End'].append(traj_length[i-1][0]-traj_ch)
                    path_data['Order'].append(-1)                 
            ax.vlines(x=x0, ymin=y0, ymax=y0+1, color='black')
            ax.hlines(y=y0+1, xmin=x0, xmax=x0+traj_len[0], color='green',linewidth=2)
            #ax.text(traj_len[0]+x0+100,y0+1.25,"gn_"+accept_traj[i]+"_xpr1",size=4)
            ax.hlines(y=y0+1, xmin=x0-traj_len[1], xmax=x0, color='red',linewidth=2)
            #ax.text(x0-traj_len[1]-600,y0+1.25,"gn_"+accept_traj[i]+"_xpr2",size=4)
        else:
            if traj_order_prev[0]==1:
                x0=x0-traj_ch
                ax.hlines(y=y0-0.25, xmin=x_prev, xmax=x0, color='yellow',linewidth=2)
                ax.text((x_prev+x0)/2,y0+0.25,str(traj_ch),size=4)
                if ind!=1:
                    wdname,traj2,end=find_simu(traj_length[i-1][1]-traj_ch,i-1)
                    wdname,traj1,start=find_simu(traj_length[i-1][1]-1,i-1)  
                    path_data['Traj'].append(i-1)
                    path_data['Start'].append(traj_length[i-1][1]-1) 
                    path_data['End'].append(traj_length[i-1][1]-traj_ch)
                    path_data['Order'].append(-1)    
            else:
                x0=x0+traj_ch
                ax.hlines(y=y0-0.25, xmin=x0, xmax=x_prev, color='yellow',linewidth=2)
                ax.text((x_prev+x0)/2,y0+0.25,str(traj_ch),size=4)
                if ind!=1:
                    wdname,traj1,start=find_simu(traj_length[i-1][0],i-1)
                    wdname,traj2,end=find_simu(traj_length[i-1][0]+traj_ch-1,i-1) 
                    path_data['Traj'].append(i-1)
                    path_data['Start'].append(traj_length[i-1][0]) 
                    path_data['End'].append(traj_length[i-1][0]+traj_ch-1)
                    path_data['Order'].append(1)                                        
            ax.vlines(x=x0, ymin=y0, ymax=y0+1, color='black')
            ax.hlines(y=y0+1, xmin=x0, xmax=x0+traj_len[1], color='green',linewidth=2)
            #ax.text(traj_len[1]+x0+100,y0+1.25,"gn_"+accept_traj[i]+"_xpr2",size=4)
            ax.hlines(y=y0+1, xmin=x0-traj_len[0], xmax=x0, color='red',linewidth=2)
            #ax.text(x0-traj_len[0]-600,y0+1.25,"gn_"+accept_traj[i]+"_xpr1",size=4)
        if ind!=1:
            whole_path.append([traj1,start,end])
        y0=y0+1
    ax.set_ylabel('Harvested Trajectories',fontsize=16, fontweight='bold')
    ax.tick_params(labelsize=16)
    ax.set_title('Path Evolution', fontweight='bold')
    ax.xaxis.set_major_locator(mpl.ticker.NullLocator())
    fig.savefig(plot_name,dpi=1200)
    path_data_new=pd.DataFrame(data=path_data)
    file = open(plot_name+'.csv', 'a+', newline ='')
    with file:    
        write = csv.writer(file)
        write.writerows(whole_path)
    return whole_path,path_data_new





window_name=["TPS_37500_cp"]
for window in window_name:
    whole_path,path_data_new=plot_path_nolabel("path_tree."+window+".020824.png",window,scale,traj_length,traj_chstp,accept_traj)
    path_extract_dist=extract_path_data(path_data_new, dist_data_update)
    path_extract_tica=extract_path_data(path_data_new, tica_coord_output)
    path_extract_dist_concatenated = np.concatenate(path_extract_dist)
    path_path_binnumber_dist, path_path_energy_dist, path_path_cluster_dist =extract_path_energy(path_data_new,binnumber_dist,f_dist)
    path_path_binnumber_weight, path_path_energy_weight, path_path_cluster_weight =extract_path_energy(path_data_new,binnumber_weight,f_weight)
    path_path_energy_bolas=extract_bolas_energy(path_extract_dist_concatenated,xHedges_bolas, yHedges_bolas,free_energy)

    fig, ax = plt.subplots(figsize=(7, 6))
    fig, ax, misc = plot_free_energy_den(xHedges_bolas, yHedges_bolas, P_u, ax=ax)
    #pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
    #ax.scatter(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], s=1, c='pink', marker="o")
    ax.plot(path_extract_dist_concatenated[:,0],path_extract_dist_concatenated[:,1], markersize=0.8,fillstyle='none', color='pink', marker="o", mew=0.3, linestyle='None')
    ax.set_xlabel('DIST 1  /nm',fontsize=16, fontweight='bold')
    ax.set_ylabel('DIST 2  /nm',fontsize=16, fontweight='bold')
    ax.set_xlim(0, 6)
    ax.set_ylim(0, 4)
    ax.set_title('TPS sampling', fontweight='bold')
    fig.tight_layout()
    ax.tick_params(labelsize=16)
    fig.savefig("FEL_sampling_onDIST.FEL_BOLAS_WHAM.012224.lag=100.cluster={}.coord.region3.window-{}.020824.png".format(nclusters,window),dpi=1200)

    #CATEGORY=list(set(path_path_cluster_dist))
    #CATEGORY.sort()
    colors_mapping = {10:"#6ac7cb", 23:"#ffa790", 37:"#ffa790", 47:"#06cf00", 48:"#fcd12e", 70:"#8f69c9"}

    # Solution 1
    #colors = [colors_mapping.get(cat, "black") for cat in CATEGORY]
    # Solution 2
    colors = pd.Series(path_path_cluster_dist).map(colors_mapping)


    #CATEGORYW=list(set(path_path_cluster_weight))
    #CATEGORYW.sort()
    #colorsW_mapping = {10:"#6ac7cb", 23:"#ffa790", 37:"#ffa790", 47:"#06cf00", 48:"#06cf00", 70:"#8f69c9"}

    # Solution 1
    #colors = [colors_mapping.get(cat, "black") for cat in CATEGORY]
    # Solution 2
    colorsW = pd.Series(path_path_cluster_weight).map(colors_mapping)

    fig, axes = plt.subplots(3,1, figsize=(7, 9))
    axes[0].scatter(list(range(len(path_path_energy_dist))),path_path_energy_dist, s=2, c=colors, marker="o",zorder=2)
    axes[0].plot(list(range(len(path_path_energy_dist))),path_path_energy_dist, c='gray', linewidth=0.3,zorder=1)
    axes[0].set_xlabel('Path',fontsize=16, fontweight='bold')
    axes[0].set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
    axes[1].scatter(list(range(len(path_path_energy_weight))),path_path_energy_weight, s=2, c=colorsW, marker="o",zorder=2)
    axes[1].plot(list(range(len(path_path_energy_weight))),path_path_energy_weight, c='gray', linewidth=0.3,zorder=1)
    axes[1].set_xlabel('Path',fontsize=16, fontweight='bold')
    axes[1].set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
    axes[2].scatter(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, s=2, c=colors, marker="o",zorder=2)
    axes[2].plot(list(range(len(path_path_energy_bolas))),path_path_energy_bolas, c='gray', linewidth=0.3,zorder=1)
    axes[2].set_xlabel('Path',fontsize=16, fontweight='bold')
    axes[2].set_ylabel('Free Energy / kT',fontsize=16, fontweight='bold')
    #plt.tick_params(labelbottom = False, bottom = False)
    axes[0].set_title('Sampling', fontweight='bold')
    axes[1].set_title('Reweighted', fontweight='bold')
    axes[2].set_title('BOLAS', fontweight='bold')
    fig.tight_layout()
    fig.savefig("Path_Energy.lag=100.cluster={}.coord.region3.window-{}.all.020824.png".format(nclusters,window),dpi=1200)
    

rmsd_data=pd.read_csv("rmsd.TPS_37500.cp.csv")
drop_list=[92,715,1479,1805,1941,1959,2032,2362,2549,2578,3182,3802,4327,4582,5071,5418,6092,6275,6295,6779,6962,7548,7780,8414,8431,8955,9009,9014,9288,9638,10132,10425,10809,11101,11499,11797,12522,12823,13245,13768,14092,14535,14879,15043,15354,15741,16146,16314]
rmsd_data.drop(drop_list, inplace=True)
fig, ax = plt.subplots(figsize=(7, 3))
ax.scatter(rmsd_data['Frame']/500,rmsd_data['RMSD'], s=2, c=colors, marker="o",zorder=2)
ax.plot(rmsd_data['Frame']/500,rmsd_data['RMSD'], c='gray', linewidth=0.3,zorder=1)
ax.set_xlabel('Time     ns',fontsize=16, fontweight='bold')
ax.set_ylabel('RMSD     '+r'$\AA$',fontsize=16, fontweight='bold')
ax.set_title('RMSD', fontweight='bold')
fig.tight_layout()
fig.savefig("RMSD.lag=100.cluster={}.coord.region3.window-{}.all.020824.png".format(nclusters,window),dpi=1200)        
        


active_index=list(msm_coord.active_set)

list_ndx=[]
dtrajs_structure_index=np.array([]).astype(int)
for i in range(len(dtrajs_tica_coord_concatenated)):
    if dtrajs_tica_coord_concatenated[i] not in active_index:
        list_ndx.append(i)
    else:
        dtrajs_structure_index=np.append(dtrajs_structure_index,i)
        
dtrajs_coord_active_concatenated = np.delete(dtrajs_tica_coord_concatenated,list_ndx)

dtrajs_index=np.array([]).astype(int)

for i in dtrajs_coord_active_concatenated:
    dtrajs_index=np.append(dtrajs_index,active_index.index(i))



fig, axes = plt.subplots(1, 2, figsize=(10, 4), sharex=True, sharey=True)
pyemma.plots.plot_contour(
    *dist_data_concatenated[dtrajs_structure_index, :2].T,
    msm_coord.pi[dtrajs_index],
    ax=axes[0],
    mask=True,
    cbar_label='stationary distribution')
pyemma.plots.plot_free_energy(
    *dist_data_concatenated[:, :2].T,
    weights=np.concatenate(msm_coord.trajectory_weights()),
    ax=axes[1],
    legacy=False)
for ax in axes.flat:
    ax.set_xlabel('DIST 1')
axes[0].set_ylabel('DIST 2')
axes[0].set_title('Stationary distribution', fontweight='bold')
axes[1].set_title('Reweighted free energy surface', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_stationary_reweighted_onDIST.lag=100.cluster={}.coord.region3.tica.png".format(nclusters),dpi=1200)


pdb_center=md.load("Cluster1.center.pdb")
dist_feat_center=pyemma.coordinates.featurizer(pdb_center)                            
dist_feat_center.add_distances(np.array([[105,2416],[66,1956]]))   # 3P [66] - 62P [1956]; 4O4' [105] - 76N1 [2416]             
center_file=glob.glob("Cluster.center.all.pyemma.nc")
dist_data_center=pyemma.coordinates.load(center_file, features=dist_feat_center)




for idx, row in df.iterrows(): 
    ax.text(row['pe'], row['jsc'], idx)

cluster_list=list(range(nclusters))
fig, ax = plt.subplots(figsize=(6, 6))
plt.scatter(dist_data_center[:,0],dist_data_center[:,1], s=10, c='red', marker="o")
for i, txt in enumerate(cluster_list):
    ax.annotate(txt+1, (dist_data_center[i,0], dist_data_center[i,1]),fontsize=10)
fig.savefig("dist_center.png",dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
#pyemma.plots.plot_contour(
#    *dist_data_concatenated[dtrajs_structure_index, :2].T,
#    msm_coord.pi[dtrajs_index],
#    ax=axes[0],
#    mask=True,
#    cbar_label='stationary distribution')
pyemma.plots.plot_free_energy(
    *dist_data_concatenated[:, :2].T,
    weights=np.concatenate(msm_coord.trajectory_weights()),
    ax=ax,
    legacy=False)
#ax.scatter(dist_data_center[:,0],dist_data_center[:,1], s=10, c='white', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
#axes[0].set_title('Stationary distribution', fontweight='bold')
ax.set_title('Reweighted free energy surface', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_TPS_reweighted_onDIST.lag=100.cluster={}.coord.region3.0920.png".format(nclusters),dpi=1200)
#fig.savefig("FEL_TPS_reweighted_onDIST.lag=100.cluster={}.coord.region3.0920.label_cluster.png".format(nclusters),dpi=1200)



fig, ax = plt.subplots(figsize=(7, 6))
# the * operator used in a function call is used to unpack
# the iterable variable into its single elements. 
#pyemma.plots.plot_density(*tica_dist_concatenated.T, ax=axes[0])
pyemma.plots.plot_free_energy(*dist_data_concatenated.T, ax=ax, legacy=False)
#ax.scatter(dist_data_center[:,0],dist_data_center[:,1], s=10, c='white', marker="o")
#for i, txt in enumerate(cluster_list):
#    ax.annotate(txt, (dist_data_center[i,0], dist_data_center[i,1]))
ax.set_xlabel('DIST 1')
ax.set_ylabel('DIST 2')
ax.set_xlim(0, 6)
ax.set_ylim(0, 4)
ax.set_title('TPS sampling', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.0920.png".format(nclusters),dpi=1200)
#fig.savefig("FEL_sampling_onDIST.lag=100.cluster={}.coord.region3.0920.label_cluster.png".format(nclusters),dpi=1200)



fig, axes = plt.subplots(1, 2, figsize=(10, 4), sharex=True, sharey=True)
pyemma.plots.plot_contour(
    *tica_coord_concatenated[dtrajs_structure_index, :2].T,
    msm_coord.pi[dtrajs_index],
    ax=axes[0],
    mask=True,
    cbar_label='stationary distribution')
pyemma.plots.plot_free_energy(
    *tica_coord_concatenated[:, :2].T,
    weights=np.concatenate(msm_coord.trajectory_weights()),
    ax=axes[1],
    legacy=False)
for ax in axes.flat:
    ax.set_xlabel('IC 1')
axes[0].set_ylabel('IC 2')
axes[0].set_title('Stationary distribution', fontweight='bold')
axes[1].set_title('Reweighted free energy surface', fontweight='bold')
fig.tight_layout()
fig.savefig("FEL_stationary_reweighted.lag=100.cluster={}.coord.region3.tica.dpi.png".format(nclusters),dpi=1200)


